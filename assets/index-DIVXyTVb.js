const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DeveloperPage-Dm1t5Jd8.js","assets/vendor-B95B9ZTO.js","assets/auth-72H9TcpW.js","assets/caption-parsing-DkYi0hfG.js","assets/react-dom-BKLNrvNX.js","assets/Icons-yUTtIW30.js","assets/language-db-BnRLPJUA.js","assets/Icons-Pux0S7La.css","assets/locales-DcUbfxfW.js","assets/hls-C_AVPmGC.js","assets/TestView-D3hTcdsZ.js","assets/PlayerView-CQGW5b8f.js","assets/Settings-k8Dx4MJq.js"])))=>i.map(i=>d[i]);
import{g as ne,p as Ee,h as se,k as po,u as bo,r as u,o as K,n as yo,j as n,c as _,m as vo,N as et,q as jo,t as wo,v as ko,F as No,x as Nr,y as So,H as Te,z as Sr,R as Co,A as oe,B as Eo,G as Io,I as To,J as Lo,K as Cr,L as yn,M as ot,O as Po,Q as R,S as Nt,U as Mt,V as fe,W as Ro,X as Ao,Y as _o,Z as Mo,$ as vn,a0 as Er,a1 as jn,a2 as Le,a3 as Is,a4 as Fn,a5 as Oo,a6 as $n,a7 as Do,a8 as Bo,a9 as Uo,aa as Ir,ab as Vo,ac as X,ad as Fo,ae as $o,af as Ho,ag as Wo}from"./vendor-B95B9ZTO.js";import{c as Go,a as zo,b as Ko,d as Yo,e as qo,f as Qo,i as Xo,n as Jo,p as Zo,t as ea,v as ta,z as na,h as sa,s as ra,g as ia,m as oa,l as aa,j as la,k as ca,o as da,q as ua,r as ma,u as ha,w as fa,x as ga,y as xa,A as pa,B as ba,C as ya,D as va,E as ja,F as wa,G as ka,H as Na,I as Sa,J as Ca,K as Ea,L as Ia,M as Ta,N as La,O as Pa,P as Ra,Q as Aa,R as _a,S as Ma}from"./locales-DcUbfxfW.js";import{g as Hn,I as P,a as w,U as Tr,b as nt,F as Wn,s as Lr,c as ht}from"./Icons-yUTtIW30.js";import{u as Gn,a as at,r as Oa,b as Da,c as xe,d as Pr,e as Ba,f as Rr,g as Ua,h as Va,i as Fa}from"./react-dom-BKLNrvNX.js";import{f as ge}from"./auth-72H9TcpW.js";import{d as $a,f as rn,g as Ar,h as Ha,l as Wa,s as Ga,F as _r}from"./caption-parsing-DkYi0hfG.js";import{H as Ce}from"./hls-C_AVPmGC.js";import"./language-db-BnRLPJUA.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();let H=function(e){return e.MOVIE="movie",e.SERIES="series",e.ANIME="anime",e}({}),Ot=0;const te=ne(Ee(se(e=>({bookmarks:{},updateQueue:[],removeBookmark(t){e(s=>{Ot+=1,s.updateQueue.push({id:Ot.toString(),action:"delete",tmdbId:t}),delete s.bookmarks[t]})},addBookmark(t){e(s=>{Ot+=1,s.updateQueue.push({id:Ot.toString(),action:"add",tmdbId:t.tmdbId,type:t.type,title:t.title,year:t.releaseYear,poster:t.poster}),s.bookmarks[t.tmdbId]={type:t.type,title:t.title,year:t.releaseYear,poster:t.poster,updatedAt:Date.now()}})},replaceBookmarks(t){e(s=>{s.bookmarks=t})},clear(){e(t=>{t.bookmarks={}})},clearUpdateQueue(){e(t=>{t.updateQueue=[]})},removeUpdateItem(t){e(s=>{s.updateQueue=[...s.updateQueue.filter(r=>r.id!==t)]})}})),{name:"__MW::bookmarks"})),Oe={},Mr={};async function za(){var e,t;for(const[s,r]of Object.values(Mr)){const i=r.versions.sort((d,m)=>d.version-m.version),o=s._raw(),a=o["--version"]&&typeof o["--version"]=="number"?o["--version"]:0,l=i.filter(d=>d.version>=a);let c=o;try{for(const d of l)d.migrate&&(localStorage.setItem(`BACKUP-v${d.version}-${r.key}`,JSON.stringify(c)),c=await d.migrate(c))}catch(d){console.error(`FAILED TO MIGRATE STORE ${r.key}`,d),c=((t=(e=l[l.length-1]).create)==null?void 0:t.call(e))??{}}s.save(c)}}function Ka(e){const t=e.key??"",s=e.versions.sort((l,c)=>c.version-l.version)[0];function r(l){return Oe[t]||(Oe[t]=[]),Oe[t].push(l),{destroy(){Oe[t]=Oe[t].filter(c=>c===l)}}}function i(){var c;const l=((c=s.create)==null?void 0:c.call(s))??{};return l["--version"]=s.version,l}function o(){const l=localStorage.getItem(t);if(!l)return i();try{return JSON.parse(l)}catch(c){return console.error(`FAILED TO PARSE LOCALSTORAGE FOR KEY ${t}`,c),i()}}function a(l){const c={...l};c["--version"]=s.version,localStorage.setItem(t,JSON.stringify(c)),Oe[t]||(Oe[t]=[]),Oe[t].forEach(d=>d(window.structuredClone(l)))}return{get(){const l=o();return delete l["--version"],l},_raw(){return o()},onChange:r,save:a}}function Ya(e){var r;const t=e.versions.sort((i,o)=>i.version-o.version);if(t.forEach((i,o,a)=>{if(o!==0&&i.version!==a[o-1].version+1)throw new Error("Version list of store is not incremental")}),t.forEach(i=>{if(i.version<0)throw new Error("Versions cannot be negative")}),((r=t[0])==null?void 0:r.version)!==0)throw new Error("Version 0 doesn't exist in version list of store");if(!e.versions[e.versions.length-1].create)throw new Error("Missing create function on latest version of store");if(!e.key)throw new Error("storage key not set in store");const s=[...t];s.pop(),s.forEach(i=>{if(!i.migrate)throw new Error(`Migration missing on version ${i.version}`)})}function on(){const e={versions:[],key:null};return{setKey(t){return e.key=t,this},addVersion(t){return e.versions.push(t),this},build(){Ya(e);const t=Ka(e);return Mr[e.key??""]=[t,e],t}}}const Ts="https://apis.justwatch.com",qa="https://images.justwatch.com";function Qa(e){if(e===H.MOVIE)return"movie";if(e===H.SERIES)return"show";throw new Error("unsupported type")}function Xa(e){if(e==="movie")return H.MOVIE;if(e==="show")return H.SERIES;throw new Error("unsupported type")}function Ja(e,t){var i,o;const s=Xa(e.object_type);let r;return s===H.SERIES&&(r=(i=e.seasons)==null?void 0:i.sort((a,l)=>a.season_number-l.season_number).map(a=>({id:a.id.toString(),number:a.season_number,title:a.title}))),{title:e.title,id:e.id.toString(),year:(o=e.original_release_year)==null?void 0:o.toString(),poster:e.poster?`${qa}${e.poster.replace("{profile}","s166")}`:void 0,type:s,seasons:r,seasonData:t?{id:t.id.toString(),number:t.season_number,title:t.title,episodes:t.episodes.sort((a,l)=>a.episode_number-l.episode_number).map(a=>({id:a.id.toString(),number:a.episode_number,title:a.title}))}:void 0}}var Or={BASE_URL:"/",DEV:!1,MODE:"production",PACKAGE_VERSION:"4.9.5",PROD:!0,SSR:!1,VITE_APP_DOMAIN:"http://localhost:5173",VITE_CORS_PROXY_URL:"https://corsproxy.io/?key=d2035530",VITE_NORMAL_ROUTER:"true",VITE_OPENSEARCH_ENABLED:"false",VITE_TMDB_READ_API_KEY:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0YzYyMGNlMTJmN2MwZTVkZThkMDNlNmRlNGQ3N2EzZSIsIm5iZiI6MTczNDA5MTM4NC42NDEsInN1YiI6IjY3NWMyMjc4YWIxN2E1ZTMwNDg3YjU3YiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.P4SgNDoX2cKC0LFFb5fpI3i5HYGmEXk_R0kM1JYGwFc"};const Za="4.9.5",el="https://discord.gg/4jzBvV8E5r",tl="https://github.com/VidBingeApp/VidBinge",nl="https://ko-fi.com/vidbinge",sl="https://facebook.com/vidbinge",rl="https://instagram.com/vidbinge",Ls=Or.VITE_GA_ID,He=Or.VITE_BACKEND_URL;var Se={BASE_URL:"/",DEV:!1,MODE:"production",PACKAGE_VERSION:"4.9.5",PROD:!0,SSR:!1,VITE_APP_DOMAIN:"http://localhost:5173",VITE_CORS_PROXY_URL:"https://corsproxy.io/?key=d2035530",VITE_NORMAL_ROUTER:"true",VITE_OPENSEARCH_ENABLED:"false",VITE_TMDB_READ_API_KEY:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0YzYyMGNlMTJmN2MwZTVkZThkMDNlNmRlNGQ3N2EzZSIsIm5iZiI6MTczNDA5MTM4NC42NDEsInN1YiI6IjY3NWMyMjc4YWIxN2E1ZTMwNDg3YjU3YiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.P4SgNDoX2cKC0LFFb5fpI3i5HYGmEXk_R0kM1JYGwFc"};const il={TMDB_READ_API_KEY:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0YzYyMGNlMTJmN2MwZTVkZThkMDNlNmRlNGQ3N2EzZSIsIm5iZiI6MTczNDA5MTM4NC42NDEsInN1YiI6IjY3NWMyMjc4YWIxN2E1ZTMwNDg3YjU3YiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.P4SgNDoX2cKC0LFFb5fpI3i5HYGmEXk_R0kM1JYGwFc",APP_VERSION:void 0,GITHUB_LINK:void 0,DONATION_LINK:void 0,DISCORD_LINK:void 0,FACEBOOK_LINK:void 0,INSTAGRAM_LINK:void 0,HLSCONVERTER_URL:Se.VITE_HLSCONVERTER_URL,ONBOARDING_CHROME_EXTENSION_INSTALL_LINK:Se.VITE_ONBOARDING_CHROME_EXTENSION_INSTALL_LINK,ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK:Se.VITE_ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK,ONBOARDING_PROXY_INSTALL_LINK:Se.VITE_ONBOARDING_PROXY_INSTALL_LINK,DMCA_EMAIL:Se.VITE_DMCA_EMAIL,CORS_PROXY_URL:"https://corsproxy.io/?key=d2035530",NORMAL_ROUTER:"true",BACKEND_URL:Se.VITE_BACKEND_URL,DISALLOWED_IDS:Se.VITE_DISALLOWED_IDS,TURNSTILE_KEY:Se.VITE_TURNSTILE_KEY,CDN_REPLACEMENTS:Se.VITE_CDN_REPLACEMENTS,HAS_ONBOARDING:Se.VITE_HAS_ONBOARDING,ALLOW_AUTOPLAY:Se.VITE_ALLOW_AUTOPLAY};function Ps(e){if(e!=null&&e.length!==0)return e}function ol(e){var s;const t=(s=window==null?void 0:window.__CONFIG__)==null?void 0:s[`VITE_${e}`];return Ps(il[e])??Ps(t)??void 0}function ce(e,t){var s;return((s=ol(e))==null?void 0:s.toString())??t??null}function F(){return{APP_VERSION:Za,GITHUB_LINK:tl,DONATION_LINK:nl,DISCORD_LINK:el,FACEBOOK_LINK:sl,INSTAGRAM_LINK:rl,HLSCONVERTER_URL:ce("HLSCONVERTER_URL","https://hlsdownload.vidbinge.com"),DMCA_EMAIL:ce("DMCA_EMAIL"),ONBOARDING_CHROME_EXTENSION_INSTALL_LINK:ce("ONBOARDING_CHROME_EXTENSION_INSTALL_LINK","https://chromewebstore.google.com/detail/movie-web-extension/hoffoikpiofojilgpofjhnkkamfnnhmm"),ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK:ce("ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK","https://addons.mozilla.org/en-GB/firefox/addon/movie-web-extension"),ONBOARDING_PROXY_INSTALL_LINK:ce("ONBOARDING_PROXY_INSTALL_LINK"),BACKEND_URL:ce("BACKEND_URL",He),TMDB_READ_API_KEY:ce("TMDB_READ_API_KEY"),PROXY_URLS:ce("CORS_PROXY_URL","").split(",").map(e=>e.trim()).filter(e=>e.length>0),NORMAL_ROUTER:ce("NORMAL_ROUTER","false")==="true",HAS_ONBOARDING:ce("HAS_ONBOARDING","true")==="true",ALLOW_AUTOPLAY:ce("ALLOW_AUTOPLAY","false")==="true",TURNSTILE_KEY:ce("TURNSTILE_KEY"),DISALLOWED_IDS:ce("DISALLOWED_IDS","").split(",").map(e=>e.trim()).filter(e=>e.length>0),CDN_REPLACEMENTS:ce("CDN_REPLACEMENTS","").split(",").map(e=>e.split(":").map(t=>t.trim()).filter(t=>t.length>0)).filter(e=>e.length===2)}}let me=function(e){return e.MOVIE="movie",e.TV="tv",e}({});const al="^1.0.2";function Dr(e){return po.satisfies(e,al)}const wn={PREPARE_STREAM:1,SET_DOMAINS_HLS:2,SET_DOMAINS_HLS_AUDIO:3},ll=new Promise(e=>{setTimeout(()=>{e()},500)});let kn=!1;async function an(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;return await ll,new Promise(r=>{s>=0&&setTimeout(()=>r(null),s),bo({name:e,body:t}).then(i=>{kn=!0,r(i)}).catch(()=>{kn=!1,r(null)})})}async function Br(e){return an("makeRequest",e)}async function Nn(e){return an("prepareStream",e)}async function cl(e){return an("openPage",e)}async function zn(){return await an("hello",void 0,500)}function be(){return kn}async function xg(){const e=await zn();return!(e!=null&&e.success)||!Dr(e.version)?!1:e.allowed&&e.hasPermission}const J=ne(Ee(se(e=>({account:null,backendUrl:null,proxySet:null,setAccount(t){e(s=>{s.account=t})},removeAccount(){e(t=>{t.account=null})},setBackendUrl(t){e(s=>{s.backendUrl=t})},setProxySet(t){e(s=>{s.proxySet=t})},setAccountProfile(t){e(s=>{s.account&&(s.account.profile=t)})},updateAccount(t){e(s=>{s.account&&(s.account={...s.account,...t})})},updateDeviceName(t){e(s=>{s.account&&(s.account.deviceName=t)})}})),{name:"__MW::auth"})),dl=`${He}/metrics/providers`,ul=`${He}/metrics/captcha`,ml=()=>yo(32);function hl(){return be()?"extension":J.getState().proxySet?"custom-proxy":"default"}function Ur(e,t){const s=e.toString(),r=(e.stack??"").split(`
`,t+1);return r.pop(),`${s}

${r.join(`
`)}`}async function fl(e){if(He)return K(dl,{method:"POST",body:{items:e,tool:hl(),batchId:ml()}})}const gl={success:"success",notfound:"notfound",failure:"failed",pending:null,waiting:null};function Ze(e,t,s,r,i){var c,d;const o=(c=e.episode)==null?void 0:c.tmdbId,a=(d=e.season)==null?void 0:d.tmdbId;let l;return i instanceof Error&&(l=i),{status:r,providerId:t,title:e.title,tmdbId:e.tmdbId,type:e.type,embedId:s??void 0,episodeId:o,seasonId:a,errorMessage:l==null?void 0:l.message,fullError:l?Ur(l,5):void 0}}function Rs(e,t,s){const r=gl[s.status];if(!r)return null;let i,o;e.type==="show"&&(i=e.episode.tmdbId,o=e.season.tmdbId);let a;return s.error instanceof Error&&(a=s.error),{status:r,providerId:t,title:e.title,tmdbId:e.tmdbId,type:e.type,embedId:s.embedId,episodeId:i,seasonId:o,errorMessage:s.reason??(a==null?void 0:a.message),fullError:a?Ur(a,5):void 0}}function pg(e,t,s){const r=[];return t.forEach(i=>{const o=s[i.id];i.children.forEach(l=>{const c=s[l];if(!c.embedId)return;const d=Rs(e,o.id,c);d&&r.push(d)});const a=Rs(e,o.id,o);a&&r.push(a)}),r}function Vr(){return{report:u.useCallback(t=>{t.length!==0&&fl(t).catch(()=>{})},[])}}function As(e){He&&K(ul,{method:"POST",body:{success:e}}).catch(()=>{})}const qt=ne(se((e,t)=>({isInWidget:!1,turnstiles:[],cbs:[],processToken(s,r){const i=t().cbs,o=t().turnstiles.find(a=>a.id===r);(o==null?void 0:o.id)===r&&(i.forEach(a=>a(s)),e(a=>{a.cbs=[]}))},getToken(){return new Promise((s,r)=>{e(i=>{i.cbs=[...i.cbs,o=>{o?s(o):r(new Error("Failed to get token"))}]})})},setTurnstile(s,r,i){e(o=>{o.turnstiles=o.turnstiles.filter(a=>a.id!==s),r&&o.turnstiles.push({controls:r,isInPopout:i,id:s})})}})));function Fr(){const e=qt.getState().turnstiles,t=e.find(s=>s.isInPopout);return t||e[0]}function xl(){return!!Fr()}async function pl(){const e=Fr();try{window.turnstile.execute(document.querySelector(`#${e.id}`),{});const t=await qt.getState().getToken();return As(!0),t}catch(t){throw As(!1),t}}function $r(e){const t=F().TURNSTILE_KEY,s=u.useRef(null),r=qt(o=>o.setTurnstile),i=qt(o=>o.processToken);return t?n.jsx("div",{className:_({hidden:!e.isInPopout}),children:n.jsx(vo,{sitekey:t,onLoad:(o,a)=>{s.current=o,r(o,a,!!e.isInPopout)},onError:()=>{const o=s.current;o&&i(null,o)},onVerify:o=>{var l;const a=s.current;a&&(i(o,a),(l=e.onUpdateShow)==null||l.call(e,!1))},onBeforeInteractive:()=>{var o;(o=e.onUpdateShow)==null||o.call(e,!0)},refreshExpired:"never",execution:"render"})}):null}let Qt=null,gt=null;function bg(e){Qt=e}function ln(){return Qt??[]}function Kn(e){gt=e}function bl(){if(!gt)return null;try{const e=jo(gt);if(!e.exp)return`jwt|${gt}`;if(Date.now()/1e3<e.exp)return`jwt|${gt}`}catch{}return null}async function yg(e){if(Qt)return;Qt=(await En(`${e}/metadata`)).flat()}function _s(e){let t={};return e.type==="show"&&(t={episodeNumber:e.episode.number.toString(),episodeTmdbId:e.episode.tmdbId,seasonNumber:e.season.number.toString(),seasonTmdbId:e.season.tmdbId}),{type:e.type,releaseYear:e.releaseYear.toString(),imdbId:e.imdbId,tmdbId:e.tmdbId,title:e.title,...t}}function Dt(e,t){Object.entries(t).forEach(s=>{s[1]&&e.searchParams.set(s[0],s[1])})}function Sn(e){const t=s=>new URL(`${e}${s}`);return{scrapeSource(s,r){const i=t("/scrape/source");return Dt(i,_s(r)),Dt(i,{id:s}),i.toString()},scrapeAll(s){const r=t("/scrape");return Dt(r,_s(s)),r.toString()},scrapeEmbed(s,r){const i=t("/scrape/embed");return Dt(i,{id:s,url:r}),i.toString()}}}async function Yn(){let e=bl();return!e&&xl()&&(e=`turnstile|${await pl()}`),e}function Ms(e){return e.length===0?{}:JSON.parse(e)}async function Cn(e,t){const s=await Yn(),r=new URL(e);s&&r.searchParams.set("token",s);const i=new EventSource(r.toString());let o,a;const l=new Promise((c,d)=>{a=c,o=d});return t.forEach(c=>{i.addEventListener(c,d=>{i.close(),a(Ms(d.data))})}),i.addEventListener("token",c=>{Kn(Ms(c.data))}),i.addEventListener("error",c=>{if(i.close(),c.data){const d=JSON.parse(c.data);let m=new Error("scrape error");d.name===et.name&&(m=new et("Notfound from server")),Object.assign(m,d),o(m);return}console.error("Failed to connect to SSE",c),o(c)}),i.addEventListener("message",c=>{if(!c){i.close();return}setTimeout(()=>{o(new Error("SSE closed improperly"))},1e3)}),{promise:()=>l,on(c,d){i.addEventListener(c,m=>d(JSON.parse(m.data)))}}}const yl=F().PROXY_URLS,vl=["proxy","api"];function Os(e){try{return!!new URL(e)}catch{return!1}}function jl(e){return vl.includes(e)}function wl(e){const t=e.split(";").map(s=>s.split("=",2).filter(r=>r.length!==0)).filter(s=>s.length===2);return Object.fromEntries(t)}function Hr(){const e=J.getState().proxySet??yl,t=[];return e.forEach(s=>{if(!s.startsWith("|")&&Os(s)){t.push({url:s,type:"proxy"});return}const r=/^\|([^|]+)\|(.*)$/g.exec(s);if(!r||!r[2]||!Os(r[2]))return;const o=wl(r[1]).type??"proxy";jl(o)&&t.push({url:r[2],type:o})}),t}function qn(){return Hr().filter(e=>e.type==="proxy").map(e=>e.url)}function kl(){return Hr().filter(e=>e.type==="api").map(e=>e.url)}function Nl(e){return typeof e=="string"?"string":e instanceof FormData?"FormData":e instanceof URLSearchParams?"URLSearchParams":"object"}function Sl(e){return e instanceof FormData||e instanceof URLSearchParams?[...e]:e}function Wr(e){let t=-1;return()=>{const s=e();(t===-1||t>=s.length)&&(t=Math.floor(Math.random()*s.length));const r=s[t];return t=(t+1)%s.length,r}}const Gr=Wr(qn),zr=Wr(kl);async function Cl(e,t){const s=await Yn(),r=new Headers(t==null?void 0:t.headers);s&&r.set("X-Token",s);const i=await fetch(e,t?{...t,headers:r}:void 0),o=i.headers.get("X-Token");return o&&Kn(o),i}function El(){return async(t,s)=>wo(Gr(),Cl)(t,s)}function Il(e,t){const s=e.map(r=>r.toLowerCase());return new Headers(Object.entries(t).filter(r=>s.includes(r[0].toLowerCase())))}function Tl(){return async(t,s)=>{const r=await Br({url:t,...s,body:Sl(s.body),bodyType:Nl(s.body)});if(!(r!=null&&r.success))throw new Error(`extension error: ${r==null?void 0:r.error}`);const i=r.response;return{body:i.body,finalUrl:i.finalUrl,statusCode:i.statusCode,headers:Il(s.readHeaders,i.headers)}}}const Kr=K.create({retry:0});function Ds(e,t){let s=e;return Object.entries(t).forEach(r=>{let[i,o]=r;s=s.replace(`{${i}}`,encodeURIComponent(o))}),s}function En(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Kr(e,t)}async function Qn(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=(s==null?void 0:s.baseURL)??"";r.length>0&&r.endsWith("/")&&t.startsWith("/")?r+=t.slice(1):r.length>0&&!r.endsWith("/")&&!t.startsWith("/")?r+=`/${t}`:r+=t;const i=new URL(r);Object.entries((s==null?void 0:s.params)??{}).forEach(l=>{let[c,d]=l;i.searchParams.set(c,d)}),Object.entries((s==null?void 0:s.query)??{}).forEach(l=>{let[c,d]=l;i.searchParams.set(c,d)});let o=s.headers??{};const a=await Yn();return a&&(o={...o,"X-Token":a}),Kr(e,{...s,baseURL:void 0,params:{destination:i.toString()},query:{},headers:o,onResponse(l){var d;const c=l.response.headers.get("X-Token");c&&Kn(c),(d=s.onResponse)==null||d.call(s,l)}})}function In(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Qn(Gr(),e,t)}function Xt(e){if(e===H.MOVIE)return me.MOVIE;if(e===H.SERIES)return me.TV;throw new Error("unsupported type")}function Jt(e){if(e==="movie")return H.MOVIE;if(e==="show")return H.SERIES;throw new Error("unsupported type")}function St(e){if(e===me.MOVIE)return H.MOVIE;if(e===me.TV)return H.SERIES;throw new Error("unsupported type")}function Ll(e){if(e===me.MOVIE)return"movie";if(e===me.TV)return"show";throw new Error("unsupported type")}function Pl(e,t){var i,o,a;const s=St(e.object_type);let r;return s===H.SERIES&&(r=(i=e.seasons)==null?void 0:i.sort((l,c)=>l.season_number-c.season_number).map(l=>({title:l.title,id:l.id.toString(),number:l.season_number}))),{title:e.title,id:e.id.toString(),year:(a=(o=e.original_release_date)==null?void 0:o.getFullYear())==null?void 0:a.toString(),poster:e.poster,type:s,seasons:r,seasonData:t?{id:t.id.toString(),number:t.season_number,title:t.title,episodes:t.episodes.sort((l,c)=>l.episode_number-c.episode_number).map(l=>({id:l.id.toString(),number:l.episode_number,title:l.title,air_date:l.air_date}))}:void 0}}function Rl(e){var s;const t=Ll(e.object_type);return{title:e.title,id:e.id.toString(),year:((s=e.original_release_date)==null?void 0:s.getFullYear())??0,release_date:e.original_release_date,poster:e.poster,type:t}}function pt(e,t,s){return["tmdb",Xt(e),t,ko(s,{lower:!0,strict:!0})].join("-")}function Al(e){return pt(Jt(e.type),e.id,e.title)}function vg(e){const[t,s,r]=e.split("-",3);if(t!=="tmdb")return null;let i;try{i=St(s)}catch{return null}return{type:i,id:r}}const _l="https://api.themoviedb.org/3",Ml="https://api.tmdb.org/3",Yr=F().TMDB_READ_API_KEY,Bs={accept:"application/json",Authorization:`Bearer ${Yr}`};function Us(e){const t=new AbortController;return setTimeout(()=>t.abort(),e),t.signal}async function he(e,t){if(!Yr)throw new Error("TMDB API key not set");try{return await En(encodeURI(e),{headers:Bs,baseURL:_l,params:{...t},signal:Us(5e3)})}catch{return En(encodeURI(e),{headers:Bs,baseURL:Ml,params:{...t},signal:Us(3e4)})}}async function qr(e){return(await he("search/multi",{query:e,include_adult:!1,language:"en-US",page:1})).results.filter(r=>r.media_type===me.MOVIE||r.media_type===me.TV)}async function Ol(e){const t=await qr(e);if(t.length===0)return;const s=t[0],r=s.media_type===me.MOVIE?s.title:s.name;return`/media/${pt(St(s.media_type),s.id.toString(),r)}`}function cn(e,t){if(t===me.MOVIE)return he(`/movie/${e}`,{append_to_response:"external_ids"});if(t===me.TV)return he(`/tv/${e}`,{append_to_response:"external_ids"});throw new Error("Invalid media type")}function Zt(e){if(e)return`https://image.tmdb.org/t/p/w342/${e}`}async function Qr(e,t){return(await he(`/tv/${e}/season/${t}`)).episodes.map(r=>({id:r.id,episode_number:r.episode_number,title:r.name,air_date:r.air_date}))}async function Xr(e){const s=(await he(`/find/${e}`,{external_source:"imdb_id"})).movie_results[0];if(s)return s.id.toString()}function Dl(e,t){if(St(t)===H.SERIES){const i=e;return{title:i.name,poster:Zt(i.poster_path),id:i.id,original_release_date:new Date(i.first_air_date),object_type:t}}const r=e;return{title:r.title,poster:Zt(r.poster_path),id:r.id,original_release_date:new Date(r.release_date),object_type:t}}function Bl(e,t){if(t===H.MOVIE){const s=e;return{id:e.id,title:s.title,object_type:Xt(t),poster:Zt(s.poster_path)??void 0,original_release_date:new Date(s.release_date)}}if(t===H.SERIES){const s=e;return{id:e.id,title:s.name,object_type:Xt(t),seasons:s.seasons.map(r=>({id:r.id,season_number:r.season_number,title:r.name})),poster:Zt(s.poster_path)??void 0,original_release_date:new Date(s.first_air_date)}}throw new Error("unsupported type")}async function vt(e,t,s){const r=await cn(t,Xt(e));if(!r)return null;const i=r.external_ids.imdb_id??void 0;let o;if(e===H.SERIES){const c=r.seasons;let d=c.find(m=>m.id.toString()===s);if(d||(d=c.find(m=>m.season_number===1)),d){const m=await Qr(r.id.toString(),d.season_number);o={id:d.id.toString(),season_number:d.season_number,title:d.name,episodes:m}}}const a=Bl(r,e);if(!a)return null;const l=Pl(a,o);return l?{meta:l,imdbId:i,tmdbId:t}:null}async function Jr(e,t,s){var c,d,m,b,g;const r=Qa(e);let i;try{const f=Ds("/content/titles/{type}/{id}/locale/en_US",{type:r,id:t});i=await In(f,{baseURL:Ts})}catch(f){if(f instanceof No&&(f.statusCode===400||f.statusCode===404))return null;throw f}let o=(c=i.external_ids.find(f=>f.provider==="imdb_latest"))==null?void 0:c.external_id;o||(o=(d=i.external_ids.find(f=>f.provider==="imdb"))==null?void 0:d.external_id);let a=(m=i.external_ids.find(f=>f.provider==="tmdb_latest"))==null?void 0:m.external_id;a||(a=(b=i.external_ids.find(f=>f.provider==="tmdb"))==null?void 0:b.external_id);let l;if(i.object_type==="show"){const f=((g=i.seasons)==null?void 0:g[0].id.toString())??"",h=Ds("/content/titles/show_season/{id}/locale/en_US",{id:f});l=await In(h,{baseURL:Ts})}return{meta:Ja(i,l),imdbId:o,tmdbId:a}}function Tn(e){return!!(e.startsWith("/media/JW")||e.startsWith("/media/tmdb-show"))}function Ul(e){return!!e.startsWith("/media/tmdb-show")}async function Vl(e){if(!Tn(e))return;const t=e.split("/").slice(2),[,s,r]=t[0].split("-",3),i=t.slice(1).map(d=>`/${d}`).join("");if(Ul(e)){const d=await cn(r,me.TV);return`/media/${pt(H.SERIES,d.id.toString(),d.name)}${i}`}const o=St(s),a=await Jr(o,r);if(!a)return;const{tmdbId:l,imdbId:c}=a;if(!(!l&&!c)&&c&&o===H.MOVIE){const d=await Xr(c);if(d)return`/media/${pt(o,d,a.meta.title)}`;if(l)return`/media/${pt(o,l,a.meta.title)}`}}class Zr{constructor(){this.INTERVAL_MS=2*60*1e3,this._interval=null,this._compare=null,this._storage=[]}initialize(){if(this._interval)throw new Error("cache is already initialized");this._interval=setInterval(()=>{const t=new Date;this._storage.filter(s=>!(s.expiry<t))},this.INTERVAL_MS)}destroy(){this._interval&&clearInterval(this._interval),this.clear()}setCompare(t){this._compare=t}has(t){return!!this.get(t)}get(t){if(!this._compare)throw new Error("Compare function not set");const s=this._storage.find(r=>this._compare&&this._compare(r.key,t));if(s)return s.value}set(t,s,r){if(!this._compare)throw new Error("Compare function not set");const i=this._storage.find(a=>this._compare&&this._compare(a.key,t)),o=new Date(new Date().getTime()+r*1e3);if(i){i.key=t,i.value=s,i.expiry=o;return}this._storage.push({key:t,value:s,expiry:o})}remove(t){if(!this._compare)throw new Error("Compare function not set");this._storage.filter(s=>!(this._compare&&this._compare(s.key,t)))}clear(){this._storage=[]}}const bt=new Zr;bt.setCompare((e,t)=>e.searchQuery.trim()===t.searchQuery.trim());bt.initialize();async function ei(e){if(bt.has(e))return bt.get(e);const{searchQuery:t}=e,r=(await qr(t)).map(l=>{const c=Dl(l,l.media_type);return Rl(c)}),i=r.filter(l=>l.poster),o=r.filter(l=>!l.poster),a=i.concat(o);return bt.set(e,a,3600),a}function Vs(e){return e.trim().toLowerCase().replace(/['":]/g,"").replace(/[^a-zA-Z0-9]+/g,"_")}function Fl(e,t){return Vs(e)===Vs(t)}async function ti(e,t){const s=(o,a)=>Math.abs(o-a)<=1,r={},i=await Promise.all(Object.values(e).map(async o=>{const a=Number(o.year.toString().split("-")[0]),c=(await ei({searchQuery:`${o.title} ${a}`})).find(d=>s(Number(d.year),a)&&Fl(d.title,o.title));if(!c){console.error(`No item found for migration: ${o.title}`);return}return{id:o.mediaId,data:c}}));for(const o of i.filter(Boolean)){if(!o)continue;let a=[["0","0"]];if(o.data.type==="show"){const l=await vt(H.SERIES,o.data.id);if(!l||!(l!=null&&l.meta.seasons))return;a=[...new Set(t!=null&&t.items?t.items.filter(m=>m.mediaId===o.id).map(m=>m.seasonId):["0"])].map(m=>{var b,g;return{num:m,season:(g=(b=l.meta)==null?void 0:b.seasons)==null?void 0:g[Math.max(0,m-1)]}}).map(m=>{var b;return m?[m.num,(b=m==null?void 0:m.season)==null?void 0:b.id]:[]}).filter(m=>m.length>0)}r[o.id]||(r[o.id]={}),await Promise.all(a.map(async l=>{let[c,d]=l;c&&(r[o.id][c]=await vt(Jt(o.data.type),o.data.id,d==="0"||d===null?void 0:d))}))}return r}async function $l(e){const t=e;if(!t)return;const s={};t.bookmarks.forEach(o=>{s[o.mediaId]||(s[o.mediaId]=o)});const r=await ti(s);return r?{bookmarks:Object.keys(r).map(o=>r[o][0]).map(o=>o==null?void 0:o.meta).filter(Boolean)}:void 0}async function Hl(e){var a,l,c,d;const t=e;if(!t)return;const s={};t.items.forEach(m=>{s[m.mediaId]||(s[m.mediaId]=m)});const r=await ti(s,t);if(!r)return;const i={...t,items:[]},o=Date.now();for(const m of t.items)if(m.mediaType==="movie"){if(!((a=r[m.mediaId][0])!=null&&a.meta))continue;const b={item:{meta:(l=r[m.mediaId][0])==null?void 0:l.meta},progress:m.progress,percentage:m.percentage,watchedAt:Date.now()};t.items=t.items.filter(g=>JSON.stringify(g)!==JSON.stringify(m)),i.items.push(b)}else if(m.mediaType==="series"){if(!((c=r[m.mediaId][m.seasonId])!=null&&c.meta))continue;const b=(d=r[m.mediaId][m.seasonId])==null?void 0:d.meta;if(b.type!=="series")return;const g={item:{meta:b,series:{episode:Number(m.episodeId),season:Number(m.seasonId),seasonId:b.seasonData.id,episodeId:b.seasonData.episodes[Number(m.episodeId)-1].id}},progress:m.progress,percentage:m.percentage,watchedAt:o+Number(m.seasonId)*1e3+Number(m.episodeId)};if(i.items.find(f=>{var h,j;return f.item.meta.id===g.item.meta.id&&((h=f.item.series)==null?void 0:h.episodeId)===((j=g.item.series)==null?void 0:j.episodeId)}))continue;t.items=t.items.filter(f=>JSON.stringify(f)!==JSON.stringify(m)),i.items.push(g)}return i}function Wl(e){return e!=null}async function ni(e,t){const s=await Jr(t,e);if(!s)return;const{tmdbId:r,imdbId:i}=s;if(!(!r&&!i)){if(i&&t===H.MOVIE){const o=await Xr(i);if(o)return o}if(r)return r}}async function Gl(e){const t=e.bookmarks.map(async s=>({...s,id:await ni(s.id,s.type).catch(()=>{})}));return{bookmarks:(await Promise.all(t)).filter(s=>s.id)}}async function zl(e){return{items:(await Promise.all(e.items.map(async s=>{try{const r=await ni(s.item.meta.id,s.item.meta.type);if(!r)return null;const i=structuredClone(s);if(i.item.meta.id=r,i.item.series){const o=i.item.series,l=(await cn(r,me.TV)).seasons.find(m=>m.season_number===o.season);if(!l)return null;const d=(await Qr(r,l.season_number)).find(m=>m.episode_number===o.episode);if(!d)return null;i.item.series.episodeId=d.id.toString(),i.item.series.seasonId=l.id.toString()}return i}catch{return null}}))).filter(Wl)}}const Kl={[H.ANIME]:null,[H.MOVIE]:"movie",[H.SERIES]:"show"};on().setKey("mw-bookmarks").addVersion({version:0,migrate(e){return $l(e)}}).addVersion({version:1,migrate(e){return Gl(e)}}).addVersion({version:2,migrate(e){const t={};for(const s of e.bookmarks){const r=Kl[s.type];r&&(t[s.id]={title:s.title,year:s.year?Number(s.year):void 0,poster:s.poster,type:r,updatedAt:Date.now()})}return te.getState().replaceBookmarks(t),{bookmarks:[]}}}).addVersion({version:3,create(){return{bookmarks:[]}}}).build();const Yl={description:"Welcome to VidBinge.com, your ultimate destination for unlimited streaming of movies and TV shows. Explore our extensive library of classics and new releases, available on any device. Enjoy our service 100% subscription-free and 100% ad-free. Dive in and join the binge today!",contact:"Have any questions? Feel free to contact us at our Discord Server or email us at contact@vidbinge.com",faqTitle:"Frequently Asked Questions",q1:{body:"Vid Binge does not host any content. When you click on something to watch, the internet is searched for the selected media (On the loading screen and in the 'video sources' tab you can see which source you're using). Media never gets uploaded by Vid Binge, everything is through this searching mechanism.",title:"Where does the content come from?"},q2:{body:"It's not possible to request a show or movie, Vid Binge does not manage any content. All content is viewed through sources on the internet.",title:"Where can I request a show or movie?"},q3:{body:"Our search results are powered by The Movie Database (TMDB) and is displied regardless of whether our sources actually have the content.",title:"The search results display the show or movie, why can't I play it?"},q4:{body:"There is no limit to how much you can watch on VidBinge. Stream as much as you want, anytime, without any restrictions or additional costs.",title:"Is there a limit to how much I can watch?"},q5:{title:"How often is new content added to Vid Binge?",body:"New content availability is based on the sources connected to our platform. As these sources update their libraries, new movies and TV shows will become accessible through VidBinge."},q6:{title:"What should I do if a video doesn't play?",body:"If a video doesn’t play, it could be due to issues with the source. Try clicking the Play button again or selecting a different source from the 'video sources' tab. If problems persist, please check your internet connection or try again later."},q7:{title:"Does Vid Binge offer subtitles or dubbed content?",body:"Availability of subtitles or dubbed versions depends on the source. Some sources may provide options for subtitles in various languages or dubbed content, which can be selected directly within the video player if available."},title:"About Vid Binge"},ql={description:"Welcome to VidBinge! Your privacy is important to us. VidBinge (vidbinge.com) is committed to protecting your privacy while you enjoy your favorite movies and shows on our platform. This Privacy Policy explains how we handle and protect your data.",lastUpdated:"Last Updated: April 21, 2024",p1:{body:"Vid Binge does not host any content. When you click on something to watch, the internet is searched for the selected media (On the loading screen and in the 'video sources' tab you can see which source you're using). Media never gets uploaded by Vid Binge, everything is through this searching mechanism.",title:"Information We Do Not Collect"},p2:{body:"We use third-party analytics tools, such as Google Analytics, to collect and process basic demographic information which includes general location, device type, and browsing activities on our site. This information is anonymized and used solely to improve the functionality and content of VidBinge, ensuring you have a better streaming experience.",title:"Information We Collect"},p3:{body:"VidBinge uses cookies to enhance your viewing experience. Cookies help us understand user behavior within our site (such as most watched movies), which enables us to improve our services. You can choose to disable cookies through your browser settings, but this may affect the functionality of the site.",title:"Use of Cookies"},p4:{body:"Our use of Google Analytics means we share anonymized demographic data with Google. This information is processed under Google's privacy policy. We do not share or sell any data to other third parties.",title:"Third-Party Services"},p5:{title:"Changes to This Privacy Policy",body:"We may update this Privacy Policy from time to time. The most recent version of the policy will always be posted on our site. We encourage you to review this Privacy Policy regularly for any changes."},p6:{title:"Contact Us",body:"If you have any questions about this Privacy Policy, please contact via email at: contact@vidbinge.com"},title:"Privacy Policy for VidBinge"},Ql={copied:"Copied",copy:"Copy"},Xl={createAccount:"Don't have an account yet? <0>Create an account.</0>",deviceNameLabel:"Device name",deviceNamePlaceholder:"Personal phone",generate:{description:"Your passphrase acts as your username and password. Make sure to keep it safe as you will need to enter it to login to your account",next:"I have saved my passphrase",passphraseFrameLabel:"Passphrase",title:"Your passphrase"},hasAccount:"Already have an account? <0>Login here.</0>",login:{description:"Please enter your passphrase to login to your account",deviceLengthError:"Please enter a device name",passphraseLabel:"12-Word passphrase",passphrasePlaceholder:"Passphrase",submit:"Login",title:"Login to your account",validationError:"Incorrect or incomplete passphrase"},register:{information:{color1:"Profile color one",color2:"Profile color two",header:"Enter a name for your device and pick colours and a user icon of your choosing",icon:"User icon",next:"Next",title:"Account information"}},trust:{failed:{text:"Did you configure it correctly?",title:"Failed to reach server"},noHostTitle:"Server not configured!",noHost:"The server has not been configured, therefore you cannot create an account",host:"You are connecting to <0>{{hostname}}</0> - please confirm you trust it before making an account",no:"Go back",title:"Create an account on this server?",yes:"I trust this server"},verify:{description:"Please enter your passphrase from earlier to confirm you have saved it and to create your account",invalidData:"Data is not valid",noMatch:"Passphrase doesn't match",passphraseLabel:"Your 12-word passphrase",recaptchaFailed:"ReCaptcha validation failed",register:"Create account",title:"Confirm your passphrase"}},Jl={badge:"It broke",details:"Error details",reloadPage:"Reload the page",showError:"Show error details",title:"We encountered an error!"},Zl={legal:{disclaimer:"Disclaimer",disclaimerText:"Vid Binge does not host any files, it merely pulls streams from 3rd party services. Legal issues should be taken up with the file hosts and providers. Vid Binge is not responsible for any media files shown by the video providers."},links:{discord:"Discord",telegram:"Telegram",facebook:"Facebook",instagram:"Instagram",dmca:"DMCA",github:"GitHub"},tagline:"Dive into endless hours of free streaming entertainment with Vid Binge! Join the binge-watching revolution and explore a world of movies and TV shows—all without a subscription."},ec={name:"Vid Binge",pages:{about:"About",dmca:"DMCA",discover:"Discover",login:"Login",privacy:"Privacy Policy",onboarding:"Setup",pagetitle:"{{title}} - Vid Binge",register:"Register",settings:"Settings"}},tc={bookmarks:{sectionTitle:"Bookmarks"},continueWatching:{sectionTitle:"Continue Watching"},mediaList:{stopEditing:"Stop editing"},search:{allResults:"That's all we have!",failed:"Failed to find media, try again!",loading:"Loading...",noResults:"We couldn't find anything!",placeholder:{default:"What do you want to watch?",extra:["What do you want to explore?","What's on your watchlist?","What's your favorite movie?","What's your favorite series?"]},sectionTitle:"Search results"},titles:{420:{default:"What would you like to watch this 4/20?",extra:["Happy 4/20 🥳!"]},day:{default:"What would you like to watch this afternoon?",extra:["Viva la Vid Binge!","Welcome to Vid Binge!","Can't go wrong with The Big Lebowski!"]},morning:{default:"What would you like to watch this morning?",extra:['Good morning! How about some "Always Sunny"?',"I hear The Expanse is popular","Viva la Vid Binge!"]},night:{default:"What would you like to watch tonight?",extra:["Rick & Morty is great with friends!","The Godfather is a classic!","Go smoke and watch The Simpsons!","The Office is always a good choice!","Viva la Vid Binge!"]},halloween:{default:"What would you like to watch this Halloween?",extra:["Happy Halloween 👻🎃!"]}}},nc={episodeDisplay:"S{{season}} E{{episode}}",unreleased:"Unreleased",types:{movie:"Movie",show:"Show"}},sc={banner:{offline:"Check your internet connection"},menu:{about:"About us",donation:"Donate",discover:"Discover",logout:"Log out",register:"Sync to cloud",settings:"Settings",support:"Support"}},rc={badge:"Not found",goHome:"Back to home",message:"We looked everywhere: under the bins, in the closet, behind the proxy but ultimately couldn't find the page you are looking for.",title:"Couldn't find that page"},ic={defaultConfirm:{cancel:"Cancel",confirm:"Use default setup",description:"The default setup does not have the best streams and can be unbearably slow.",title:"Are you sure?"},extension:{back:"Go back",explainer:"Using the browser extension, you can get the best streams we have to offer. With just a simple install.",explainerIos:"Unfortunately, the browser extension is not supported on iOS, Press <bold>Go back</bold> to choose another option.",extensionHelp:"If you've installed the extension but it's not detected, <bold>open the extension through your browsers extension menu</bold> and follow the steps on screen.",linkChrome:"Install Chrome extension",linkFirefox:"Install Firefox extension",notDetecting:"Installed on Chrome, but the site isn't detecting it? Try reloading the page!",notDetectingAction:"Reload page",status:{disallowed:"Extension is not enabled for this page",disallowedAction:"Enable extension",failed:"Failed to request status",loading:"Waiting for you to install the extension",outdated:"Extension version too old",success:"Extension is working as expected!"},submit:"Continue",title:"Let's start with an extension"},proxy:{back:"Go back",explainer:"With the proxy method, you can get great quality streams by making a self-service proxy.",input:{errorConnection:"Could not connect to proxy",errorInvalidUrl:"Not a valid URL",errorNotProxy:"Expected a proxy but got a website",label:"Proxy URL",placeholder:"https://"},link:"Learn how to make a proxy",submit:"Submit proxy",title:"Let's make a new proxy"},start:{explainer:"To get the best streams possible, you will need to choose which streaming method you want to use.",options:{default:{text:"I don't want good quality streams,<0 /> <1>use the default setup</1>"},extension:{action:"Install extension",description:"Install browser extension and gain access to the best sources.",quality:"Best quality",title:"Browser extension"},proxy:{action:"Setup proxy",description:"Setup a proxy in just 5 minutes and gain access to great sources.",quality:"Good quality",title:"Custom proxy"}},title:"Let's get you setup with Vid Binge"}},oc={close:"Close"},ac={back:{default:"Back to home",short:"Back"},casting:{enabled:"Casting to device..."},menus:{downloads:{disclaimer:"Downloads are taken directly from the provider. Vid Binge does not have control over how the downloads are provided.",copyHlsPlaylist:"Copy HLS playlist link",downloadSubtitle:"Download current subtitle",downloadVideo:"Download video",downloadHlsAsVideo:"Download HLS as video",hlsDisclaimer:"Downloads are direct from the provider; Vid Binge cannot control them. <br> <br> You're downloading an HLS playlist, which is for advanced users. Try different sources for other formats.<br /><br />You may also try our HLS to Video downloader tool, but it may not work for some sources.",onAndroid:{1:"To download on Android, click the download button then, on the new page, <bold>tap and hold</bold> on the video, then select <bold>save</bold>.",shortTitle:"Download / Android",title:"Downloading on Android"},onIos:{1:"To download on iOS, click the download button then, on the new page, click <bold><ios_share /></bold>, then <bold>Save to Files <ios_files /></bold>.",shortTitle:"Download / iOS",title:"Downloading on iOS"},onPc:{1:"On PC, click the download button then, on the new page, right click the video and select <bold>Save video as</bold>",shortTitle:"Download / PC",title:"Downloading on PC"},title:"Download"},episodes:{button:"Episodes",emptyState:"There are no episodes in this season, check back later!",episodeBadge:"E{{episode}}",loadingError:"Error loading season",loadingList:"Loading...",loadingTitle:"Loading...",unairedEpisodes:"One or more episodes in this season have been disabled because they haven't been aired yet.",seasons:"Seasons"},playback:{speedLabel:"Playback speed",title:"Playback settings"},quality:{automaticLabel:"Automatic quality",hint:"You can try <0>switching source</0> to get different quality options.",iosNoQuality:"Due to Apple-defined limitations, quality selection is not available on iOS for this source. You can try <0>switching to another source</0> to get different quality options.",title:"Quality"},settings:{downloadItem:"Download",watchParty:"Watch Party",enableSubtitles:"Enable Subtitles",experienceSection:"Viewing experience",playbackItem:"Playback settings",audioItem:"Audio",qualityItem:"Quality",sourceItem:"Video sources",subtitleItem:"Subtitle settings",videoSection:"Video settings"},sources:{failed:{text:"There was an error while trying to find any videos, please try a different source.",title:"Failed to scrape"},noEmbeds:{text:"We were unable to find any embeds, please try a different source.",title:"No embeds found"},noStream:{text:"This source has no streams for this movie or show.",title:"No stream"},title:"Sources",unknownOption:"Unknown"},subtitles:{customChoice:"Drop or upload file",customizeLabel:"Customize",offChoice:"Off",OpenSubtitlesChoice:"OpenSubtitles",settings:{backlink:"Custom subtitles",delay:"Subtitle delay",fixCapitals:"Fix capitalization"},title:"Subtitles",unknownLanguage:"Unknown",dropSubtitleFile:"Drop subtitle file here"}},metadata:{api:{text:"Could not load API metadata, please check your internet connection.",title:"Failed to load API metadata"},dmca:{badge:"Removed",text:"This media is no longer available due to a takedown notice or copyright claim.",title:"Media has been removed"},extensionPermission:{badge:"Permission Missing",button:"Use extension",text:"You have the browser extension, but we need your permission to get started using the extension.",title:"Configure the extension"},failed:{badge:"Failed",homeButton:"Go home",text:"Could not load the media's metadata from TMDB. Please check whether TMDB is down or blocked on your internet connection.",title:"Failed to load metadata"},notFound:{badge:"Not found",homeButton:"Back to home",text:"We couldn't find the media you requested. Either it's been removed or you tampered with the URL.",title:"Couldn't find that media."}},nextEpisode:{cancel:"Cancel",next:"Next episode",nextSeason:"Next season"},playbackError:{badge:"Playback error",errors:{errorAborted:"The fetching of the media was aborted by the user's request.",errorDecode:"Despite having previously been determined to be usable, an error occurred while trying to decode the media resource, resulting in an error.",errorGenericMedia:"Unknown media error occurred.",errorNetwork:"Some kind of network error occurred which prevented the media from being successfully fetched, despite having previously been available.",errorNotSupported:"The media or media provider object is not supported."},homeButton:"Go home",text:"There was an error trying to play the media. Please try again.",title:"Failed to play video!"},scraping:{items:{failure:"Error occurred",notFound:"Doesn't have the video",pending:"Checking for videos..."},notFound:{badge:"Not found",detailsButton:"Show details",homeButton:"Go home",text:"We have searched through our providers and cannot find the media you are looking for! We do not host the media and have no control over what is available. Please click 'Show details' below for more details.",title:"We couldn't find that"},extensionFailure:{badge:"Extension disabled",homeButton:"Go home",enableExtension:"Enable extension",title:"Please enable the extension",text:"You've installed the Vid Binge extension. To start using it, you need to enable the extension for this site."}},time:{regular:"{{timeWatched}} / {{duration}}",remaining:"{{timeLeft}} left • Finish at {{timeFinished, datetime}}",shortRegular:"{{timeWatched}}",shortRemaining:"-{{timeLeft}}"},turnstile:{description:"Please verify that you are human by completing the Captcha on the right. This is to keep Vid Binge safe!",error:"Failed to verify your humanity. Please try again.",title:"We need to verify that you're human.",verifyingHumanity:"Verifying your humanity..."}},lc={dmca:{text:"Welcome to Vid Binge's DMCA contact page! We respect intellectual property rights and want to address any copyright concerns swiftly. If you believe your copyrighted work has been improperly used on our platform, please send a detailed DMCA notice to the email below. Please include a description of the copyrighted material, your contact details, and a statement of good faith belief. We're committed to resolving these matters promptly and appreciate your cooperation in keeping Vid Binge a place that respects creativity and copyrights.",title:"DMCA"},loadingApp:"Loading application",loadingUser:"Loading your profile",loadingUserError:{logout:"Logout",reset:"Reset custom server",text:"Failed to load your profile",textWithReset:"Failed to load your profile from your custom server, want to reset back to the default server?"},migration:{failed:"Failed to migrate your data.",inProgress:"Please hold, we are migrating your data. This shouldn't take long."}},cc={account:{accountDetails:{deviceNameLabel:"Device name",deviceNamePlaceholder:"Personal phone",editProfile:"Edit",logoutButton:"Log out"},actions:{delete:{button:"Delete account",confirmButton:"Delete account",confirmDescription:"Are you sure you want to delete your account? All your data will be lost!",confirmTitle:"Are you sure?",text:"This action is irreversible. All data will be deleted and nothing can be recovered.",title:"Delete account"},title:"Actions"},devices:{deviceNameLabel:"Device name",failed:"Failed to load sessions",removeDevice:"Remove",title:"Devices"},profile:{finish:"Finish editing",firstColor:"Profile color one",secondColor:"Profile color two",title:"Edit profile picture",userIcon:"User icon"},register:{cta:"Get started",text:"Share your watch progress between devices and keep them synced.",title:"Sync to the cloud"},title:"Account"},appearance:{activeTheme:"Active",themes:{blue:"Blue",default:"Default",gray:"Gray",red:"Red",teal:"Teal",blck:"BLCK"},title:"Appearance"},connections:{server:{description:"If you would like to connect to a custom backend to store your data, enable this and provide the URL. <0>Instructions.</0>",label:"Custom server",urlLabel:"Custom server URL"},setup:{doSetup:"Do setup",errorStatus:{description:"It seems that one or more items in this setup need your attention.",title:"Something needs your attention"},itemError:"There is something wrong with this setting. Go through setup again to fix it.",items:{default:"Default setup",extension:"Extension",proxy:"Custom proxy"},redoSetup:"Redo setup",successStatus:{description:"All things are in place for you to start watching your favourite media.",title:"Everything is set up!"},unsetStatus:{description:"Please click the button to the right to start the setup process.",title:"You haven't gone through setup"}},title:"Connections",workers:{addButton:"Add new worker",description:"To make the application function, all traffic is routed through proxies. Enable this if you want to bring your own workers. <0>Instructions.</0>",emptyState:"No workers yet, add one below",label:"Use custom proxy workers",urlLabel:"Worker URLs",urlPlaceholder:"https://"}},preferences:{language:"Application language",languageDescription:"Language applied to the entire application.",thumbnail:"Generate thumbnails",ads:"Enable Ads",adsDescription:"Ads help support the platform and keep it free for everyone. Disabling this will remove all ads.",adsLabel:"Enable Ads",thumbnailDescription:"Most of the time, videos don't have thumbnails. You can enable this setting to generate them on the fly but they can make your video slower.",thumbnailLabel:"Generate thumbnails",autoplay:"Autoplay",autoplayDescription:"Automatically play the next episode in a series after reaching the end. Can be enabled by users with the browser extension, a custom proxy, or with the default setup if allowed by the host.",autoplayLabel:"Autoplay",sourceOrder:"Reordering sources",sourceOrderDescription:"Drag and drop to reorder sources. This will determine the order in which sources are checked for the media you are trying to watch. If a source is greyed out, it means it is not available on your device.",title:"Preferences"},reset:"Reset",save:"Save",sidebar:{info:{appVersion:"App version",backendUrl:"Backend URL",backendVersion:"Backend version",hostname:"Hostname",insecure:"Insecure",notLoggedIn:"You are not logged in",secure:"Secure",title:"App information",unknownVersion:"Unknown",userId:"User ID"}},subtitles:{backgroundLabel:"Background opacity",backgroundBlurLabel:"Background blur",colorLabel:"Color",previewQuote:"The quick brown fox jumps over the lazy dog.",textSizeLabel:"Text size",title:"Subtitles",textBoldLabel:"Bold text"},unsaved:"You have unsaved changes"},dc={about:Yl,privacy:ql,actions:Ql,auth:Xl,errors:Jl,footer:Zl,global:ec,home:tc,media:nc,navigation:sc,notFound:rc,onboarding:ic,overlays:oc,player:ac,screens:lc,settings:cc},si={en:dc,ca:Go,"ca-ES":zo,cs:Ko,da:Yo,de:qo,fr:Qo,it:Xo,nl:Jo,pl:Zo,tr:ea,vi:ta,zh:na,he:sa,sv:ra,pirate:ia,minion:oa,lv:aa,th:la,ne:ca,ar:da,es:ua,et:ma,tok:ha,hi:fa,"pt-BR":ga,"pt-PT":xa,uk:pa,bg:ba,bn:ya,el:va,fa:ja,gu:wa,id:ka,ja:Na,ko:Sa,sl:Ca,ta:Ea,"zh-Hant":Ia,is:Ta,ru:La,gl:Pa,pa:Ra,ro:Aa,fi:_a,nv:Ma},uc=Object.keys(si),mc=Object.fromEntries(Object.entries(si).map(e=>[e[0],{translation:e[1]}]));Nr.use(So).init({fallbackLng:"en",resources:mc,interpolation:{escapeValue:!1}});const jg=uc.map(e=>{const t=Hn(e);if(!t)throw new Error(`Language with code ${e} cannot be found in database`);return t}),lt=ne(Ee(se(e=>({language:"en",setLanguage(t){e(s=>{s.language=t})}})),{name:"__MW::locale"}));function ri(e){const t=Hn(e);t&&Nr.changeLanguage(t.code)}function hc(e){const t=Hn(e);return t?t.isRtl:!1}function fc(){const e=lt(s=>s.language);u.useEffect(()=>{ri(e)},[e]);const t=hc(e);return n.jsx(Te,{children:n.jsx("html",{dir:t?"rtl":"ltr"})})}const Q=ne(Ee(se(e=>({enabled:!1,lastSync:{lastSelectedLanguage:null},lastSelectedLanguage:null,isOpenSubtitles:!1,overrideCasing:!1,delay:0,styling:{color:"#ffffff",backgroundOpacity:.5,size:1,backgroundBlur:0,bold:!1},resetSubtitleSpecificSettings(){e(t=>{t.delay=0,t.overrideCasing=!1})},updateStyling(t){e(s=>{t.backgroundOpacity!==void 0&&(s.styling.backgroundOpacity=Math.min(1,Math.max(0,t.backgroundOpacity))),t.backgroundBlur!==void 0&&(s.styling.backgroundBlur=Math.min(1,Math.max(0,t.backgroundBlur))),t.color!==void 0&&(s.styling.color=t.color.toLowerCase()),t.size!==void 0&&(s.styling.size=Math.min(10,Math.max(.01,t.size))),t.bold!==void 0&&(s.styling.bold=t.bold)})},setLanguage(t){e(s=>{s.enabled=!!t,t&&(s.lastSelectedLanguage=t)})},setIsOpenSubtitles(t){e(s=>{s.isOpenSubtitles=t})},setCustomSubs(){e(t=>{t.enabled=!0,t.lastSelectedLanguage=null})},setOverrideCasing(t){e(s=>{s.overrideCasing=t})},setDelay(t){e(s=>{s.delay=Math.max(Math.min(500,t),-500)})},importSubtitleLanguage(t){e(s=>{s.lastSelectedLanguage=t,s.lastSync.lastSelectedLanguage=t})}})),{name:"__MW::subtitles",merge:(e,t)=>Sr({},t,e)}));on().setKey("mw-settings").addVersion({version:0,create(){return{language:"en",captionSettings:{delay:0,style:{color:"#ffffff",fontSize:25,backgroundColor:"#00000096"}}}},migrate(e){return{language:e.language,captionSettings:{language:"none",...e.captionSettings}}}}).addVersion({version:1,migrate(e){const t=lt.getState(),s=Q.getState(),r=e.captionSettings.style.backgroundColor;let i=.5;if(r.length===9){const o=r.slice(7);i=parseInt(o,16)/255}return t.setLanguage(e.language),s.updateStyling({backgroundOpacity:i,color:e.captionSettings.style.color,size:e.captionSettings.style.fontSize/25}),s.importSubtitleLanguage(e.captionSettings.language==="none"?null:e.captionSettings.language),{}}}).addVersion({version:2,create(){return{}}}).build();const Xn=ne(Ee(se(e=>({volume:1,setVolume(t){e(s=>{s.volume=t})}})),{name:"__MW::volume"})),ii=ne(se(e=>({showVolume:!1,setShowVolume(t){e(s=>{s.showVolume=t})}})));on().setKey("mw-volume").addVersion({version:0,create(){return{volume:1}},migrate(e){return Xn.getState().setVolume(e.volume),{}}}).addVersion({version:1,create(){return{}}}).build();let Bt=0;const re=ne(Ee(se(e=>({items:{},updateQueue:[],removeItem(t){e(s=>{Bt+=1,s.updateQueue.push({id:Bt.toString(),action:"delete",tmdbId:t}),delete s.items[t]})},replaceItems(t){e(s=>{s.items=t})},updateItem(t){let{meta:s,progress:r}=t;e(i=>{var a,l,c,d;Bt+=1,i.updateQueue.push({tmdbId:s.tmdbId,title:s.title,year:s.releaseYear,poster:s.poster,type:s.type,progress:{...r},id:Bt.toString(),episodeId:(a=s.episode)==null?void 0:a.tmdbId,seasonId:(l=s.season)==null?void 0:l.tmdbId,seasonNumber:(c=s.season)==null?void 0:c.number,episodeNumber:(d=s.episode)==null?void 0:d.number,action:"upsert"}),i.items[s.tmdbId]||(i.items[s.tmdbId]={type:s.type,episodes:{},seasons:{},updatedAt:0,title:s.title,year:s.releaseYear,poster:s.poster});const o=i.items[s.tmdbId];if(o.updatedAt=Date.now(),s.type==="movie"){o.progress||(o.progress={duration:0,watched:0}),o.progress={...r};return}!s.episode||!s.season||(o.seasons[s.season.tmdbId]||(o.seasons[s.season.tmdbId]={id:s.season.tmdbId,number:s.season.number,title:s.season.title}),o.episodes[s.episode.tmdbId]||(o.episodes[s.episode.tmdbId]={id:s.episode.tmdbId,number:s.episode.number,title:s.episode.title,seasonId:s.season.tmdbId,updatedAt:Date.now(),progress:{duration:0,watched:0}}),o.episodes[s.episode.tmdbId].progress={...r})})},clear(){e(t=>{t.items={}})},clearUpdateQueue(){e(t=>{t.updateQueue=[]})},removeUpdateItem(t){e(s=>{s.updateQueue=[...s.updateQueue.filter(r=>r.id!==t)]})}})),{name:"__MW::progress"}));function gc(e){var s,r;const t={};for(const i of e.items)if(i.item.meta.type===H.SERIES){if(t[i.item.meta.id]||(t[i.item.meta.id]={type:"show",episodes:{},seasons:{},title:i.item.meta.title,updatedAt:i.watchedAt,poster:i.item.meta.poster,year:Number(i.item.meta.year)}),i.item.series&&!t[i.item.meta.id].episodes[i.item.series.episodeId]){const o=(s=i.item.meta.seasonData.episodes.find(a=>{var l;return a.number===((l=i.item.series)==null?void 0:l.episode)}))==null?void 0:s.title;t[i.item.meta.id].seasons[i.item.series.seasonId]={id:i.item.series.seasonId,number:i.item.series.season,title:((r=i.item.meta.seasons.find(a=>{var l;return a.number===((l=i.item.series)==null?void 0:l.season)}))==null?void 0:r.title)||"Unknown season"},t[i.item.meta.id].episodes[i.item.series.episodeId]={title:o||"Unknown",id:i.item.series.episodeId,number:i.item.series.episode,seasonId:i.item.series.seasonId,updatedAt:i.watchedAt,progress:{duration:100/i.percentage*i.progress,watched:i.progress}}}}else t[i.item.meta.id]={type:"movie",episodes:{},seasons:{},title:i.item.meta.title,updatedAt:i.watchedAt,year:Number(i.item.meta.year),poster:i.item.meta.poster,progress:{duration:100/i.percentage*i.progress,watched:i.progress}};return t}on().setKey("video-progress").addVersion({version:0,migrate(){return{items:[]}}}).addVersion({version:1,async migrate(e){return Hl(e)}}).addVersion({version:2,migrate(e){return zl(e)}}).addVersion({version:3,migrate(e){return re.getState().replaceItems(gc(e)),{items:[]}}}).addVersion({version:4,create(){return{items:[]}}}).build();Ls&&Co.initialize([{trackingId:Ls}]);function dn(e){return n.jsx("div",{className:["spinner",e.className??""].join(" ")})}function $(e){var d;const t=oe(),{onClick:s,href:r,loading:i}=e,o=u.useCallback(m=>{i||(r&&!s?(m.preventDefault(),r.includes("http")?window.open(r,"_blank","noreferrer"):t(r)):s==null||s(m))},[i,r,s,t]);let a="bg-white hover:bg-gray-200 text-black";e.theme==="purple"&&(a="bg-buttons-purple hover:bg-buttons-purpleHover text-white"),e.theme==="secondary"&&(a="bg-buttons-cancel hover:bg-buttons-cancelHover transition-colors duration-100 text-white"),e.theme==="danger"&&(a="bg-buttons-danger hover:bg-buttons-dangerHover text-white");let l=_("tabbable cursor-pointer inline-flex items-center justify-center rounded-lg font-medium transition-[transform,background-color] duration-100 active:scale-105 md:px-8",e.padding??"px-4 py-3",e.className,a,e.disabled?"!cursor-not-allowed bg-opacity-60 text-opacity-60":null);e.disabled&&(l=l.split(" ").filter(m=>!m.startsWith("hover:")&&!m.startsWith("active:")).join(" "));const c=n.jsxs(n.Fragment,{children:[e.icon&&!e.loading?n.jsx("span",{className:"mr-3 hidden md:inline-block",children:n.jsx(P,{icon:e.icon})}):null,e.loading?n.jsx("span",{className:"mr-3 inline-flex justify-center",children:n.jsx(dn,{className:"text-lg"})}):null,e.children]});return e.href&&(e.href.startsWith("https://")||(d=e.href)!=null&&d.startsWith("data:"))?n.jsx("a",{className:l,href:e.href,target:"_blank",rel:"noreferrer",download:e.download,onClick:o,children:c}):e.href?n.jsx("a",{className:l,onClick:o,children:c}):n.jsx("button",{type:"button",onClick:o,className:l,children:c})}function Fs(e){let t="bg-white hover:bg-gray-200 text-black";e.theme==="purple"&&(t="bg-buttons-purple hover:bg-buttons-purpleHover text-white"),e.theme==="secondary"&&(t="bg-buttons-cancel hover:bg-buttons-cancelHover transition-colors duration-100 text-white");const s=_("cursor-pointer inline-flex items-center justify-center rounded-lg font-medium transition-[transform,background-color] duration-100 active:scale-105 md:px-8","px-4 py-3",e.className,t);return n.jsx("button",{type:"button",onClick:e.onClick,className:s,children:e.children})}const xc=function(t){return n.jsx("div",{className:t.className,children:n.jsxs("div",{className:"flex flex-col items-center justify-center",children:[n.jsxs("div",{className:"flex h-12 items-center justify-center",children:[n.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30]"}),n.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:150ms]"}),n.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:300ms]"}),n.jsx("div",{className:"mx-1 h-2 w-2 animate-loading-pin rounded-full bg-[#211D30] [animation-delay:450ms]"})]}),t.text&&t.text.length?n.jsx("p",{className:"mt-3 max-w-xs text-sm opacity-75",children:t.text}):null]})})},We=xc;function ae(e){return{authorization:`Bearer ${e}`}}function pc(e,t){return{meta:{title:t.title,type:t.type,poster:t.poster,year:t.year??0},tmdbId:e}}async function bc(e,t,s){return K(`/users/${t.userId}/bookmarks/${s.tmdbId}`,{method:"POST",headers:ae(t.token),baseURL:e,body:s})}async function yc(e,t,s){return K(`/users/${t.userId}/bookmarks/${s}`,{method:"DELETE",headers:ae(t.token),baseURL:e})}async function vc(e){return Eo(Io,e,"mnemonic",{c:2048,dkLen:32})}function jc(e){return To(e,Cr)}async function $s(e){const t=await vc(e),{privateKey:s,publicKey:r}=ge.pki.ed25519.generateKeyPair({seed:t});return{privateKey:s,publicKey:r,seed:t}}function wc(){return Lo(Cr)}async function kc(e,t){return ge.pki.ed25519.sign({encoding:"utf8",message:e,privateKey:t})}function Ln(e){return ge.util.encode64(String.fromCodePoint(...e))}function Pn(e){return Ln(e).replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,"")}async function Hs(e,t){const s=await kc(t,e.privateKey);return Pn(s)}function Jn(e){return ge.util.binary.base64.decode(e)}function xn(e){return ge.util.createBuffer(Jn(e))}function Ws(e){return ge.util.encode64(e.getBytes())}async function Gs(e,t){if(t.byteLength!==32)throw new Error("Secret must be at least 256-bit");const s=await new Promise((a,l)=>{ge.random.getBytes(16,(c,d)=>{c&&l(c),a(d)})}),r=ge.cipher.createCipher("AES-GCM",ge.util.createBuffer(t));r.start({iv:s,tagLength:128}),r.update(ge.util.createBuffer(e,"utf8")),r.finish();const i=r.output,o=r.mode.tag;return`${ge.util.encode64(s)}.${Ws(i)}.${Ws(o)}`}function oi(e,t){if(t.byteLength!==32)throw new Error("Secret must be 256-bit");const[s,r,i]=e.split("."),o=ge.cipher.createDecipher("AES-GCM",ge.util.createBuffer(t));if(o.start({iv:xn(s),tag:xn(i),tagLength:128}),o.update(xn(r)),!o.finish())throw new Error("Error decrypting data");return o.output.toString()}function Nc(e,t,s){return K(`/users/${t.userId}/progress/import`,{method:"PUT",body:s,baseURL:e,headers:ae(t.token)})}function Sc(e,t,s){return K(`/users/${t.userId}/bookmarks`,{method:"PUT",body:s,baseURL:e,headers:ae(t.token)})}async function Cc(e,t){return K("/auth/login/start",{method:"POST",body:{publicKey:t},baseURL:e})}async function Ec(e,t){return K("/auth/login/complete",{method:"POST",body:{namespace:"movie-web",...t},baseURL:e})}function Ic(e){var t,s;return{duration:((t=e.progress)==null?void 0:t.duration)??0,watched:((s=e.progress)==null?void 0:s.watched)??0,tmdbId:e.tmdbId,meta:{title:e.title??"",type:e.type??"",year:e.year??NaN,poster:e.poster},episodeId:e.episodeId,seasonId:e.seasonId,episodeNumber:e.episodeNumber,seasonNumber:e.seasonNumber}}function Tc(e,t){var s,r;return t.type==="show"?Object.entries(t.episodes).flatMap(i=>{var l,c;let[o,a]=i;return{duration:((l=t.progress)==null?void 0:l.duration)??a.progress.duration,watched:((c=t.progress)==null?void 0:c.watched)??a.progress.watched,tmdbId:e,meta:{title:t.title??"",type:t.type??"",year:t.year??NaN,poster:t.poster},episodeId:a.id,seasonId:a.seasonId,episodeNumber:a.number,seasonNumber:t.seasons[a.seasonId].number,updatedAt:new Date(a.updatedAt).toISOString()}}):[{duration:((s=t.progress)==null?void 0:s.duration)??0,watched:((r=t.progress)==null?void 0:r.watched)??0,tmdbId:e,updatedAt:new Date(t.updatedAt).toISOString(),meta:{title:t.title??"",type:t.type??"",year:t.year??NaN,poster:t.poster}}]}async function Lc(e,t,s){return K(`/users/${t.userId}/progress/${s.tmdbId}`,{method:"PUT",headers:ae(t.token),baseURL:e,body:s})}async function Pc(e,t,s,r,i){await K(`/users/${t.userId}/progress/${s}`,{method:"DELETE",headers:ae(t.token),baseURL:e,body:{episodeId:r,seasonId:i}})}async function Rc(e,t){return K("/auth/register/start",{method:"POST",body:{captchaToken:t},baseURL:e})}async function Ac(e,t){return K("/auth/register/complete",{method:"POST",body:{namespace:"movie-web",...t},baseURL:e})}async function wg(e,t){return K(`/users/${t.userId}/sessions`,{headers:ae(t.token),baseURL:e})}async function kg(e,t,s){return K(`/sessions/${t.sessionId}`,{method:"PATCH",headers:ae(t.token),body:s,baseURL:e})}async function _c(e,t,s){return K(`/sessions/${s}`,{method:"DELETE",headers:ae(t),baseURL:e})}function Zn(e,t,s){return K(`/users/${t.userId}/settings`,{method:"PUT",body:s,baseURL:e,headers:ae(t.token)})}function Mc(e,t){return K(`/users/${t.userId}/settings`,{method:"GET",baseURL:e,headers:ae(t.token)})}function Oc(e){const t=e.map(s=>{const r={...s.meta,updatedAt:new Date(s.updatedAt).getTime()};return[s.tmdbId,r]});return Object.fromEntries(t)}function Dc(e){const t={};return e.forEach(s=>{t[s.tmdbId]||(t[s.tmdbId]={title:s.meta.title,poster:s.meta.poster,type:s.meta.type,updatedAt:new Date(s.updatedAt).getTime(),episodes:{},seasons:{},year:s.meta.year});const r=t[s.tmdbId];new Date(s.updatedAt).getTime()>r.updatedAt&&(r.updatedAt=new Date(s.updatedAt).getTime()),r.type==="movie"&&(r.progress={duration:Number(s.duration),watched:Number(s.watched)}),r.type==="show"&&s.season.id&&s.episode.id&&(r.seasons[s.season.id]={id:s.season.id,number:s.season.number??0,title:""},r.episodes[s.episode.id]={id:s.episode.id,number:s.episode.number??0,title:"",progress:{duration:Number(s.duration),watched:Number(s.watched)},seasonId:s.season.id,updatedAt:new Date(s.updatedAt).getTime()})}),t}async function zs(e,t){return K("/users/@me",{headers:ae(t),baseURL:e})}async function Ng(e,t,s){return K(`/users/${t.userId}`,{method:"PATCH",headers:ae(t.token),body:s,baseURL:e})}async function Sg(e,t){return K(`/users/${t.userId}`,{headers:ae(t.token),baseURL:e})}async function Bc(e,t){return K(`/users/${t.userId}/bookmarks`,{headers:ae(t.token),baseURL:e})}async function Uc(e,t){return K(`/users/${t.userId}/progress`,{headers:ae(t.token),baseURL:e})}const Ks=new Date,Vc=Ks.getMonth()+1===4&&Ks.getDate()===20,es=ne(Ee(se(e=>({theme:Vc?"teal":null,setTheme(t){e(s=>{s.theme=t})}})),{name:"__MW::theme"})),Fc=ne(se(e=>({previewTheme:null,setPreviewTheme(t){e(s=>{s.previewTheme=t})}})));function $c(e){const t=Fc(o=>o.previewTheme),s=es(o=>o.theme),r=t??s,i=r?`theme-${r}`:void 0;return n.jsxs("div",{className:i,children:[e.applyGlobal?n.jsx(Te,{children:n.jsx("body",{className:i})}):null,e.children]})}function Hc(){const e=!!J(h=>h.account),t=J(h=>h.setAccount),s=J(h=>h.removeAccount),r=J(h=>h.setProxySet),i=te(h=>h.clear),o=re(h=>h.clear),a=es(h=>h.setTheme),l=lt(h=>h.setLanguage),c=Q(h=>h.importSubtitleLanguage),d=te(h=>h.replaceBookmarks),m=re(h=>h.replaceItems),b=u.useCallback(async(h,j,y,x)=>{const v={token:h.token,userId:j.id,sessionId:h.session.id,deviceName:y.device,profile:j.profile,seed:x};return t(v),v},[t]),g=u.useCallback(async()=>{s(),i(),o()},[s,i,o]),f=u.useCallback(async(h,j,y,x,v)=>{d(Oc(x)),m(Dc(y)),v.applicationLanguage&&l(v.applicationLanguage),v.defaultSubtitleLanguage&&c(v.defaultSubtitleLanguage),v.applicationTheme&&a(v.applicationTheme),v.proxyUrls&&r(v.proxyUrls)},[d,m,l,c,a,r]);return{loggedIn:e,login:b,logout:g,syncData:f}}function Be(){return J(t=>t.backendUrl)??F().BACKEND_URL}function ct(){const e=J(g=>g.account),t=J(g=>{var f;return(f=g.account)==null?void 0:f.profile}),s=!!J(g=>g.account),r=Be(),{logout:i,login:o,syncData:a}=Hc(),l=u.useCallback(async g=>{if(!r)return;const f=await $s(g.mnemonic),h=Pn(f.publicKey),{challenge:j}=await Cc(r,h),y=await Hs(f,j),x=await Ec(r,{challenge:{code:j,signature:y},publicKey:h,device:await Gs(g.userData.device,f.seed)}),v=await zs(r,x.token),I=Ln(f.seed);return o(x,v.user,v.session,I)},[o,r]),c=u.useCallback(async()=>{if(!(!e||!r)){try{await _c(r,e.token,e.sessionId)}catch{}await i()}},[i,r,e]),d=u.useCallback(async g=>{if(!r)return;const{challenge:f}=await Rc(r,g.recaptchaToken),h=await $s(g.mnemonic),j=await Hs(h,f),y=await Ac(r,{challenge:{code:f,signature:j},publicKey:Pn(h.publicKey),device:await Gs(g.userData.device,h.seed),profile:g.userData.profile});return o(y,y.user,y.session,Ln(h.seed))},[r,o]),m=u.useCallback(async(g,f,h)=>{if(!r||Object.keys(f).length===0&&Object.keys(h).length===0)return;const j=Object.entries(f).flatMap(x=>{let[v,I]=x;return Tc(v,I)}),y=Object.entries(h).map(x=>{let[v,I]=x;return pc(v,I)});await Promise.all([Nc(r,g,j),Sc(r,g,y)])},[r]),b=u.useCallback(async g=>{var x,v,I;if(!r)return;let f;try{f=await zs(r,g.token)}catch(A){const M=A;if(((x=M==null?void 0:M.response)==null?void 0:x.status)===401||((v=M==null?void 0:M.response)==null?void 0:v.status)===403||((I=M==null?void 0:M.response)==null?void 0:I.status)===400){await c();return}throw console.error(A),A}const[h,j,y]=await Promise.all([Bc(r,g),Uc(r,g),Mc(r,g)]);a(f.user,f.session,j,h,y)},[r,a,c]);return{loggedIn:s,profile:t,login:l,logout:c,register:d,restore:b,importData:m}}const Wc=12*60*60*1e3;function Gc(){const{account:e}=J(),{restore:t}=ct(),s=u.useRef(!1);return Gn(()=>{e&&t(e)},Wc),at(async()=>{s.current||!e||await t(e).finally(()=>{s.current=!0})},[])}function ts(e){return n.jsxs("div",{className:"bg-pill-background bg-opacity-50 px-4 py-2 rounded-full text-white flex justify-center items-center",children:[n.jsx(P,{icon:e.icon??w.WAND,className:"mr-3 text-xl text-type-link"}),e.children]})}function jt(e){return n.jsx("h2",{className:_("text-white text-3xl font-bold text-opacity-100 mt-6",e.className),children:e.children})}const un="pb-4 border-b border-utils-divider border-opacity-50";function Ct(e){return n.jsx("h1",{className:["text-3xl lg:text-5xl font-bold text-white mb-9",e.border?un:null,e.className??""].join(" "),children:e.children})}function je(e){return n.jsx("h2",{className:["text-xl lg:text-2xl font-bold text-white mt-20 mb-9",e.border?un:null,e.className??""].join(" "),children:e.children})}function ai(e){return n.jsx("h2",{className:["text-lg lg:text-xl font-bold text-white mb-3",e.border?un:null,e.className??""].join(" "),children:e.children})}function ie(e){return n.jsx("p",{className:["text-type-text my-9 font-medium",e.border?un:null,e.className??""].join(" "),children:e.children})}function ns(e){return n.jsx("div",{className:_("w-full p-6 text-center flex flex-col items-center",e.maxWidth??"max-w-[28rem]"),children:e.children})}function ss(e){return n.jsx("div",{className:"w-full h-full flex justify-center items-center flex-col",children:e.children})}function zc(e,t){return e==="slide-down"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100 translate-y-0",leaveTo:"-translate-y-4 opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0 -translate-y-4",enterTo:"translate-y-0 opacity-100"}:e==="slide-up"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100 translate-y-0",leaveTo:"translate-y-4 opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0 translate-y-4",enterTo:"translate-y-0 opacity-100"}:e==="slide-full-left"?{leave:`transition-[transform] ${t}`,leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",enter:`transition-[transform] ${t}`,enterFrom:"-translate-x-full",enterTo:"translate-x-0"}:e==="slide-full-right"?{leave:`transition-[transform] ${t}`,leaveFrom:"translate-x-0",leaveTo:"translate-x-full",enter:`transition-[transform] ${t}`,enterFrom:"translate-x-full",enterTo:"translate-x-0"}:e==="fade"?{leave:`transition-[transform,opacity] ${t}`,leaveFrom:"opacity-100",leaveTo:"opacity-0",enter:`transition-[transform,opacity] ${t}`,enterFrom:"opacity-0",enterTo:"opacity-100"}:{}}function de(e){const t=e.durationClass??"duration-200",s=zc(e.animation,t);return e.isChild?n.jsx(yn.Child,{as:u.Fragment,...s,children:n.jsx("div",{className:e.className,style:e.style,children:e.children})}):n.jsx(yn,{show:e.show,as:u.Fragment,...s,children:n.jsx("div",{className:e.className,style:e.style,children:e.children})})}function Kc(){const e=ot();return u.useMemo(()=>Object.fromEntries(new URLSearchParams(e.search).entries()),[e.search])}function mn(e){const t=Kc(),s=ot(),r=oe(),i=t[e]??null,o=u.useCallback(a=>{const l=new URLSearchParams(s.search);a?l.set(e,a):l.delete(e),r({search:l.toString()})},[e,s.search,r]);return[i,o]}const st=ne(se(e=>({transition:null,routes:{},anchorPoint:null,setTransition(t){e(s=>{s.transition=t})},registerRoute(t){e(s=>{s.routes[t.id]=t})},setAnchorPoint(t){e(s=>{s.anchorPoint=t})}})));function qe(e,t){return[t??"",...e.split("/")].filter(r=>r.length>0)}function Qe(e){return`/${e.join("/")}`}function Yc(e){const[t]=mn("r"),s=st(o=>o.setAnchorPoint),r=u.useMemo(()=>!!t&&t.startsWith(`/${e}`),[t,e]),i=u.useCallback(()=>{if(!r)return;const o=document.getElementById(`__overlayRouter::${e}`);if(o){const a=o.getBoundingClientRect();s({h:a.height,w:a.width,x:a.x,y:a.y})}},[r,s,e]);u.useEffect(()=>{i()},[r,i]),u.useEffect(()=>{function o(){i()}return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[i])}function dt(e){const[t,s]=mn("r"),r=st(h=>h.transition),i=st(h=>h.setTransition),o=!!t&&t.startsWith(`/${e}`);function a(h){return Qe(qe(h,e))}function l(h){const j=t,y=Qe(qe(h,e));i({from:j??"/",to:y}),s(y)}function c(h){if(!r)return"none";const j=Qe(qe(h,e));return j===r.to&&r.from.startsWith(r.to)||j===r.from&&r.to.startsWith(r.from)?"yes":"no"}function d(h){return o&&t===Qe(qe(h,e))}function m(){return o}const b=u.useCallback(h=>{t&&!h&&s(null),i(null)},[s,t,i]),g=u.useCallback(function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"/";i(null),s(Qe(qe(h,e)))},[e,s,i]);return{activeRoute:o?Qe(qe(t.slice(`/${e}`.length))):"/",showBackwardsTransition:c,isCurrentPage:d,isOverlayActive:m,navigate:l,close:b,open:g,makePath:a,currentRoute:t}}function Z(e){const t=dt(e);return{id:e,route:t.activeRoute,isRouterActive:t.isOverlayActive(),open:t.open,close:t.close,navigate:t.navigate}}const qc=function(){const{t}=R(),[s,r]=u.useState(!1);return n.jsx("div",{className:_("absolute w-10/12 max-w-[800px] bg-background-main p-20 rounded-lg select-none z-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transform",s?"":"hidden"),children:n.jsxs("div",{className:"w-full grid lg:grid-cols-[1fr,auto] gap-12 items-center",children:[n.jsxs("div",{className:"text-left",children:[n.jsx("h2",{className:"text-type-emphasis font-bold text-xl mb-6",children:t("player.turnstile.title")}),n.jsx("p",{children:t("player.turnstile.description")})]}),n.jsx($r,{isInPopout:!0,onUpdateShow:i=>r(i)})]})})},Qc=qc;function Xc(e){const t=dt("hello world :)"),s=u.useRef(t);return u.useEffect(()=>{const r=s.current;return r.close(),()=>{r.close()}},[]),n.jsxs("div",{className:"popout-location",children:[n.jsx(Qc,{}),e.children]})}function li(e){const[t,s]=u.useState(null),r=u.useRef(null),i=e.close;return u.useEffect(()=>{var a;const o=(a=r.current)==null?void 0:a.closest(".popout-location");s(o??document.body)},[]),n.jsx("div",{ref:r,children:t?Oa.createPortal(n.jsx(de,{show:e.show,animation:"none",children:n.jsx(Po,{children:n.jsxs("div",{className:"popout-wrapper fixed overflow-hidden pointer-events-auto inset-0 z-[999] select-none",children:[n.jsx(de,{animation:"fade",isChild:!0,children:n.jsx("div",{onClick:i,className:_({"absolute inset-0":!0,"bg-black opacity-90":e.darken})})}),n.jsxs(de,{animation:"slide-up",className:"absolute inset-0 pointer-events-none",isChild:!0,children:[n.jsx("div",{tabIndex:1,className:"focus:ring-0 focus:outline-none opacity-0"}),e.children]})]})})}),t):null})}function ci(e){const t=dt(e.id),s=t.close;Yc(e.id);const r=u.useCallback(()=>{s()},[s]);return n.jsx(li,{close:r,show:t.isOverlayActive(),darken:e.darken,children:e.children})}function rs(e){const[t,s]=mn("m"),r=u.useCallback(()=>s(e),[e,s]),i=u.useCallback(()=>s(null),[s]);return{id:e,isShown:t===e,show:r,hide:i}}function Jc(e){return n.jsx("div",{className:"w-full max-w-[30rem] m-4",children:n.jsx("div",{className:"w-full bg-modal-background rounded-xl p-8 pointer-events-auto",children:e.children})})}function di(e){const t=rs(e.id);return n.jsxs(li,{darken:!0,close:t.hide,show:t.isShown,children:[n.jsx(Te,{children:n.jsx("html",{"data-no-scroll":!0})}),n.jsx("div",{className:"flex absolute inset-0 items-center justify-center flex-col",children:e.children})]})}const Zc=function(t){const[s,r]=u.useState(!1),i=u.useRef(null),{t:o}=R();let a=null;typeof t.error=="string"?a=t.error:t.error.key?a=`${t.error.type}: ${o(t.error.key)}`:t.error.message&&(a=`${t.error.type}: ${o(t.error.message)}`);function l(){!t.error||!navigator.clipboard||(navigator.clipboard.writeText(`\`\`\`${a}\`\`\``),r(!0),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>r(!1),2e3))}return n.jsxs("div",{className:"bg-errors-card w-full rounded-lg p-6 text-left",children:[n.jsxs("div",{className:"border-errors-border flex items-center justify-between border-b pb-2",children:[n.jsx("span",{className:"font-medium text-white",children:o("errors.details")}),n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx($,{theme:"secondary",padding:"p-2 h-10 min-w-[40px] md:px-4",onClick:()=>l(),children:s?n.jsxs(n.Fragment,{children:[n.jsx(P,{icon:w.CHECKMARK,className:"text-xs"}),n.jsx("span",{className:"hidden min-[400px]:inline-block ml-3",children:o("actions.copied")})]}):n.jsxs(n.Fragment,{children:[n.jsx(P,{icon:w.COPY,className:"text-2xl"}),n.jsx("span",{className:"hidden min-[400px]:inline-block ml-3",children:o("actions.copy")})]})}),n.jsx($,{theme:"secondary",padding:"p-2 md:px-2",onClick:t.onClose,children:n.jsx(P,{icon:w.X,className:"text-2xl"})})]})]}),n.jsx("div",{className:"pointer-events-auto mt-4 h-60 select-text overflow-y-auto whitespace-pre text-left",children:a})]})},ui=Zc;function ed(e){return!e.show||!e.error?null:n.jsx("div",{className:"fixed inset-0 flex h-full w-full items-center justify-center bg-black bg-opacity-30 p-12",children:n.jsx("div",{className:"w-full max-w-2xl",children:n.jsx(ui,{error:e.error,onClose:e.onClose})})})}function td(e){return e.error?n.jsx(di,{id:e.id,children:n.jsx("div",{className:"pointer-events-auto w-11/12 max-w-2xl",children:n.jsx(ui,{error:e.error,onClose:e.onClose})})}):null}function nd(e){const{t}=R(),[s,r]=u.useState(!1),o=(e.errorInfo.componentStack||"").split(`
`).slice(0,5),a=`${e.error.toString()}
${o.join(`
`)}`;return n.jsx("div",{className:"relative flex min-h-screen flex-1 flex-col",children:n.jsx("div",{className:"flex h-full flex-1 flex-col items-center justify-center p-5 text-center",children:n.jsx(ss,{children:n.jsxs(ns,{maxWidth:"max-w-2xl w-9/10",children:[n.jsx(ts,{icon:w.EYE_SLASH,children:t("errors.badge")}),n.jsx(jt,{children:t("errors.title")}),n.jsx(ie,{children:e.error.toString()}),n.jsx(ed,{show:s,onClose:()=>r(!1),error:a}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Fs,{theme:"secondary",className:"mt-6 p-2.5 md:px-12",onClick:()=>window.location.reload(),children:t("errors.reloadPage")}),n.jsx(Fs,{theme:"purple",className:"mt-6 p-2.5 md:px-12",onClick:()=>r(!0),children:t("errors.showError")})]})]})})})})}class sd extends u.Component{constructor(t){super(t),this.state={error:void 0}}componentDidCatch(t,s){console.error("Render error caught",t,s),this.setState(r=>({...r,error:{error:t,errorInfo:s}}))}render(){return this.state.error?n.jsx(nd,{error:this.state.error.error,errorInfo:this.state.error.errorInfo}):this.props.children}}function Ge(e){const{t}=R();return n.jsxs("div",{className:_("flex items-center space-x-2 rounded-full px-4 py-2 text-type-logo",e.backgroundClass??"bg-pill-background bg-opacity-50",e.clickable?"transition-[transform,background-color] hover:scale-105 hover:bg-pill-backgroundHover backdrop-blur-lg hover:text-type-logo active:scale-95":""),children:[n.jsx(P,{className:"text-xl",icon:w.MOVIE_WEB}),n.jsx("span",{className:["font-semibold text-white",e.hideTextOnMobile?"hidden sm:block":""].join(" "),children:t("global.name")})]})}function mi(e){return n.jsx("div",{className:`mx-auto max-w-full px-8 ${e.ultraWide?"w-[1300px] sm:px-16":"w-[900px] sm:px-8"} ${e.classNames||""}`,children:e.children})}function Et(e){return n.jsx("div",{className:`mx-auto w-[600px] max-w-full px-8 sm:px-0 ${e.classNames||""}`,children:e.children})}function is(e){return n.jsx("div",{className:_("min-h-screen w-full flex justify-center p-8 py-24 items-center",e.classNames),children:n.jsx("div",{className:"w-[700px] max-w-full",children:e.children})})}function Pe(e){const{t}=R(),s=t(e.k),r=t("global.pages.pagetitle",{title:s});return n.jsx(Te,{children:n.jsx("title",{children:e.subpage?r:s})})}function hi(){return!!F().DMCA_EMAIL}function rd(){const{t:e}=R();return n.jsxs(ze,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.dmca"}),n.jsxs(Et,{children:[n.jsx(Ct,{children:e("screens.dmca.title")}),n.jsx(ie,{children:e("screens.dmca.text")}),n.jsxs(ie,{className:"flex space-x-3 items-center",children:[n.jsx(P,{icon:w.MAIL}),n.jsx("span",{children:F().DMCA_EMAIL??""})]})]})]})}function Gt(e){const t=oe(),s=u.useCallback(()=>{e.to&&t(e.to)},[t,e.to]);return n.jsxs("a",{href:e.href,target:e.href?"_blank":void 0,rel:"noreferrer",className:"tabbable rounded py-2 px-3 inline-flex cursor-pointer items-center space-x-3 transition-colors duration-200 hover:text-type-emphasis",onClick:e.to?s:void 0,children:[n.jsx(P,{icon:e.icon,className:"text-2xl"}),n.jsx("span",{className:"font-medium",children:e.children})]})}function Ys(){const{t:e}=R();return hi()?n.jsx(Gt,{to:"/dmca",icon:w.DRAGON,children:e("footer.links.dmca")}):null}function id(){const{t:e}=R();return n.jsx("footer",{className:"mt-16 border-t border-type-divider py-16 md:py-8",children:n.jsxs(mi,{ultraWide:!0,classNames:"grid md:grid-cols-2 gap-16 md:gap-8",children:[n.jsxs("div",{children:[n.jsx("div",{className:"inline-block",children:n.jsx(Ge,{})}),n.jsx("p",{className:"mt-4 lg:max-w-[400px]",children:e("footer.tagline")})]}),n.jsxs("div",{className:"md:text-right text-balance",children:[n.jsx("h3",{className:"font-semibold text-type-emphasis",children:e("footer.legal.disclaimer")}),n.jsx("p",{className:"mt-3",children:e("footer.legal.disclaimerText")})]}),n.jsxs("div",{className:"flex flex-wrap gap-[0.5rem] -ml-3",children:[n.jsx(Gt,{icon:w.DISCORD,href:F().DISCORD_LINK,children:e("footer.links.discord")}),n.jsx(Gt,{icon:w.FACEBOOK,href:F().FACEBOOK_LINK,children:e("footer.links.facebook")}),n.jsx(Gt,{icon:w.INSTAGRAM,href:F().INSTAGRAM_LINK,children:e("footer.links.instagram")}),n.jsx("div",{className:"inline md:hidden",children:n.jsx(Ys,{})})]}),n.jsx("div",{className:"hidden items-center justify-end md:flex -mr-3",children:n.jsx(Ys,{})})]})})}function fi(e){return n.jsxs("div",{className:["flex min-h-screen flex-col",e.className||""].join(" "),children:[n.jsx("div",{style:{flex:"1 0 auto"},children:e.children}),n.jsx(id,{})]})}function gi(e){return n.jsxs("div",{className:"relative inline-block",children:[n.jsx("div",{className:_(e.sizeClass,"rounded-full overflow-hidden flex items-center justify-center text-white"),style:{background:`linear-gradient(to bottom right, ${e.profile.colorA}, ${e.profile.colorB})`},children:n.jsx(Tr,{className:e.iconClass,icon:e.profile.icon})}),e.bottom?n.jsx("div",{className:"absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2",children:e.bottom}):null]})}function xi(e){const t=J(),s=u.useMemo(()=>t.account&&t.account.seed?Jn(t.account.seed):null,[t]);if(!t.account||t.account===null)return null;const r=s?oi(t.account.deviceName,s):"...";return n.jsxs(n.Fragment,{children:[n.jsx(gi,{profile:t.account.profile,sizeClass:e.sizeClass??"w-[1.5rem] h-[1.5rem] ssm:w-[2rem] ssm:h-[2rem]",iconClass:e.iconClass,bottom:e.bottom}),e.withName&&s?n.jsx("span",{className:"hidden md:inline-block",children:r.length>=20?`${r.slice(0,19)}…`:r}):null]})}function od(e){return n.jsx("div",{className:"relative inline-block p-1 text-type-dimmed",children:n.jsx(P,{className:e.iconClass??"text-base ssm:text-xl",icon:w.MENU})})}function qs(){return n.jsx("hr",{className:"border-0 w-full h-px bg-dropdown-border"})}const ad=function(t){const s=oe(),r=i=>{i.startsWith("http")?window.open(i,"_blank"):s(i)};return n.jsx("a",{tabIndex:0,href:t.href,onClick:i=>{var o;i.preventDefault(),t.href?r(t.href):(o=t.onClick)==null||o.call(t)},className:t.className,children:t.children})},pi=ad;function Ue(e){return n.jsxs(pi,{onClick:e.onClick,href:e.href,className:_("tabbable cursor-pointer flex gap-3 items-center m-3 p-1 rounded font-medium transition-colors duration-100",e.highlight?"text-dropdown-highlight hover:text-dropdown-highlightHover":"text-dropdown-text hover:text-white",e.className),children:[e.icon?n.jsx(P,{icon:e.icon,className:"text-xl"}):null,e.children]})}function Ut(e){return n.jsx(pi,{href:e.href,className:"tabbable w-11 h-11 rounded-full bg-dropdown-contentBackground text-dropdown-text hover:text-white transition-colors duration-100 flex justify-center items-center",children:n.jsx(P,{className:"text-2xl",icon:e.icon})})}function ld(e){const{t}=R(),[s,r]=u.useState(!1),i=J(d=>{var m;return(m=d.account)==null?void 0:m.deviceName}),o=J(d=>{var m;return(m=d.account)==null?void 0:m.seed}),a=u.useMemo(()=>o?Jn(o):null,[o]),{logout:l}=ct();u.useEffect(()=>{function d(m){m.target.closest(".is-dropdown")||r(!1)}return window.addEventListener("click",d),()=>window.removeEventListener("click",d)},[]);const c=u.useCallback(()=>{r(d=>!d)},[]);return n.jsxs("div",{className:"relative is-dropdown",children:[n.jsxs("div",{className:"cursor-pointer tabbable rounded-full flex gap-2 text-white items-center py-2 px-3 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover backdrop-blur-lg transition-[background,transform] duration-100 hover:scale-105",tabIndex:0,onClick:c,onKeyUp:d=>d.key==="Enter"&&c(),children:[e.children,n.jsx(P,{className:_("text-xl transition-transform duration-100",s?"rotate-180":""),icon:w.CHEVRON_DOWN})]}),n.jsx(de,{animation:"slide-down",show:s,children:n.jsxs("div",{className:"rounded-lg absolute w-64 bg-dropdown-altBackground top-full mt-3 right-0",children:[i&&a?n.jsxs(Ue,{className:"text-white",href:"/settings",children:[n.jsx(xi,{}),oi(i,a)]}):n.jsx(Ue,{href:"/login",icon:w.CLOUD,highlight:!0,children:t("navigation.menu.register")}),n.jsx(qs,{}),n.jsx(Ue,{href:"/discover",icon:w.COMPASS,children:t("navigation.menu.discover")}),n.jsx(Ue,{href:"/settings",icon:w.SETTINGS,children:t("navigation.menu.settings")}),n.jsx(Ue,{href:"/about",icon:w.CIRCLE_QUESTION,children:t("navigation.menu.about")}),n.jsx(Ue,{href:F().DONATION_LINK,icon:w.DONATION,children:t("navigation.menu.donation")}),i?n.jsx(Ue,{className:"!text-type-danger opacity-75 hover:opacity-100",icon:w.LOGOUT,onClick:l,children:t("navigation.menu.logout")}):null,n.jsx(qs,{}),n.jsxs("div",{className:"my-4 flex justify-center items-center gap-4",children:[n.jsx(Ut,{href:F().FACEBOOK_LINK,icon:w.FACEBOOK}),n.jsx(Ut,{href:F().INSTAGRAM_LINK,icon:w.INSTAGRAM}),n.jsx(Ut,{href:F().DISCORD_LINK,icon:w.DISCORD}),n.jsx(Ut,{href:F().GITHUB_LINK,icon:w.GITHUB})]})]})})]})}class cd{constructor(t){this.x=0,this.y=0,this.radius=0,this.direction=0,this.speed=0,this.lifetime=0,this.ran=0,this.image=null,this.size=10;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{horizontalMotion:!1,sizeRange:[10,10]};s.imgSrc&&(this.image=new Image,this.image.src=s.imgSrc),this.options=s,this.reset(t),this.initialize(t)}reset(t){this.x=Math.round(Math.random()*t.width/2+t.width/4),this.y=Math.random()*100+5,this.radius=1+Math.floor(Math.random()*.5),this.direction=Math.random()*Math.PI/2+Math.PI/4,this.speed=.02+Math.random()*.08;const s=60;this.lifetime=s*3+Math.random()*(s*30),this.size=this.options.sizeRange?Math.random()*(this.options.sizeRange[1]-this.options.sizeRange[0])+this.options.sizeRange[0]:10,this.options.horizontalMotion&&(this.direction=Math.random()<=.5?0:Math.PI,this.lifetime=30*s),this.ran=0}initialize(t){this.ran=Math.random()*this.lifetime;const s=this.speed;this.speed=Math.random()*this.lifetime*s,this.update(t),this.speed=s}update(t){this.ran+=1;const s=this.speed*Math.cos(this.direction),r=this.speed*Math.sin(this.direction);this.x+=s,this.y+=r,this.ran>this.lifetime&&this.reset(t)}render(t){const s=t.getContext("2d");if(!s)return;s.save(),s.beginPath();const r=this.ran/this.lifetime,i=(r-r*r)*4;if(s.globalAlpha=Math.max(0,i*.8),this.image){s.translate(this.x,this.y);const o=this.size,a=this.image.naturalWidth/this.image.naturalHeight*o;s.rotate(this.direction-Math.PI),s.drawImage(this.image,-o/2,a,a,o)}else s.ellipse(this.x,this.y,this.radius,this.radius*1.5,this.direction,0,Math.PI*2),s.fillStyle="white",s.fill();s.restore()}}function dd(){const e=u.useRef(null);return u.useEffect(()=>{var h,j;if(!e.current)return;const t=e.current,s=[];t.width=t.scrollWidth,t.height=t.scrollHeight;const r=20;let i=r,o=[];const a=new Date,l=a.getMonth(),c=a.getDate();l===11&&c>=24&&c<=26&&(o=[{image:"/lightbar-images/snowflake.svg",sizeRange:[4,15]},{image:"/lightbar-images/santa.png",sizeRange:[15,30]}]),l===9&&c>=29&&c<=31&&(o=[{image:"/lightbar-images/ghost.png",sizeRange:[20,33]},{image:"/lightbar-images/pumpkin.png",sizeRange:[25,35]}]),l===3&&c===20&&(o=[{image:"/lightbar-images/weed.png",sizeRange:[32,40]}]),Math.floor(Math.random()*600)===69&&(o=[{image:"/lightbar-images/fishie.png",sizeRange:[10,11]}],i=r/2);for(let y=0;y<r;y+=1){const x=o&&y<=i,v=Math.floor(Math.random()*o.length),I=(h=o[v])==null?void 0:h.sizeRange,A=(j=o[v])==null?void 0:j.image,M=new cd(t,{imgSrc:x?A:void 0,horizontalMotion:A==null?void 0:A.includes("fishie"),sizeRange:I});s.push(M)}let m=!0,b=null;function g(){if(t.getContext("2d")){if(m){for(const x of s)x.update(t);m=!1}t.width=t.scrollWidth,t.height=t.scrollHeight;for(const x of s)x.render(t);b=requestAnimationFrame(g)}}const f=setInterval(()=>{m=!0},1e3/120);return g(),()=>{b&&cancelAnimationFrame(b),clearInterval(f)}},[]),n.jsx("canvas",{className:"particles",ref:e})}const ud=function(t){return n.jsx("div",{className:"absolute inset-0 w-full h-[680px] overflow-hidden pointer-events-none -mt-64",children:n.jsx("div",{className:"max-w-screen w-full h-[680px] relative pt-64",children:n.jsx("div",{className:t.className,children:n.jsxs("div",{className:"lightbar",children:[n.jsx(dd,{}),n.jsx("div",{className:"lightbar-visual"})]})})})})},md=ud,ye=ne(se(e=>({banners:[],isOnline:!0,isTurnstile:!1,location:null,ignoredBannerIds:[],updateOnline(t){e(s=>{s.isOnline=t})},updateTurnstile(t){e(s=>{s.isTurnstile=t})},setLocation(t){e(s=>{s.location=t})},showBanner(t){e(s=>{s.banners.find(r=>r.id===t)||s.ignoredBannerIds.includes(t)||s.banners.push({id:t,height:0})})},hideBanner(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;e(r=>{s&&r.ignoredBannerIds.push(t),r.banners=r.banners.filter(i=>i.id!==t)})},updateHeight(t,s){e(r=>{const i=r.banners.find(o=>o.id===t);i&&(i.height=s)})}})));function hn(e){const t=e??null,s=ye(o=>o.banners),r=ye(o=>o.location),i=s.reduce((o,a)=>o+a.height,0);return t!==r?0:i}function hd(e){const[t,{height:s}]=Da(),r=ye(a=>a.updateHeight),i=ye(a=>a.showBanner),o=ye(a=>a.hideBanner);return u.useEffect(()=>(i(e),()=>{o(e)}),[i,o,e]),u.useEffect(()=>{r(e,s)},[s,e,r]),[t]}const fd=function(t){const s=hn(),{loggedIn:r}=ct();return n.jsxs(n.Fragment,{children:[t.noLightbar?null:n.jsx("div",{className:"absolute inset-x-0 top-0 flex h-[88px] items-center justify-center",style:{top:`${s}px`},children:n.jsx("div",{className:"absolute inset-x-0 -mt-[22%] flex items-center sm:mt-0",children:n.jsx(md,{})})}),n.jsx("div",{className:"top-content fixed z-[20] pointer-events-none left-0 right-0 top-0 min-h-[150px]",style:{top:`${s}px`},children:n.jsxs("div",{className:_("fixed left-0 right-0 top-0 flex items-center",t.doBackground?"bg-background-main border-b border-utils-divider border-opacity-50":null),children:[t.doBackground?n.jsx("div",{className:"absolute w-full h-full inset-0 overflow-hidden",children:n.jsx(It,{positionClass:"absolute"})}):null,n.jsx("div",{className:"opacity-0 absolute inset-0 block h-20 pointer-events-auto"}),n.jsx("div",{className:`${t.bg?"opacity-100":"opacity-0"} absolute inset-0 block h-24 bg-background-main transition-opacity duration-300`,children:n.jsx("div",{className:"absolute -bottom-24 h-24 w-full bg-gradient-to-b from-background-main to-transparent"})})]})}),n.jsx("div",{className:"top-content fixed pointer-events-none left-0 right-0 z-[60] top-0 min-h-[150px]",style:{top:`${s}px`},children:n.jsx("div",{className:_("fixed left-0 right-0 flex items-center"),children:n.jsxs("div",{className:"px-7 py-5 relative z-[60] flex flex-1 items-center justify-between",children:[n.jsx("div",{className:"flex items-center space-x-1.5 ssm:space-x-3 pointer-events-auto",children:n.jsx(Nt,{className:"block tabbable rounded-full text-xs ssm:text-base",to:"/",children:n.jsx(Ge,{clickable:!0})})}),n.jsx("div",{className:"relative pointer-events-auto",children:n.jsx(ld,{children:r?n.jsx(xi,{withName:!0}):n.jsx(od,{})})})]})})})]})},os=fd;function It(e){return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:_(e.positionClass??"fixed","top-0 -right-48 rotate-[32deg] w-[50rem] h-[15rem] rounded-[70rem] bg-background-accentA blur-[100px] pointer-events-none opacity-25 transition-colors duration-75")}),n.jsx("div",{className:_(e.positionClass??"fixed","top-0 right-48 rotate-[32deg] w-[50rem] h-[15rem] rounded-[70rem] bg-background-accentB blur-[100px] pointer-events-none opacity-25 transition-colors duration-75")})]})}function ze(e){return n.jsxs("div",{className:"bg-background-main",style:{backgroundImage:"linear-gradient(to bottom, var(--tw-gradient-from), var(--tw-gradient-to) 800px)"},children:[n.jsx(It,{}),n.jsxs(fi,{children:[n.jsx(os,{doBackground:!0,noLightbar:!0}),n.jsx("div",{className:"mt-40 relative",children:e.children})]})]})}function gd(){const{t:e}=R();return n.jsxs("div",{className:"flex flex-col justify-center items-center h-screen text-center font-medium",children:[n.jsx(It,{}),n.jsx("div",{className:"right-[calc(2rem+env(safe-area-inset-right))] top-6 absolute",children:n.jsx(Ge,{})}),n.jsx(We,{}),n.jsx("p",{className:"max-w-[19rem] mt-3 mb-12 text-type-secondary",children:e("screens.migration.inProgress")})]})}function bi(e){return n.jsxs("div",{className:"flex flex-col justify-center items-center h-screen text-center font-medium",children:[n.jsx(It,{}),n.jsx("div",{className:"right-[calc(2rem+env(safe-area-inset-right))] top-6 absolute",children:n.jsx(Ge,{})}),e.iconSlot?e.iconSlot:null,n.jsx("div",{className:"max-w-[19rem] mt-3 mb-12 text-type-secondary",children:e.children})]})}const xd="modulepreload",pd=function(e){return"/"+e},Qs={},fn=function(t,s,r){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(s.map(l=>{if(l=pd(l),l in Qs)return;Qs[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":xd,c||(m.as="script",m.crossOrigin=""),m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),c)return new Promise((b,g)=>{m.addEventListener("load",b),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}return i.then(()=>t()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})};function bd(){const e=ye(s=>s.updateOnline),t=u.useRef(!0);u.useEffect(()=>{let s=0,r=null;const i=setInterval(()=>{if(s+=1,t.current&&s<10)return;s=0,r&&r.abort(),r=new AbortController;const o=r.signal;fetch("/ping.txt",{signal:o}).then(()=>{e(!0),t.current=!0}).catch(a=>{a.name!=="AbortError"&&(e(!1),t.current=!1)})},5e3);return()=>{clearInterval(i),r&&r.abort()}},[e])}const yd=function(t){return n.jsx("ol",{children:t.items.map((s,r)=>n.jsxs("li",{className:_("grid grid-cols-[auto,1fr] gap-6",r!==t.items.length-1?"pb-12":void 0),children:[n.jsxs("div",{className:"relative z-0",children:[n.jsx("div",{className:"w-7 h-7 rounded-full bg-about-circle text-about-circleText font-medium flex justify-center items-center relative z-10",children:r+1}),r!==t.items.length-1?n.jsx("div",{className:"h-[calc(100%+1.5rem)] w-px absolute top-6 left-1/2 transform -translate-x-1/2",style:{backgroundImage:"linear-gradient(to bottom, transparent 5px, #1F1F29 5px, #1F1F29 10px)",backgroundSize:"10px 10px",backgroundRepeat:"Repeat"}}):null]}),n.jsx("div",{children:s})]}))})},vd=yd;function Ve(e){return n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-white mb-2 font-medium",children:e.title}),n.jsx("div",{className:"text-type-text",children:e.children})]})}function jd(){const{t:e}=R();return n.jsxs(ze,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.about"}),n.jsxs(Et,{children:[n.jsx(Ct,{children:e("about.title")}),n.jsx(ie,{children:e("about.description")}),n.jsx(ie,{children:e("about.contact")}),n.jsx(je,{children:e("about.faqTitle")}),n.jsx(vd,{items:[n.jsx(Ve,{title:e("about.q1.title"),children:e("about.q1.body")}),n.jsx(Ve,{title:e("about.q2.title"),children:e("about.q2.body")}),n.jsx(Ve,{title:e("about.q3.title"),children:e("about.q3.body")}),n.jsx(Ve,{title:e("about.q4.title"),children:e("about.q4.body")}),n.jsx(Ve,{title:e("about.q5.title"),children:e("about.q5.body")}),n.jsx(Ve,{title:e("about.q6.title"),children:e("about.q6.body")}),n.jsx(Ve,{title:e("about.q7.title"),children:e("about.q7.body")})]})]})]})}function De(e){return n.jsx("hr",{className:_("w-full h-px border-0 bg-utils-divider bg-opacity-50",e.marginClass??"my-8")})}async function wd(){const t=await(await fetch(`${He}/metrics`)).text(),s=/mw_provider_hostname_count{hostname="https?:\/\/[^"}]+"} (\d+)/g;let r=0,i=s.exec(t);for(;i!==null;)r+=parseInt(i[1],10),i=s.exec(t);if(r>0)return r.toString();throw new Error("ACCOUNT_NUMBER not found")}async function kd(){const t=await(await fetch(`${He}/metrics`)).text(),s=/mw_user_count{namespace="movie-web"} (\d+)/,r=t.match(s);if(r)return r[1];throw new Error("USER_COUNT not found")}function ft(e){return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex",children:[n.jsx("p",{className:"flex-1 font-bold text-white pr-5",children:e.name}),n.jsx("p",{children:e.children})]}),n.jsx(De,{marginClass:"my-3"})]})}function Nd(){const[e,t]=u.useState(null),[s,r]=u.useState(null),i=F().NORMAL_ROUTER,o=F().APP_VERSION,a=F().BACKEND_URL;return u.useEffect(()=>{wd().then(l=>{t(l)}).catch(l=>{console.error("Error fetching account number:",l)}),kd().then(l=>{r(l)}).catch(l=>{console.error("Error fetching all accounts:",l)})},[]),n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"mb-8 mt-12",children:"Site Constants"}),n.jsx(ft,{name:"Routing mode",children:i?"Normal routing":"Hash based routing"}),n.jsxs(ft,{name:"Application version",children:["v",o]}),n.jsx(ft,{name:"Backend requests",children:e}),n.jsx(ft,{name:"Total User Accounts",children:s}),n.jsx(ft,{name:"Backend URL",children:a})]})}function as(e){return n.jsx("div",{className:"bg-video-scraping-card rounded-xl p-8",children:e.children})}function Sd(){const e=F().TMDB_READ_API_KEY,[t,s]=u.useState({hasTested:!1,success:!1,errorText:""}),[r,i]=xe(async()=>{if(s({hasTested:!1,success:!1,errorText:""}),!e||e.length===0)return s({hasTested:!0,success:!1,errorText:"TMDB API key is not set"});if(!(e.split(".").length>2))return s({hasTested:!0,success:!1,errorText:"TMDB API key is not a read only key"});try{await cn("556574",me.MOVIE)}catch{return s({hasTested:!0,success:!1,errorText:"Failed to call TMDB, double check API key and your internet connection"})}return s({hasTested:!0,success:!0,errorText:""})},[e,s]);return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"mb-8 mt-12",children:"TMDB test"}),n.jsx(as,{children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-1",children:t.hasTested?t.success?n.jsxs("p",{className:"flex items-center",children:[n.jsx(P,{icon:w.CIRCLE_CHECK,className:"text-video-scraping-success mr-2"}),"TMDB is working as expected"]}):n.jsxs(n.Fragment,{children:[n.jsxs("p",{className:"text-white font-bold w-full mb-3 flex items-center gap-1",children:[n.jsx(P,{icon:w.CIRCLE_EXCLAMATION,className:"text-video-scraping-error mr-2"}),"TMDB is not working"]}),n.jsx("p",{children:t.errorText})]}):n.jsx("p",{children:"Run the test to validate TMDB"})}),n.jsxs($,{theme:"purple",onClick:i,children:[r.loading?n.jsx(dn,{className:"text-base mr-2"}):null,"Test TMDB"]})]})})]})}function Vt(e){return n.jsxs("div",{className:"flex mb-2",children:[n.jsx(P,{icon:e.errored?w.WARNING:e.success?w.CIRCLE_CHECK:w.EYE_SLASH,className:_({"text-xl mr-2 mt-0.5":!0,"text-video-scraping-error":e.errored,"text-video-scraping-noresult":!e.errored&&!e.success,"text-video-scraping-success":e.success})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-white font-bold",children:e.name}),e.errorText?n.jsx("p",{children:e.errorText}):null]})]})}function Cd(){const e=u.useMemo(()=>qn().map((l,c)=>({id:c.toString(),url:l})),[]),[t,s]=u.useState([]),[r,i]=u.useState(!1),[o,a]=xe(async()=>{i(!0);function l(d,m){s(b=>[...b.filter(g=>g.id!==d),m])}s([]);const c=e.map(async d=>{try{if(d.url.endsWith("/")){l(d.id,{id:d.id,status:"error",error:new Error("URL ends with slash")});return}await Qn(d.url,"https://postman-echo.com/get",{}),l(d.id,{id:d.id,status:"success"})}catch(m){const b=m;b.message=b.message.replace(d.url,"WORKER_URL"),l(d.id,{id:d.id,status:"error",error:b})}});await Promise.all(c),setTimeout(()=>i(!1),5e3)},[e,s]);return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"!mb-0 mt-12",children:"Worker tests"}),n.jsxs("p",{className:"mb-8 mt-2",children:[e.length," worker(s) registered"]}),n.jsxs(as,{children:[e.map((l,c)=>{var b;const d=t.find(g=>g.id===l.id),m=`Worker ${c+1}`;return d?d.status==="error"?n.jsx(Vt,{name:m,errored:!0,errorText:(b=d.error)==null?void 0:b.toString()},l.id):d.status==="success"?n.jsx(Vt,{name:m,success:!0},l.id):n.jsx(Vt,{name:m},l.id):n.jsx(Vt,{name:m},l.id)}),n.jsx(De,{}),n.jsx("div",{className:"flex justify-end",children:n.jsx($,{theme:"purple",loading:o.loading,onClick:r?void 0:a,disabled:r,children:"Test workers"})})]})]})}async function yi(e){return K("/meta",{baseURL:e})}function Ed(){var o,a,l,c;const e=F().BACKEND_URL,[t,s]=u.useState({hasTested:!1,success:!1,errorText:"",value:null}),[r,i]=xe(async()=>{if(s({hasTested:!1,success:!1,errorText:"",value:null}),!e)return s({hasTested:!0,success:!1,errorText:"Backend URL is not set",value:null});try{const d=await yi(e);return s({hasTested:!0,success:!0,errorText:"",value:d})}catch{return s({hasTested:!0,success:!1,errorText:"Failed to call backend, double check the URL, your internet connection, and ensure CORS is properly configured on your backend.",value:null})}},[s]);return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"mb-8 mt-12",children:"Backend API test"}),n.jsxs(as,{children:[n.jsx("div",{children:n.jsx("div",{className:"flex-1",children:t.hasTested&&t.success?n.jsxs(n.Fragment,{children:[n.jsxs("p",{children:[n.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Version:"}),(o=t.value)==null?void 0:o.version]}),n.jsxs("p",{children:[n.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Backend name:"}),(a=t.value)==null?void 0:a.name]}),n.jsxs("p",{children:[n.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Description:"}),((l=t.value)==null?void 0:l.description)??"Not set"]}),n.jsxs("p",{children:[n.jsx("span",{className:"inline-block w-36 text-white font-medium",children:"Captcha enabled:"}),(c=t.value)!=null&&c.hasCaptcha?"Yes":"No"]}),n.jsx(De,{})]}):null})}),n.jsxs("div",{className:"w-full flex gap-6 justify-between items-center",children:[t.hasTested?t.success?n.jsxs("p",{className:"flex items-center text-md",children:[n.jsx(P,{icon:w.CIRCLE_CHECK,className:"text-video-scraping-success mr-2"}),"Backend is working as expected"]}):n.jsxs("div",{children:[n.jsxs("p",{className:"text-white font-bold w-full mb-3 flex items-center gap-1",children:[n.jsx(P,{icon:w.CIRCLE_EXCLAMATION,className:"text-video-scraping-error mr-2"}),"Backend is not working"]}),n.jsx("p",{children:t.errorText})]}):n.jsx("p",{children:"Run the test to validate backend"}),n.jsx($,{theme:"purple",loading:r.loading,className:"whitespace-nowrap",onClick:i,children:"Test backend"})]})]})]})}function Id(){return n.jsx(ze,{children:n.jsxs(Et,{children:[n.jsx(Ct,{children:"Admin tools"}),n.jsx(ie,{children:"Useful tools to test out your current deployment"}),n.jsx(Nd,{}),n.jsx(Ed,{}),n.jsx(Cd,{}),n.jsx(Sd,{})]})})}function Td(e){return n.jsx("div",{className:"relative my-4 max-w-[25rem]",children:n.jsx(Mt,{value:e.selectedItem,onChange:e.setSelectedItem,children:()=>n.jsxs(n.Fragment,{children:[n.jsxs(Mt.Button,{className:"relative w-full rounded-lg bg-dropdown-background hover:bg-dropdown-hoverBackground py-3 pl-3 pr-10 text-left text-white shadow-md focus:outline-none tabbable cursor-pointer",children:[n.jsxs("span",{className:"flex gap-4 items-center truncate",children:[e.selectedItem.leftIcon?e.selectedItem.leftIcon:null,e.selectedItem.name]}),n.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:n.jsx(P,{icon:w.UP_DOWN_ARROW,className:"transform transition-transform text-xl text-dropdown-secondary"})})]}),n.jsx(yn,{as:u.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:n.jsx(Mt.Options,{className:"absolute left-0 right-0 top-10 z-[1] mt-4 max-h-60 overflow-auto rounded-md bg-dropdown-background py-1 text-white shadow-lg ring-1 ring-black ring-opacity-5 scrollbar-thin scrollbar-track-background-secondary scrollbar-thumb-type-secondary focus:outline-none sm:top-10",children:e.options.map(t=>n.jsxs(Mt.Option,{className:s=>{let{active:r}=s;return`cursor-pointer flex gap-4 items-center relative select-none py-3 pl-4 pr-4 ${r?"bg-background-secondaryHover text-type-link":"text-white"}`},value:t,children:[t.leftIcon?t.leftIcon:null,t.name]},t.id))})})]})})})}const Ld=e=>({casting:{instance:null,player:null,controller:null,setInstance(t){e(s=>{s.casting.instance=t})},setPlayer(t){e(s=>{s.casting.player=t})},setController(t){e(s=>{s.casting.controller=t})},setIsCasting(t){e(s=>{s.interface.isCasting=t})},clear(){e(t=>{t.casting.instance=null})}}}),Pd={unknown:0,360:10,480:20,720:30,1080:40,"4k":25},Fe=Object.entries(Pd).sort((e,t)=>t[1]-e[1]).map(e=>e[0]);function vi(e,t){if(t.automaticQuality||t.lastChosenQuality===null||t.lastChosenQuality==="unknown")return Fe.find(i=>e.includes(i));const s=Fe.indexOf(t.lastChosenQuality);let r;for(let i=s;i<Fe.length;i+=1)if(e.includes(Fe[i])){r=Fe[i];break}if(r)return r;for(let i=s;i>=0;i-=1)if(e.includes(Fe[i])){r=Fe[i];break}return r}function Rn(e,t){if(e.type==="hls")return{stream:e,quality:null};if(e.type==="file"){const s=Object.entries(e.qualities).filter(i=>(i[1].url.length??0)>0).map(i=>i[0]),r=vi(s,t);if(r){const i=e.qualities[r];if(i)return{stream:i,quality:r}}}throw new Error("couldn't select quality")}const ji={"4k":"4K",1080:"1080p",360:"360p",480:"480p",720:"720p",unknown:"unknown"},Rd=Object.keys(ji);function wi(e){return ji[e]}const yt=ne(Ee(se(e=>({quality:{automaticQuality:!0,lastChosenQuality:null},setLastChosenQuality(t){e(s=>{s.quality.lastChosenQuality=t})},setAutomaticQuality(t){e(s=>{s.quality.automaticQuality=t})}})),{name:"__MW::quality",merge:(e,t)=>Sr({},t,e)})),W={IDLE:"idle",SCRAPING:"scraping",PLAYING:"playing",SCRAPE_NOT_FOUND:"scrapeNotFound",PLAYBACK_ERROR:"playbackError"};function ki(e){if(e.type==="show"){if(!e.episode||!e.season)throw new Error("missing show data");return{title:e.title,releaseYear:e.releaseYear,tmdbId:e.tmdbId,type:"show",imdbId:e.imdbId,episode:e.episode,season:e.season}}return{title:e.title,releaseYear:e.releaseYear,tmdbId:e.tmdbId,type:"movie",imdbId:e.imdbId}}const Ad=(e,t)=>({source:null,sourceId:null,qualities:[],audioTracks:[],captionList:[],currentQuality:null,currentAudioTrack:null,status:W.IDLE,meta:null,caption:{selected:null,asTrack:!1},setSourceId(s){e(r=>{r.status=W.PLAYING,r.sourceId=s})},setStatus(s){e(r=>{r.status=s})},setMeta(s,r){e(i=>{i.meta=s,i.interface.hideNextEpisodeBtn=!1,r&&(i.status=r)})},setCaption(s){var i;(i=t().display)==null||i.setCaption(s),e(o=>{o.caption.selected=s})},setSource(s,r,i){let o=[];s.type==="file"&&(o=Object.keys(s.qualities));const a=yt.getState(),l=Rn(s,a.quality);e(d=>{d.source=s,d.qualities=o,d.currentQuality=l.quality,d.captionList=r,d.interface.error=void 0,d.status=W.PLAYING,d.audioTracks=[],d.currentAudioTrack=null}),t().redisplaySource(i)},redisplaySource(s){var l;const r=t(),i=r.currentQuality;if(!r.source)return;const o=yt.getState(),a=Rn(r.source,{automaticQuality:o.quality.automaticQuality,lastChosenQuality:i});e(c=>{c.interface.error=void 0,c.status=W.PLAYING}),(l=r.display)==null||l.load({source:a.stream,startAt:s,automaticQuality:o.quality.automaticQuality,preferredQuality:o.quality.lastChosenQuality})},switchQuality(s){var i,o;const r=t();if(r.source)if(r.source.type==="file"){const a=r.source.qualities[s];if(!a)return;e(l=>{l.currentQuality=s,l.status=W.PLAYING,l.interface.error=void 0}),(i=r.display)==null||i.load({source:a,startAt:r.progress.time,automaticQuality:!1,preferredQuality:s})}else r.source.type==="hls"&&((o=r.display)==null||o.changeQuality(!1,s))},enableAutomaticQuality(){var r;(r=t().display)==null||r.changeQuality(!0,null)}}),_d=(e,t)=>({display:null,setDisplay(s){const r=t().display;if(r&&r.destroy(),!s){e(i=>{i.display=null});return}s.on("pause",()=>e(i=>{i.mediaPlaying.isPaused=!0,i.mediaPlaying.isPlaying=!1})),s.on("play",()=>e(i=>{i.mediaPlaying.hasPlayedOnce=!0,i.mediaPlaying.isPaused=!1,i.mediaPlaying.isPlaying=!0})),s.on("fullscreen",i=>e(o=>{o.interface.isFullscreen=i})),s.on("time",i=>e(o=>{o.progress.time=i})),s.on("volumechange",i=>e(o=>{o.mediaPlaying.volume=i})),s.on("duration",i=>e(o=>{o.progress.duration=i})),s.on("buffered",i=>e(o=>{o.progress.buffered=i})),s.on("loading",i=>e(o=>{o.mediaPlaying.isLoading=i})),s.on("qualities",i=>{e(o=>{o.qualities=i})}),s.on("changedquality",i=>{e(o=>{o.currentQuality=i})}),s.on("audiotracks",i=>{e(o=>{o.audioTracks=i})}),s.on("changedaudiotrack",i=>{e(o=>{o.currentAudioTrack=i})}),s.on("needstrack",i=>{e(o=>{o.caption.asTrack=i})}),s.on("canairplay",i=>{e(o=>{o.interface.canAirplay=i})}),s.on("playbackrate",i=>{e(o=>{o.mediaPlaying.playbackRate=i})}),s.on("error",i=>{e(o=>{o.status=W.PLAYBACK_ERROR,o.interface.error=i})}),e(i=>{i.display=s})},reset(){var s;(s=t().display)==null||s.load({source:null,startAt:0,automaticQuality:!1,preferredQuality:null}),e(r=>{r.status=W.IDLE,r.meta=null,r.thumbnails.images=[],r.progress.time=0,r.progress.duration=0})}});let Je=function(e){return e[e.REGULAR=0]="REGULAR",e[e.REMAINING=1]="REMAINING",e}({}),ve=function(e){return e.NOT_HOVERING="not_hovering",e.MOUSE_HOVER="mouse_hover",e.MOBILE_TAPPED="mobile_tapped",e}({});const Md=(e,t)=>({interface:{isCasting:!1,hasOpenOverlay:!1,isFullscreen:!1,isSeeking:!1,lastVolume:0,leftControlHovering:!1,isHoveringControls:!1,hovering:ve.NOT_HOVERING,lastHoveringState:ve.NOT_HOVERING,volumeChangedWithKeybind:!1,volumeChangedWithKeybindDebounce:null,timeFormat:Je.REGULAR,canAirplay:!1,hideNextEpisodeBtn:!1,shouldStartFromBeginning:!1},setShouldStartFromBeginning(s){e(r=>{r.interface.shouldStartFromBeginning=s})},setLastVolume(s){e(r=>{r.interface.lastVolume=s})},setHasOpenOverlay(s){e(r=>{r.interface.hasOpenOverlay=s})},setTimeFormat(s){e(r=>{r.interface.timeFormat=s})},updateInterfaceHovering(s){e(r=>{s!==ve.NOT_HOVERING&&(r.interface.lastHoveringState=s),r.interface.hovering=s})},setSeeking(s){const r=t().display;r==null||r.setSeeking(s),e(i=>{i.interface.isSeeking=s})},setHoveringLeftControls(s){e(r=>{r.interface.leftControlHovering=s})},setHoveringAnyControls(s){e(r=>{r.interface.isHoveringControls=s})},hideNextEpisodeButton(){e(s=>{s.interface.hideNextEpisodeBtn=!0})}}),Od=e=>({mediaPlaying:{isPlaying:!1,isPaused:!0,isLoading:!1,isSeeking:!1,isDragSeeking:!1,hasPlayedOnce:!1,volume:1,playbackRate:1},play(){e(t=>{t.mediaPlaying.isPlaying=!0,t.mediaPlaying.isPaused=!1})},pause(){e(t=>{t.mediaPlaying.isPlaying=!1,t.mediaPlaying.isPaused=!1})}}),Dd=e=>({progress:{time:0,duration:0,buffered:0,draggingTime:0},setDraggingTime(t){e(s=>{s.progress.draggingTime=t})}});function Bd(e,t){if(e.length===0)return null;const s=e.findIndex(l=>l.at>t);if(s===-1)return{index:e.length-1,image:e[e.length-1]};const r=e[s];if(s===0)return{index:s,image:r};const i=e[s-1],o=t-i.at,a=r.at-t;return o<a?{index:s-1,image:i}:{index:s,image:r}}const Ud=(e,t)=>({thumbnails:{images:[],resetImages(){e(s=>{s.thumbnails.images=[]})},addImage(s){const r=t(),i=r.thumbnails.images.findIndex(a=>a.at>=s.at);if(i===-1){e(a=>{a.thumbnails.images.push(s),a.thumbnails.images=[...a.thumbnails.images]});return}if(r.thumbnails.images[i].at===s.at){e(a=>{a.thumbnails.images[i]=s,a.thumbnails.images=[...a.thumbnails.images]});return}e(a=>{a.thumbnails.images.splice(i,0,s),a.thumbnails.images=[...a.thumbnails.images]})}}}),p=ne(se(function(){return{...Md(...arguments),...Dd(...arguments),...Od(...arguments),...Ad(...arguments),..._d(...arguments),...Ld(...arguments),...Ud(...arguments)}})),Vd=$a.sanitize;function Fd(e,t,s,r){const i=e/1e3+s,o=t/1e3+s;return Math.max(0,i)<=r&&Math.max(0,o)>=r}function $d(e,t,s){return`${e}-${t}-${s}`}function Ni(e){const t=e.trim();if(t==="")throw new Error("Given text is empty");const s=rn(t,"vtt");if(Ar(s)==="")throw new Error("Invalid subtitle format");return s}function Si(e){const t=e.trim();if(t==="")throw new Error("Given text is empty");const s=rn(t,"srt");if(Ar(s)==="")throw new Error("Invalid subtitle format");return s}function Hd(e){return e.reduce((t,s)=>{const r=t[t.length-1],i=(r==null?void 0:r.start)===s.start&&(r==null?void 0:r.end)===s.end&&(r==null?void 0:r.content)===s.content;return(r===void 0||!i)&&t.push(s),t},[])}function Ci(e){return Ha(e).filter(t=>t.type==="caption")}function Wd(e,t){const s=Ni(e);return Ci(s)}function Gd(e){return btoa(String.fromCodePoint(...new TextEncoder().encode(e)))}function zd(e){return`data:application/x-subrip;base64,${Gd(Si(e))}`}function Kd(e){return URL.createObjectURL(new Blob([Ni(e)],{type:"text/vtt"}))}function An(e){return e.map(t=>({id:t.id,language:t.language,url:t.url,needsProxy:t.hasCorsRestrictions,opensubtitles:t.opensubtitles}))}const Ei=Wa().map(e=>`.${e}`),en=new Zr;en.setCompare((e,t)=>e===t);const Yd=24*60*60;async function qd(e){const t=en.get(e.url);if(t)return t;let s;if(e.needsProxy)if(be()){const i=await Br({url:e.url,method:"GET"});if(!(i!=null&&i.success)||typeof i.response.body!="string")throw new Error("failed to get caption data from extension");s=i.response.body}else s=await In(e.url,{responseType:"text"});else s=await fetch(e.url).then(i=>i.text());if(!s)throw new Error("failed to get caption data");const r=Si(s);return en.set(e.url,r,Yd),r}async function Qd(e){const t=en.get(e);return t||await fetch(e).then(r=>r.text())}function Tt(){const e=Q(x=>x.setLanguage),t=Q(x=>x.enabled),s=Q(x=>x.resetSubtitleSpecificSettings),r=p(x=>x.setCaption),i=Q(x=>x.lastSelectedLanguage),o=Q(x=>x.setIsOpenSubtitles),a=p(x=>x.captionList),l=p(x=>{var v;return(v=x.display)==null?void 0:v.getCaptionList}),c=p(x=>{var v;return(v=x.display)==null?void 0:v.getSubtitleTracks}),d=p(x=>{var v;return(v=x.display)==null?void 0:v.setSubtitlePreference}),m=u.useMemo(()=>a.length!==0?a:(l==null?void 0:l())??[],[a,l]),b=u.useCallback(async x=>{var A,M;const v=m.find(O=>O.id===x);if(!v)return;const I={id:v.id,language:v.language,url:v.url,srtData:""};if(v.hls){await(d==null?void 0:d(v.language));const O=c==null?void 0:c().find(V=>V.id.toString()===v.id&&V.details!==void 0);if(!O)return;const C=((M=(A=O.details)==null?void 0:A.fragments)==null?void 0:M.filter(V=>V!==null&&V.url!==null))??[],k=(await Promise.all(C.map(async V=>{const Y=await Qd(V.url);return Ci(Y)}))).flat(),D=Hd(k),U=Ga.build(D,{format:"srt"});I.srtData=U}else{const O=await qd(v);I.srtData=O}o(!!v.opensubtitles),r(I),s(),e(v.language)},[o,e,m,r,s,c,d]),g=u.useCallback(async x=>{const v=m.find(I=>I.language===x);if(v)return b(v.id)},[m,b]),f=u.useCallback(async()=>{o(!1),r(null),e(null)},[r,e,o]),h=u.useCallback(async()=>(await g(i??"en"),!0),[i,g]),j=u.useCallback(async()=>{t?f():await h()},[h,f,t]),y=u.useCallback(async()=>{t&&await h()},[h,t]);return{selectLanguage:g,disable:f,selectLastUsedLanguage:h,toggleLastUsed:j,selectLastUsedLanguageIfEnabled:y,selectCaptionById:b}}function Xd(){const e=p(r=>r.display),t=Xn(r=>r.volume);return{init:u.useCallback(()=>{e==null||e.setVolume(t)},[e,t])}}function Jd(){const e=p(i=>i.source),t=u.useMemo(()=>e?JSON.stringify(e):null,[e]),{selectLastUsedLanguageIfEnabled:s}=Tt(),r=u.useRef(s);u.useEffect(()=>{r.current=s},[s]),u.useEffect(()=>{t&&r.current()},[t])}function Zd(e,t){var i;const s=e[(t==null?void 0:t.tmdbId)??""];if(!s||!t)return 0;if(t.type==="movie")return s.progress?s.progress.watched:0;const r=s.episodes[((i=t.episode)==null?void 0:i.tmdbId)??""];return r?r.progress.watched:0}function Ii(){const e=p(g=>g.setStatus),t=p(g=>g.setMeta),s=p(g=>g.setSource),r=p(g=>g.setCaption),i=p(g=>g.setSourceId),o=p(g=>g.status),a=p(g=>g.interface.shouldStartFromBeginning),l=p(g=>g.setShouldStartFromBeginning),c=p(g=>g.reset),d=p(g=>g.meta),{init:m}=Xd(),b=re();return{meta:d,reset:c,status:o,shouldStartFromBeginning:a,setShouldStartFromBeginning:l,setMeta(g,f){t(g,f)},playMedia(g,f,h,j){const y=j??Zd(b.items,d);r(null),s(g,f,y),i(h),e(W.PLAYING),m()},setScrapeStatus(){e(W.SCRAPING)},setScrapeNotFound(){e(W.SCRAPE_NOT_FOUND)}}}const ls=u.forwardRef((e,t)=>{let{onChange:s,onUnFocus:r,value:i,label:o,name:a,autoComplete:l,className:c,placeholder:d,onFocus:m,passwordToggleable:b}=e,g="text";const[f,h]=u.useState(!0);b&&(g=f?"password":"text");const j=n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:g,ref:t,className:_(c,b&&"pr-12"),placeholder:d,onChange:y=>s&&s(y.target.value),value:i,name:a,autoComplete:l,onBlur:()=>r&&r(),onFocus:()=>m==null?void 0:m(),onKeyDown:y=>y.key==="Enter"?y.target.blur():null}),b?n.jsx("button",{type:"button",className:"absolute top-1/2 -translate-y-1/2 right-1 text-xl p-3",onClick:()=>h(!f),children:n.jsx(P,{icon:f?w.EYE:w.EYE_SLASH})}):null]});return o?n.jsxs("label",{children:[n.jsx("span",{children:o}),j]}):j});function eu(e){return n.jsx("p",{className:_("text-errors-type-secondary",e.marginClass??"mt-6"),children:e.children})}function tu(){const{t:e}=R(),t=p(r=>r.interface.error),s=rs("error");return n.jsxs(ss,{children:[n.jsxs(ns,{children:[n.jsx(ts,{icon:w.WAND,children:e("player.playbackError.badge")}),n.jsx(jt,{children:e("player.playbackError.title")}),n.jsx(eu,{children:e("player.playbackError.text")}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx($,{href:"/",theme:"secondary",padding:"md:px-12 p-2.5",className:"mt-6",children:e("player.playbackError.homeButton")}),n.jsx($,{onClick:()=>s.show(),theme:"purple",padding:"md:px-12 p-2.5",className:"mt-6",children:e("errors.showError")})]})]}),n.jsx(td,{onClose:()=>s.hide(),error:t,id:s.id})]})}function nu(){const e=()=>{alert(`Due to Apple’s limitations, Picture-in-Picture (PiP) and Fullscreen are disabled on iOS PWAs. Use the browser version to re-enable these features.
Tip: To hide the iOS home indicator, use guided access within the PWA!`)};return n.jsx("button",{type:"button",onClick:e,className:"tabbable p-2 rounded-full hover:bg-video-buttonBackground hover:bg-opacity-50 transition-transform duration-100 flex items-center gap-3 active:scale-110 active:bg-opacity-75 active:text-white",children:n.jsx(P,{className:"text-2xl",icon:w.CIRCLE_QUESTION})})}const we=u.forwardRef((e,t)=>n.jsxs("button",{ref:t,type:"button",onClick:s=>{var r;return(r=e.onClick)==null?void 0:r.call(e,s.currentTarget)},className:_(["tabbable p-2 rounded-full hover:bg-video-buttonBackground hover:bg-opacity-50 transition-transform duration-100 flex items-center gap-3",e.activeClass??"active:scale-110 active:bg-opacity-75 active:text-white",e.className??""]),children:[e.icon&&n.jsx(P,{className:e.iconSizeClass||"text-2xl",icon:e.icon}),e.children]}));function Xs(e){const t=p(i=>i.display),{isPaused:s}=p(i=>i.mediaPlaying),r=()=>{s?t==null||t.play():t==null||t.pause()};return n.jsx(we,{className:e.className,iconSizeClass:e.iconSizeClass,onClick:r,icon:s?w.PLAY:w.PAUSE})}function Js(){const{isFullscreen:e}=p(s=>s.interface),t=p(s=>s.display);return n.jsx(we,{onClick:()=>t==null?void 0:t.toggleFullscreen(),icon:e?w.COMPRESS:w.EXPAND})}const Ti=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let pn=null;async function tn(){if(pn===null){const e=new Promise(s=>{setTimeout(()=>s(!1),1e3)}),t=new Promise(s=>{const r=document.createElement("video"),i=()=>{r.removeEventListener("volumechange",i),s(!0)};r.addEventListener("volumechange",i),r.volume=.5});pn=await Promise.race([t,e])}return pn}function gn(){return fe.fullscreenEnabled}function Li(){return gn()||Ti}function Pi(){return gn()||Li()}function Ri(){return"pictureInPictureEnabled"in document}function Ai(){return"webkitSupportsPresentationMode"in document.createElement("video")}function zt(e){return Ce.isSupported()?!1:!!e.canPlayType("application/vnd.apple.mpegurl")}function su(){const e=Ro();return(e==null?void 0:e.type)!=="browser"?"unknown":e.name==="ios"||e.name==="ios-webview"?"ios":e.name==="chrome"||e.name==="chromium-webview"||e.name==="edge-chromium"||e.name==="opera"?"chrome":e.name==="firefox"?"firefox":"unknown"}function Zs(){const e=p(t=>t.display);return!Ri()&&!Ai()?null:n.jsx(we,{onClick:()=>e==null?void 0:e.togglePictureInPicture(),icon:w.PICTURE_IN_PICTURE})}function ru(e){return`${e.toFixed(2)}%`}function er(e){return Number(Math.max(0,Math.min(e,100)).toFixed(2))}function iu(e){return e.type==="mousedown"||e.type==="mouseup"||e.type==="mousemove"}const bn=e=>iu(e)?e.pageX:e.changedTouches[0].pageX;function cs(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const[r,i]=u.useState(!1),[o,a]=u.useState(0);u.useEffect(()=>{function c(m){if(!r||!e.current)return;const b=e.current.getBoundingClientRect(),g=(bn(m)-b.left)/e.current.offsetWidth;a(g*100),s&&t(g)}function d(m){if(!r||(i(!1),document.body.removeAttribute("data-no-select"),!e.current))return;const b=e.current.getBoundingClientRect(),g=(bn(m)-b.left)/e.current.offsetWidth;t(g)}return document.addEventListener("mousemove",c),document.addEventListener("touchmove",c),document.addEventListener("mouseup",d),document.addEventListener("touchend",d),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c),document.removeEventListener("mouseup",d),document.removeEventListener("touchend",d)}},[r,e,t,s]);const l=u.useCallback(c=>{if(i(!0),document.body.setAttribute("data-no-select","true"),!e.current)return;const d=e.current.getBoundingClientRect(),m=(bn(c)-d.left)/e.current.offsetWidth*100;a(m)},[a,e]);return{dragging:r,dragPercentage:o,dragMouseDown:l}}function Kt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Number.isNaN(e))return t?"0:00:00":"0:00";let s=e;const r=Math.floor(s%60);s/=60;const i=Math.floor(s%60);s/=60;const o=Math.floor(s),a=r.toString().padStart(2,"0"),l=i.toString().padStart(2,"0");return t?[o,l,a].join(":"):[l,a].join(":")}function _n(e){return e>60*60}function ou(e){const t=p(a=>a.thumbnails.images),s=u.useMemo(()=>{var a;return(a=Bd(t,e.at))==null?void 0:a.image},[t,e.at]),[r,i]=u.useState({offscreenLeft:0,offscreenRight:0}),o=u.useRef(null);return u.useEffect(()=>{if(!o.current)return;const a=o.current.getBoundingClientRect(),l=32,c=Math.max(0,(a.left-l)*-1),d=Math.max(0,a.right+l-window.innerWidth);i({offscreenLeft:c,offscreenRight:d})},[e.at]),!e.show||!s?null:n.jsx("div",{className:"flex flex-col items-center -translate-x-1/2 pointer-events-none",children:n.jsx("div",{className:"w-screen flex justify-center",children:n.jsx("div",{ref:o,children:n.jsxs("div",{style:{transform:`translateX(${r.offscreenLeft>0?r.offscreenLeft:-r.offscreenRight}px)`},children:[n.jsx("img",{src:s.data,className:"h-24 border rounded-xl border-gray-800"}),n.jsx("p",{className:"text-center mt-1",children:Kt(Math.max(e.at,0),_n(e.at))})]})})})})}function au(e){const[t,s]=u.useState(-1),r=u.useCallback(o=>{if(!e.current)return;const l=e.current.getBoundingClientRect(),c=(o.pageX-l.left)/e.current.offsetWidth;s(c*100)},[s,e]),i=u.useCallback(()=>{s(-1)},[s]);return{mousePos:t,mouseMove:r,mouseLeave:i}}const lu=function(){const{duration:t,time:s,buffered:r}=p(y=>y.progress),i=p(y=>y.display),o=p(y=>y.setDraggingTime),a=p(y=>y.setSeeking),{isSeeking:l}=p(y=>y.interface),c=u.useCallback(y=>{i==null||i.setTime(y*t)},[t,i]),d=u.useRef(null),{mouseMove:m,mouseLeave:b,mousePos:g}=au(d),{dragging:f,dragPercentage:h,dragMouseDown:j}=cs(d,c);return u.useEffect(()=>{a(f)},[a,f]),u.useEffect(()=>{o(h/100*t)},[o,t,h]),n.jsxs("div",{className:"w-full relative",dir:"ltr",children:[n.jsx("div",{className:"top-0 absolute inset-x-0",children:n.jsx("div",{className:"absolute bottom-0",style:{left:`${g}%`},children:n.jsx(ou,{at:Math.floor(g/100*t),show:g>-1})})}),n.jsx("div",{className:"w-full",ref:d,children:n.jsx("div",{className:"group w-full h-8 flex items-center cursor-pointer",onMouseDown:j,onTouchStart:j,onMouseLeave:b,onMouseMove:m,children:n.jsxs("div",{className:["relative w-full h-1 bg-progress-background bg-opacity-25 rounded-full transition-[height] duration-100 group-hover:h-1.5",f?"!h-1.5":""].join(" "),children:[n.jsx("div",{className:"absolute top-0 left-0 h-full rounded-full bg-progress-preloaded bg-opacity-50 flex justify-end items-center",style:{width:`${r/t*100}%`}}),n.jsx("div",{className:"absolute top-0 dir-neutral:left-0 h-full rounded-full bg-progress-filled flex justify-end items-center",style:{width:`${Math.max(0,Math.min(1,f?h/100:s/t))*100}%`},children:n.jsx("div",{className:["w-[1rem] min-w-[1rem] h-[1rem] rounded-full transform translate-x-1/2 scale-0 group-hover:scale-100 bg-white transition-[transform] duration-100",l?"scale-100":""].join(" ")})})]})})})]})},cu=lu;function tr(e){const t=p(i=>i.display),s=p(i=>i.progress.time),r=u.useCallback(()=>{t==null||t.setTime(s+10)},[t,s]);return n.jsx(we,{iconSizeClass:e.iconSizeClass,onClick:r,icon:w.SKIP_FORWARD})}function nr(e){const t=p(i=>i.display),s=p(i=>i.progress.time),r=u.useCallback(()=>{t==null||t.setTime(s-10)},[t,s]);return n.jsx(we,{iconSizeClass:e.iconSizeClass,onClick:r,icon:w.SKIP_BACKWARD})}function sr(e){const t=p(x=>x.interface.timeFormat),s=p(x=>x.setTimeFormat),{duration:r,time:i,draggingTime:o}=p(x=>x.progress),{isSeeking:a}=p(x=>x.interface),{t:l}=R(),c=_n(r);function d(){s(t===Je.REGULAR?Je.REMAINING:Je.REGULAR)}const m=Math.min(Math.max(a?o:i,0),r),b=Math.abs(m-r),g=Kt(b,_n(b)),f=Kt(m,c),h=new Date(Date.now()+b*1e3),j=Kt(r,c);let y=t===Je.REGULAR?"regular":"remaining";return e.short&&(y=t===Je.REGULAR?"shortRegular":"shortRemaining"),n.jsx(we,{onClick:()=>d(),children:n.jsx("span",{children:l(`player.time.${y}`,{timeFinished:h,timeWatched:f,timeLeft:g,duration:j,formatParams:{timeFinished:{hour:"numeric",minute:"numeric"}}})})})}function du(){return p(t=>t.mediaPlaying.isLoading)?n.jsx(dn,{className:"text-4xl"}):null}function uu(){const e=p(a=>a.display),t=p(a=>a.mediaPlaying.isPlaying),s=p(a=>a.mediaPlaying.isLoading),r=p(a=>a.mediaPlaying.hasPlayedOnce),i=p(a=>a.status),o=u.useCallback(()=>{e==null||e.play()},[e]);return r||t||s||i!==W.PLAYING?null:n.jsx("div",{onClick:o,className:"group pointer-events-auto flex h-16 w-16 cursor-pointer items-center justify-center bg-video-autoPlay-background hover:bg-video-autoPlay-hover rounded-full text-white transition-[background-color,transform] hover:scale-125 active:scale-100",children:n.jsx(P,{icon:w.PLAY,className:"text-2xl transition-transform group-hover:scale-125"})})}function _i(){const e=p(a=>a.mediaPlaying.volume),t=p(a=>a.interface.lastVolume),s=p(a=>a.setLastVolume),r=p(a=>a.display),i=Xn(a=>a.setVolume),o=()=>{let a=0;e>0?(a=0,s(e)):t>0?a=t:a=1,r==null||r.setVolume(a),i(a)};return{toggleMute(){o()},setVolume(a){i(a),s(a),r==null||r.setVolume(a)}}}const mu=function(t){const s=u.useRef(null),r=p(I=>I.setHoveringLeftControls),i=p(I=>I.interface.leftControlHovering),o=p(I=>I.mediaPlaying.volume),{setVolume:a,toggleMute:l}=_i(),c=u.useCallback(I=>{a(I)},[a]),{dragging:d,dragPercentage:m,dragMouseDown:b}=cs(s,c,!0),g=u.useCallback(()=>{l()},[l]),f=u.useCallback(async()=>{await tn()&&r(!0),document.body.classList.add("overflow-y-hidden")},[r]),h=()=>{document.body.classList.remove("overflow-y-hidden")};let j=er(o*100);d&&(j=er(m));const y=ru(j),x=u.useCallback(I=>{I.preventDefault();let A=o-I.deltaY/1e3;A=Math.max(0,Math.min(A,1)),a(A)},[o,a]),v=I=>I===0?w.VOLUME_X:I>0&&I<=.33?w.VOLUME_LOW:I>.33&&I<=.66?w.VOLUME_MED:w.VOLUME;return n.jsx("div",{className:t.className,onMouseEnter:f,onMouseLeave:h,onWheel:x,children:n.jsxs("div",{className:"pointer-events-auto flex cursor-pointer items-center py-0 touch-none",children:[n.jsx("div",{className:"px-4 text-2xl text-white",onClick:g,children:n.jsx(P,{icon:v(j/100)})}),n.jsx("div",{className:`linear -ml-2 w-0 overflow-hidden transition-[width,opacity] duration-300 ${i||d?"!w-24 opacity-100":"w-4 opacity-0"}`,children:n.jsx("div",{ref:s,className:"flex h-10 w-20 items-center px-2",onMouseDown:b,onTouchStart:b,children:n.jsx("div",{className:"relative h-1 flex-1 rounded-full bg-gray-500 bg-opacity-50",children:n.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center justify-end rounded-full bg-video-audio-set",style:{width:y},children:n.jsx("div",{className:"absolute h-3 w-3 translate-x-1/2 rounded-full bg-white"})})})})})]})})},hu=mu;function fu(){const e=p(t=>{var s;return(s=t.meta)==null?void 0:s.title});return n.jsx("p",{children:e})}function gu(){var s,r,i;const{t:e}=R(),t=p(o=>o.meta);return(t==null?void 0:t.type)!=="show"?null:n.jsxs("div",{className:"flex gap-3",children:[n.jsx("span",{className:"text-white font-medium",children:e("media.episodeDisplay",{season:(s=t==null?void 0:t.season)==null?void 0:s.number,episode:(r=t==null?void 0:t.episode)==null?void 0:r.number})}),n.jsx("span",{className:"text-type-secondary font-medium",children:(i=t==null?void 0:t.episode)==null?void 0:i.title})]})}function Mi(e){return n.jsxs("div",{className:_("relative",e.className),children:[n.jsx("div",{id:`__overlayRouter::${e.id}`,className:"absolute inset-0 -z-10"}),e.children]})}function Lt(e){const[t,s]=u.useState(!1),r=u.useRef(!1);return u.useEffect(()=>{function i(){const o=window.innerWidth<1024;r.current!==o&&(r.current=o,s(o))}return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[e]),{isMobile:t}}function le(e){const t=dt(e.id),s=t.showBackwardsTransition(e.path),r=t.isCurrentPage(e.path),i=st(d=>d.registerRoute),o=u.useMemo(()=>t.makePath(e.path),[e.path,t]),{isMobile:a}=Lt();u.useEffect(()=>{i({id:o,width:e.width,height:e.height})},[e.height,e.width,o,i]);const l=a?"100%":`${e.width}px`;let c="none";return(s==="yes"||s==="no")&&(c=s==="yes"?"slide-full-left":"slide-full-right"),n.jsx(de,{animation:c,className:"absolute inset-0",durationClass:"duration-[400ms]",show:r,children:n.jsx("div",{className:_(["grid grid-rows-1 max-h-full",e.className]),style:{height:e.height?`${e.height}px`:void 0,width:e.width?l:void 0},children:e.children})})}function xu(){const e=st(d=>d.anchorPoint),t=u.useRef(null),[s,r]=u.useState(0),[i,o]=u.useState(0),[a,l]=u.useState(null),c=u.useCallback((d,m)=>{if(!d)return;const b=d.x+d.w/2,g=window.innerHeight-(d.y+d.h);o(window.innerHeight-g-d.h-m.height-30),r(Math.min(b-m.width/2,window.innerWidth-m.width-30))},[]);return u.useEffect(()=>{!e||!a||c(e,a)},[e,c,a]),u.useEffect(()=>{if(!t.current)return;function d(){var g;const b=(g=t.current)==null?void 0:g.getBoundingClientRect();l(b??null)}d();const m=new ResizeObserver(d);return m.observe(t.current),()=>{m.disconnect()}},[]),[t,s,i]}function pu(e){const[t,s,r]=xu();return n.jsx("div",{ref:t,style:{transform:`translateX(${s}px) translateY(${r}px)`},className:_(["[&>*]:pointer-events-auto z-10 flex dir-neutral:items-start rtl:justify-start ltr:justify-end dir-neutral:origin-top-left touch-none",e.className]),children:e.children})}const bu=function(t){const s=dt("hello world :)"),{t:r}=R();return n.jsxs("div",{className:_(["pointer-events-auto px-4 pb-6 z-10 ml-[env(safe-area-inset-left)] mr-[env(safe-area-inset-right)] bottom-0 origin-top-left inset-x-0 absolute overflow-hidden max-h-[calc(100vh-1.5rem)] grid grid-rows-[minmax(0,1fr),auto]",t.className]),children:[t.children,n.jsx("button",{className:"w-full text-video-context-type-main bg-video-context-background z-10 relative hover:bg-video-context-closeHover active:scale-95 rounded-2xl pointer-events-auto transition-all duration-100 flex justify-center items-center py-3 mt-3 font-bold border border-video-context-border hover:text-white",type:"button",onClick:()=>s.close(),children:r("overlays.close")}),n.jsx("div",{className:"pointer-events-none absolute z-0 bottom-0 left-0 w-full h-32 bg-gradient-to-t from-black to-transparent"})]})},yu=bu,vu=200,ju="--colors-global-accentA";function wu(e){return n.jsx("div",{tabIndex:e.tabIndex,className:_(e.className,"relative"),onKeyUp:e.onKeyUp,children:e.children})}function ku(e){return n.jsx("div",{className:_(e.className,"relative"),children:e.children})}const Nu=function(t){const s=u.useRef(null),r=t.flareSize??vu,i=t.cssColorVar??ju;return u.useEffect(()=>{function o(a){if(!s.current)return;const l=s.current.getBoundingClientRect(),c=r/2;s.current.style.setProperty("--bg-x",`${(a.clientX-l.left-c).toFixed(0)}px`),s.current.style.setProperty("--bg-y",`${(a.clientY-l.top-c).toFixed(0)}px`)}return document.addEventListener("mousemove",o),()=>document.removeEventListener("mousemove",o)},[r]),n.jsx("div",{ref:s,className:_("flare-light pointer-events-none absolute inset-0 overflow-hidden opacity-0 transition-opacity duration-[400ms]",t.className,{"!opacity-100":t.enabled??!1}),style:{backgroundImage:`radial-gradient(circle at center, rgba(var(${i}) / 1), rgba(var(${i}) / 0) 70%)`,backgroundPosition:"var(--bg-x) var(--bg-y)",backgroundRepeat:"no-repeat",backgroundSize:`${r.toFixed(0)}px ${r.toFixed(0)}px`},children:n.jsx("div",{className:_("absolute inset-[1px] overflow-hidden",t.className,t.backgroundClass),children:n.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`radial-gradient(circle at center, rgba(var(${i}) / 1), rgba(var(${i}) / 0) 70%)`,backgroundPosition:"var(--bg-x) var(--bg-y)",backgroundRepeat:"no-repeat",backgroundSize:`${r.toFixed(0)}px ${r.toFixed(0)}px`}})})})},Su=Nu,ue={Base:wu,Light:Su,Child:ku};function Cu(e){const t=u.useRef(null),{isMobile:s}=Lt(),r=st(d=>d.routes),i=dt(e.id),o=u.useMemo(()=>r[i.currentRoute??""],[r,i]),[a,l]=Ao(()=>({from:{height:`${(o==null?void 0:o.height)??0}px`,width:s?"100%":`${(o==null?void 0:o.width)??0}px`},config:{easing:_o.linear}}),[]),c=u.useRef(null);return u.useEffect(()=>{const d={height:o==null?void 0:o.height,width:o==null?void 0:o.width,isMobile:s},m=JSON.stringify(d);if(m!==c.current){const b=c.current?JSON.parse(c.current):null;c.current=m,d.isMobile?(l.set({width:"100%"}),l.start({height:`${(o==null?void 0:o.height)??0}px`})):(b==null?void 0:b.height)===void 0&&d.height!==void 0?l.set({height:`${(o==null?void 0:o.height)??0}px`,width:`${(o==null?void 0:o.width)??0}px`}):l.start({height:`${(o==null?void 0:o.height)??0}px`,width:`${(o==null?void 0:o.width)??0}px`})}},[o==null?void 0:o.height,o==null?void 0:o.width,s,l]),n.jsx(Mo.div,{ref:t,style:a,className:"overflow-hidden relative z-10 max-h-full",children:n.jsxs(ue.Base,{className:"group w-full bg-video-context-border h-full rounded-2xl transition-colors duration-100 text-video-context-type-main",children:[n.jsx(ue.Light,{flareSize:400,cssColorVar:"--colors-video-context-light",backgroundClass:"bg-video-context-background duration-100",className:"rounded-2xl opacity-100"}),n.jsx(ue.Child,{className:"pointer-events-auto relative transition-transform duration-100 h-full",children:e.children})]})})}function Oi(e){const{isMobile:t}=Lt(),s=n.jsx(Cu,{id:e.id,children:e.children});return t?n.jsx(yu,{children:s}):n.jsx(pu,{children:s})}function rr(e){try{return new URL(e).hostname}catch{return null}}function Eu(e){return e.type==="hls"?[rr(e.playlist)].filter(t=>!!t):e.type==="file"?Object.values(e.qualities).map(t=>rr(t.url)).filter(t=>!!t):[]}function Iu(e){const t={};return Object.entries(e.headers??{}).forEach(s=>{t[s[0]]=s[1]}),Object.entries(e.preferredHeaders??{}).forEach(s=>{t[s[0]]=s[1]}),t}async function Mn(e){await Nn({ruleId:wn.PREPARE_STREAM,targetDomains:Eu(e),requestHeaders:Iu(e)})}function On(){return be()?vn({fetcher:Tl(),target:jn.BROWSER_EXTENSION,consistentIpForRequests:!0}):vn({fetcher:Er(fetch),proxiedFetcher:El(),target:jn.BROWSER})}function Cg(){return vn({fetcher:Er(fetch),target:jn.BROWSER_EXTENSION,consistentIpForRequests:!0})}const Tu={"4k":"4k",1080:"1080",480:"480",360:"360",720:"720",unknown:"unknown"},Lu=Object.keys(Tu),Pu=["mp4"];function Ru(e){return Lu.includes(e)}function Dn(e){if(e.stream.type==="hls")return{type:"hls",url:e.stream.playlist,headers:e.stream.headers,preferredHeaders:e.stream.preferredHeaders};if(e.stream.type==="file"){const t={};return Object.entries(e.stream.qualities).forEach(s=>{if(!Ru(s[0])){console.warn(`unrecognized quality: ${s[0]}`);return}if(!Pu.includes(s[1].type)){console.warn(`unrecognized file type: ${s[1].type}`);return}t[s[0]]={type:s[1].type,url:s[1].url}}),{type:"file",qualities:t,headers:e.stream.headers,preferredHeaders:e.stream.preferredHeaders}}throw new Error("unrecognized type")}function Au(e,t,s,r){const i=p(f=>f.setSource),o=p(f=>f.setCaption),a=p(f=>f.setSourceId),l=p(f=>f.progress.time),c=p(f=>f.meta),d=Z(e),{report:m}=Vr(),[b,g]=xe(async()=>{const f=zr();let h;if(c){try{if(f&&!be()){const j=Sn(f);h=await(await Cn(j.scrapeEmbed(r,s),["completed","noOutput"])).promise()}else h=await On().runEmbedScraper({id:r,url:s})}catch(j){console.error(`Failed to scrape ${r}`,j);const x=j instanceof et?"notfound":"failed";throw m([Ze(c,t,r,x,j)]),j}m([Ze(c,t,null,"success",null)]),be()&&await Mn(h.stream[0]),a(t),o(null),i(Dn({stream:h.stream[0]}),An(h.stream[0].captions),l),d.close()}},[r,t,c,d,m,o]);return{run:g,loading:b.loading,errored:!!b.error}}function _u(e,t){const s=p(b=>b.meta),r=p(b=>b.setSource),i=p(b=>b.setCaption),o=p(b=>b.setSourceId),a=p(b=>b.progress.time),l=Z(t),{report:c}=Vr(),[d,m]=xe(async()=>{if(!e||!s)return null;const b=ki(s),g=zr();let f;try{if(g&&!be()){const h=Sn(g);f=await(await Cn(h.scrapeSource(e,b),["completed","noOutput"])).promise()}else f=await On().runSourceScraper({id:e,media:b})}catch(h){console.error(`Failed to scrape ${e}`,h);const y=h instanceof et?"notfound":"failed";throw c([Ze(s,e,null,y,h)]),h}if(c([Ze(s,e,null,"success",null)]),f.stream)return be()&&await Mn(f.stream[0]),i(null),r(Dn({stream:f.stream[0]}),An(f.stream[0].captions),a),o(e),l.close(),null;if(f.embeds.length===1){let h;if(!s)return;try{if(g&&!be()){const j=Sn(g);h=await(await Cn(j.scrapeEmbed(f.embeds[0].embedId,f.embeds[0].url),["completed","noOutput"])).promise()}else h=await On().runEmbedScraper({id:f.embeds[0].embedId,url:f.embeds[0].url})}catch(j){console.error(`Failed to scrape ${f.embeds[0].embedId}`,j);const x=j instanceof et?"notfound":"failed";throw c([Ze(s,e,f.embeds[0].embedId,x,j)]),j}c([Ze(s,e,f.embeds[0].embedId,"success",null)]),o(e),i(null),be()&&await Mn(h.stream[0]),r(Dn({stream:h.stream[0]}),An(h.stream[0].captions),a),l.close()}return f.embeds},[e,s,l,i]);return{run:m,watching:(d.value??null)===null,loading:d.loading,items:d.value,notfound:d.error instanceof et,errored:!!d.error}}function Mu(e){return n.jsx("div",{className:"h-full grid grid-rows-[1fr]",children:n.jsx("div",{className:"px-6 h-full flex flex-col justify-start overflow-y-auto overflow-x-hidden",children:e.children})})}function Ou(e){return n.jsx("div",{className:"[&>*]:px-6 h-full grid grid-rows-[auto,1fr] [&>*:nth-child(2)]:overflow-y-auto [&>*:nth-child(2)]:overflow-x-hidden",children:e.children})}const Du=Object.freeze(Object.defineProperty({__proto__:null,Card:Mu,CardWithScrollable:Ou},Symbol.toStringTag,{value:"Module"}));function Di(e){return n.jsx("div",{children:n.jsxs("h3",{className:"font-bold text-video-context-type-main pb-3 pt-5 border-b border-video-context-border flex justify-between items-center",children:[n.jsx("div",{className:"flex items-center space-x-3",children:e.children}),n.jsx("div",{children:e.rightSide})]})})}function Bu(e){return n.jsx("button",{type:"button",onClick:e.onClick,children:n.jsx(P,{className:"text-xl",icon:e.icon})})}function Uu(){return n.jsx("hr",{className:"!my-4 border-0 w-full h-px bg-video-context-border"})}function Vu(e){return n.jsx("p",{className:"text-sm mt-8 font-medium",children:e.children})}function Fu(e){return n.jsx("a",{type:"button",className:"text-video-context-type-accent cursor-pointer",onClick:e.onClick,children:e.children})}function $u(e){return n.jsx("p",{className:"font-medium",children:e.children})}function Hu(e){return n.jsx("p",{className:e.marginClass??"my-3",children:e.children})}function Wu(e){return n.jsx("span",{className:"text-white",children:e.children})}function Gu(e){return n.jsx("div",{className:"w-full h-full flex justify-center items-center text-center",children:n.jsxs("div",{className:"flex items-center gap-4 flex-col",children:[e.noIcon?null:n.jsx("div",{className:"w-16 h-10 border border-video-context-border rounded-lg flex justify-center items-center",children:n.jsx(P,{className:"text-xl",icon:w.EYE_SLASH})}),e.title?n.jsx("h2",{className:"text-white text-lg font-bold",children:e.title}):null,n.jsx("div",{children:e.children})]})})}const zu=Object.freeze(Object.defineProperty({__proto__:null,Anchor:Fu,Divider:Uu,FieldTitle:$u,Highlight:Wu,IconButton:Bu,Paragraph:Hu,SmallText:Vu,TextDisplay:Gu,Title:Di},Symbol.toStringTag,{value:"Module"}));function Bi(e){return n.jsxs("span",{className:"text-white flex items-center font-medium",children:[e.children,n.jsx(P,{className:"text-xl ml-1 -mr-1.5",icon:w.CHEVRON_RIGHT})]})}function ds(e){return n.jsx("span",{className:_(["font-medium text-left",e.textClass||"text-video-context-type-main"]),children:e.children})}function Ku(e){return n.jsxs(Di,{rightSide:e.rightSide,children:[n.jsx("button",{type:"button",className:"-ml-2 p-2 rounded tabbable hover:bg-video-context-light hover:bg-opacity-10",onClick:e.onClick,children:n.jsx(P,{className:"text-xl",icon:w.ARROW_LEFT})}),n.jsx("span",{className:"line-clamp-1 break-all",children:e.children})]})}function us(e){const t=_("flex py-2 px-3 rounded-lg w-full -ml-3",{"cursor-default":!e.clickable,"hover:bg-video-context-hoverColor hover:bg-opacity-50 cursor-pointer tabbable":e.clickable,"bg-video-context-hoverColor bg-opacity-50":e.active}),s={width:"calc(100% + 1.5rem)"},r=n.jsxs("div",{className:_("flex items-center flex-1",e.className),children:[n.jsx("div",{className:"flex-1 text-left",children:e.children}),n.jsx("div",{className:"flex",children:e.rightSide})]});return e.onClick?n.jsx("button",{type:"button",className:t,style:s,onClick:e.onClick,"data-active-link":e.active?!0:void 0,children:r}):n.jsx("div",{className:t,style:s,"data-active-link":e.active?!0:void 0,children:r})}function Yu(e){const t=n.jsx(Bi,{children:e.rightText});return n.jsx(us,{onClick:e.onClick,active:e.active,clickable:!0,rightSide:t,children:n.jsx(ds,{children:e.children})})}function Ke(e){let t;return e.selected?e.chevron?t=n.jsxs("span",{className:"flex items-center",children:[n.jsx(P,{icon:w.CIRCLE_CHECK,className:"text-xl text-video-context-type-accent"}),n.jsx(P,{className:"text-white text-xl ml-1 -mr-1.5",icon:w.CHEVRON_RIGHT})]}):t=n.jsx(P,{icon:w.CIRCLE_CHECK,className:"text-xl text-video-context-type-accent"}):e.chevron&&(t=n.jsx(P,{className:"text-xl ml-1 -mr-1.5",icon:w.CHEVRON_RIGHT})),e.error&&(t=n.jsx("span",{className:"flex items-center text-video-context-error",children:n.jsx(P,{className:"ml-2",icon:w.WARNING})})),e.loading&&(t=n.jsx(dn,{className:"text-lg"})),n.jsx(us,{onClick:e.onClick,clickable:!e.disabled,rightSide:t,children:n.jsx(ds,{textClass:_({"text-white":e.selected,"text-video-context-type-main text-opacity-40":e.disabled}),children:e.children})})}const qu=Object.freeze(Object.defineProperty({__proto__:null,BackLink:Ku,Chevron:Bi,ChevronLink:Yu,Link:us,LinkTitle:ds,SelectableLink:Ke},Symbol.toStringTag,{value:"Module"}));function Qu(e){return n.jsx("h3",{className:_("uppercase font-bold text-video-context-type-secondary text-xs pt-8 pl-1 pb-2.5 border-b border-video-context-border",e.className),children:e.children})}function Xu(e){return n.jsx("div",{className:_("pt-4 space-y-1",e.className),children:e.children})}function Ju(e){const t=u.useRef(null);return u.useEffect(()=>{var a,l,c;const s=(a=t.current)==null?void 0:a.querySelector("[data-active-link]"),r=(l=t.current)==null?void 0:l.getBoundingClientRect(),i=s==null?void 0:s.getBoundingClientRect();if(!i||!r)return;const o=i.top-r.top;(c=t.current)==null||c.scrollTo(0,o-r.height/2+i.height/2)},[e.loaded]),n.jsx("div",{ref:t,className:_("pt-4 space-y-1",e.className),children:e.children})}const Zu=Object.freeze(Object.defineProperty({__proto__:null,ScrollToActiveSection:Ju,Section:Xu,SectionTitle:Qu},Symbol.toStringTag,{value:"Module"})),E={...Du,...qu,...Zu,...zu};function em(e){const{t}=R(),s=t("player.menus.sources.unknownOption"),r=u.useMemo(()=>{if(!e.embedId)return s;const l=ln().find(c=>c.id===e.embedId);return(l==null?void 0:l.name)??s},[e.embedId,s]),{run:i,errored:o,loading:a}=Au(e.routerId,e.sourceId,e.url,e.embedId);return n.jsx(Ke,{loading:a,error:o,onClick:i,children:n.jsx("span",{className:"flex flex-col",children:n.jsx("span",{children:r})})})}function tm(e){let{sourceId:t,id:s}=e;const{t:r}=R(),i=Z(s),{run:o,watching:a,notfound:l,loading:c,items:d,errored:m}=_u(t,s),b=u.useMemo(()=>{if(!t)return"...";const h=ln().find(j=>j.id===t);return(h==null?void 0:h.name)??"..."},[t]),g=u.useRef(null);u.useEffect(()=>{g.current!==t&&(g.current=t,t&&o())},[o,t]);let f=null;return c?f=n.jsx(E.TextDisplay,{noIcon:!0,children:n.jsx(We,{})}):l?f=n.jsx(E.TextDisplay,{title:r("player.menus.sources.noStream.title")??void 0,children:r("player.menus.sources.noStream.text")}):(d==null?void 0:d.length)===0?f=n.jsx(E.TextDisplay,{title:r("player.menus.sources.noEmbeds.title")??void 0,children:r("player.menus.sources.noEmbeds.text")}):m?f=n.jsx(E.TextDisplay,{title:r("player.menus.sources.failed.title")??void 0,children:r("player.menus.sources.failed.text")}):a?f=null:d&&t&&(f=d.map(h=>n.jsx(em,{embedId:h.embedId,url:h.url,routerId:s,sourceId:t},`${h.embedId}-${h.url}`))),n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>i.navigate("/source"),children:b}),n.jsx(E.Section,{children:f})]})}function nm(e){let{id:t,onChoose:s}=e;const{t:r}=R(),i=Z(t),o=p(c=>{var d;return(d=c.meta)==null?void 0:d.type}),a=p(c=>c.sourceId),l=u.useMemo(()=>o?ln().filter(c=>c.type==="source").filter(c=>{var d;return(d=c.mediaTypes)==null?void 0:d.includes(o)}):[],[o]);return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>i.navigate("/"),children:r("player.menus.sources.title")}),n.jsx(E.Section,{className:"pb-4",children:l.map(c=>n.jsx(Ke,{onClick:()=>{s==null||s(c.id),i.navigate("/source/embeds")},selected:c.id===a,children:c.name},c.id))})]})}function sm(e){return n.jsx(Ke,{selected:e.selected,onClick:e.onClick,children:n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{"data-code":e.langCode,className:"mr-3 inline-flex",children:n.jsx(Wn,{langCode:e.langCode})}),n.jsx("span",{children:e.children})]})})}function rm(e){let{id:t}=e;const{t:s}=R(),r=s("player.menus.subtitles.unknownLanguage"),i=Z(t),o=p(d=>d.audioTracks),a=p(d=>d.currentAudioTrack),l=p(d=>{var m;return(m=d.display)==null?void 0:m.changeAudioTrack}),c=u.useCallback(d=>{l==null||l(d),i.close()},[i,l]);return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>i.navigate("/"),children:"Audio"}),n.jsx(E.Section,{className:"flex flex-col pb-4",children:o.map(d=>n.jsx(sm,{selected:d.id===(a==null?void 0:a.id),langCode:d.language,onClick:o.includes(d)?()=>c(d):void 0,children:nt(d.language)??r},d.id))})]})}const im=function(t){return n.jsx("button",{type:"button",onClick:t.onClick,className:_("w-11 h-6 p-1 rounded-full grid transition-colors duration-100 group/toggle tabbable",t.enabled?"bg-buttons-toggle":"bg-buttons-toggleDisabled"),children:n.jsx("div",{className:"relative w-full h-full",children:n.jsx("div",{className:_("scale-90 group-hover/toggle:scale-100 h-full aspect-square rounded-full bg-white absolute transition-all duration-100",t.enabled?"left-full transform -translate-x-full":"left-0")})})})},nn=im,om=function(t){return n.jsx("button",{type:"button",className:_("tabbable p-1.5 bg-video-context-buttonFocus rounded transition-colors duration-100",t.active?"bg-opacity-100":"bg-opacity-0 cursor-pointer"),onClick:t.onClick,children:n.jsx("div",{className:"w-6 h-6 rounded-full flex justify-center items-center",style:{backgroundColor:t.color},children:t.active?n.jsx(P,{className:"text-sm text-black",icon:w.CHECKMARK}):null})})},am=om,lm=function(t){const s=u.useRef(null),r=u.useRef(null),i=(t.value-t.min)/(t.max-t.min),o=u.useCallback(y=>{var I;const x=t.max-t.min,v=Math.min(Math.max(y,0),1);(I=t.onChange)==null||I.call(t,t.min+x*v)},[t]),{dragging:a,dragPercentage:l,dragMouseDown:c}=cs(r,o,!0),[d,m]=u.useState(!1),[b,g]=u.useState("");u.useEffect(()=>{function y(x){var v;x.key==="Enter"&&d&&((v=s.current)==null||v.blur())}return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}},[d]);const f=`tabbable py-1 bg-video-context-inputBg rounded text-white cursor-text ${t.controlButtons?"text-center px-4 w-24":"px-3 text-left w-20"}`,h="tabbable hover:text-white transition-colors duration-100 w-full h-full flex justify-center items-center hover:bg-video-context-buttonOverInputHover rounded",j=t.textTransformer??(y=>y);return n.jsxs("div",{children:[n.jsx(E.FieldTitle,{children:t.label}),n.jsxs("div",{className:"grid items-center grid-cols-[1fr,auto] gap-4",children:[n.jsx("div",{ref:r,children:n.jsx("div",{className:"group/progress w-full h-8 flex items-center cursor-pointer",onMouseDown:c,onTouchStart:c,children:n.jsx("div",{dir:"ltr",className:["relative w-full h-1 bg-video-context-slider bg-opacity-25 rounded-full transition-[height] duration-100 group-hover/progress:h-1.5",a?"!h-1.5":""].join(" "),children:n.jsx("div",{className:"absolute top-0 left-0 h-full rounded-full bg-video-context-sliderFilled flex justify-end items-center",style:{width:`${Math.max(0,Math.min(1,a?l/100:i))*100}%`},children:n.jsx("div",{className:["w-[1rem] min-w-[1rem] h-[1rem] border-[4px] border-video-context-sliderFilled rounded-full transform translate-x-1/2 bg-white transition-[transform] duration-100"].join(" ")})})})})}),n.jsx("div",{children:d?n.jsx("input",{className:f,value:b,autoFocus:!0,onFocus:y=>{y.target.select()},onBlur:y=>{var v;m(!1);const x=Number(y.target.value);Number.isNaN(x)||(v=t.onChange)==null||v.call(t,(t.decimalsAllowed??0)===0?Math.round(x):x)},ref:s,onChange:y=>g(y.target.value)}):n.jsxs("div",{className:"relative",onClick:y=>{y.target.closest(".actions")||(g(t.value.toFixed(t.decimalsAllowed??0)),m(!0))},children:[n.jsx("button",{className:_(f,t.controlButtons?"relative":void 0),type:"button",tabIndex:0,children:j(t.value.toFixed(t.decimalsAllowed??0))}),t.controlButtons?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"actions w-6 h-full absolute left-0 top-0 grid grid-cols-1 items-center justify-center",children:n.jsx("button",{type:"button",onClick:()=>{var y;return(y=t.onChange)==null?void 0:y.call(t,t.value-1/10**(t.decimalsAllowed??0))},className:h,children:n.jsx(P,{icon:w.CHEVRON_LEFT})})}),n.jsx("div",{className:"actions w-6 h-full absolute right-0 top-0 grid grid-cols-1 items-center justify-center",children:n.jsx("button",{type:"button",onClick:()=>{var y;return(y=t.onChange)==null?void 0:y.call(t,t.value+1/10**(t.decimalsAllowed??0))},className:h,children:n.jsx(P,{icon:w.CHEVRON_RIGHT})})})]}):null]})})]})]})},Ft=lm,cm=["#ffffff","#b0b0b0","#80b1fa","#e2e535"];function dm(e){let{id:t}=e;const{t:s}=R(),r=Z(t),i=Q(m=>m.styling),o=Q(m=>m.overrideCasing),a=Q(m=>m.delay),l=Q(m=>m.setOverrideCasing),c=Q(m=>m.setDelay),d=Q(m=>m.updateStyling);return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>r.navigate("/captions"),children:s("player.menus.subtitles.settings.backlink")}),n.jsxs(E.Section,{className:"space-y-6 pb-5",children:[n.jsx(Ft,{label:s("player.menus.subtitles.settings.delay"),max:10,min:-10,onChange:m=>c(m),value:a,textTransformer:m=>`${m}s`,decimalsAllowed:1,controlButtons:!0}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(E.FieldTitle,{children:s("player.menus.subtitles.settings.fixCapitals")}),n.jsx("div",{className:"flex justify-center items-center",children:n.jsx(nn,{enabled:o,onClick:()=>l(!o)})})]}),n.jsx(E.Divider,{}),n.jsx(Ft,{label:s("settings.subtitles.backgroundLabel"),max:100,min:0,onChange:m=>d({backgroundOpacity:m/100}),value:i.backgroundOpacity*100,textTransformer:m=>`${m}%`}),n.jsx(Ft,{label:s("settings.subtitles.backgroundBlurLabel"),max:100,min:0,onChange:m=>d({backgroundBlur:m/100}),value:i.backgroundBlur*100,textTransformer:m=>`${m}%`}),n.jsx(Ft,{label:s("settings.subtitles.textSizeLabel"),max:200,min:1,textTransformer:m=>`${m}%`,onChange:m=>d({size:m/100}),value:i.size*100}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(E.FieldTitle,{children:s("settings.subtitles.textBoldLabel")}),n.jsx("div",{className:"flex justify-center items-center",children:n.jsx(nn,{enabled:i.bold,onClick:()=>d({bold:!i.bold})})})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(E.FieldTitle,{children:s("settings.subtitles.colorLabel")}),n.jsx("div",{className:"flex justify-center items-center",children:cm.map(m=>n.jsx(am,{onClick:()=>d({color:m}),color:m,active:i.color===m},m))})]})]})]})}function um(e){const[t,s]=u.useState(!1),r=l=>{l.preventDefault(),s(!0)},i=l=>{l.currentTarget.contains(l.relatedTarget)||s(!1)},o=l=>{l.preventDefault()},a=l=>{l.preventDefault(),s(!1),e.onDrop(l)};return u.useEffect(()=>{e.onDraggingChange(t)},[t,e]),n.jsx("div",{onDragEnter:r,onDragLeave:i,onDragOver:o,onDrop:a,className:e.className,children:e.children})}function Ui(e){return n.jsxs("div",{className:"w-full relative",children:[n.jsx(P,{className:"pointer-events-none absolute top-1/2 left-3 transform -translate-y-1/2 text-video-context-inputPlaceholder",icon:w.SEARCH}),n.jsx("input",{placeholder:"Search",className:"w-full py-2 px-3 pl-[calc(0.75rem+24px)] tabbable bg-video-context-inputBg rounded placeholder:text-video-context-inputPlaceholder",value:e.value,onInput:t=>e.onInput(t.currentTarget.value)})]})}function Bn(e){return n.jsx(Ke,{selected:e.selected,loading:e.loading,error:e.error,onClick:e.onClick,chevron:e.chevron,children:n.jsxs("span",{"data-active-link":e.selected?!0:void 0,className:"flex items-center",children:[n.jsx("span",{"data-code":e.countryCode,className:"mr-3 inline-flex",children:n.jsx(Wn,{langCode:e.countryCode})}),n.jsx("span",{children:e.children})]})})}function mm(){const{t:e}=R(),t=p(o=>{var a;return(a=o.caption.selected)==null?void 0:a.language}),s=p(o=>o.setCaption),r=Q(o=>o.setCustomSubs),i=u.useRef(null);return n.jsxs(Bn,{selected:t==="custom",onClick:()=>{var o;return(o=i.current)==null?void 0:o.click()},children:[e("player.menus.subtitles.customChoice"),n.jsx("input",{className:"hidden",ref:i,accept:Ei.join(","),type:"file",onChange:o=>{if(!o.target.files)return;const a=new FileReader;a.addEventListener("load",l=>{if(!l.target||typeof l.target.result!="string")return;const c=rn(l.target.result,"srt");s({language:"custom",srtData:c,id:"custom-caption"}),r()}),a.readAsText(o.target.files[0],"utf-8")}})]})}function hm(e,t){const{t:s}=R(),r=s("player.menus.subtitles.unknownLanguage");return u.useMemo(()=>{const i=e.map(l=>({...l,languageName:nt(l.language)??r})).filter(l=>!l.opensubtitles),o=Lr(i.map(l=>l.language));let a=i.sort((l,c)=>o.indexOf(l.language)-o.indexOf(c.language));return t.trim().length>0&&(a=new _r(i,{includeScore:!0,keys:["languageName"]}).search(t).map(c=>c.item)),a},[e,t,r])}function fm(e){let{id:t}=e;const{t:s}=R(),r=Z(t),i=p(k=>{var D;return(D=k.caption.selected)==null?void 0:D.id}),[o,a]=u.useState(null),{selectCaptionById:l,disable:c}=Tt(),d=p(k=>k.captionList),m=p(k=>{var D;return(D=k.display)==null?void 0:D.getCaptionList}),[b,g]=u.useState(!1),f=p(k=>k.setCaption),h=p(k=>{var D;return(D=k.caption.selected)==null?void 0:D.language});function j(k){const D=k.dataTransfer.files,U=D[0];if(!D||!U)return;const V=`.${U.name.split(".").pop()}`;if(!V||!Ei.includes(V))return;const Y=new FileReader;Y.addEventListener("load",B=>{if(!B.target||typeof B.target.result!="string")return;const q=rn(B.target.result,"srt");f({language:"custom",srtData:q,id:"custom-caption"})}),Y.readAsText(U)}const y=u.useMemo(()=>d.length!==0?d:(m==null?void 0:m())??[],[d,m]),[x,v]=u.useState(""),I=hm(y,x),[A,M]=xe(async k=>(a(k),l(k)),[l,a]),O=I.map(k=>n.jsx(Bn,{countryCode:k.language,selected:k.id===i,loading:k.id===o&&A.loading,error:k.id===o&&A.error?A.error.toString():void 0,onClick:()=>M(k.id),children:k.languageName},k.id)),C=h?nt(h)??s("player.menus.subtitles.unknownLanguage"):void 0;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("div",{className:_("absolute inset-0 flex items-center justify-center text-white z-10 pointer-events-none transition-opacity duration-300",b?"opacity-100":"opacity-0"),children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx(P,{className:"text-5xl mb-4",icon:w.UPLOAD}),n.jsx("span",{className:"text-xl weight font-medium",children:s("player.menus.subtitles.dropSubtitleFile")})]})}),n.jsx(E.BackLink,{onClick:()=>r.navigate("/"),rightSide:n.jsx("button",{type:"button",onClick:()=>r.navigate("/captions/settings"),className:"-mr-2 -my-1 px-2 p-[0.4em] rounded tabbable hover:bg-video-context-light hover:bg-opacity-10",children:s("player.menus.subtitles.customizeLabel")}),children:s("player.menus.subtitles.title")})]}),n.jsxs(um,{className:`transition duration-300 ${b?"opacity-20":""}`,onDraggingChange:k=>{g(k)},onDrop:k=>j(k),children:[n.jsx("div",{className:"mt-3",children:n.jsx(Ui,{value:x,onInput:v})}),n.jsxs(E.ScrollToActiveSection,{className:"!pt-1 mt-2 pb-3",children:[n.jsx(Bn,{onClick:()=>c(),selected:!i,children:s("player.menus.subtitles.offChoice")}),n.jsx(mm,{}),n.jsx(E.ChevronLink,{onClick:()=>r.navigate("/captions/opensubtitles"),rightText:Q(k=>k.isOpenSubtitles)?C:"",children:s("player.menus.subtitles.OpenSubtitlesChoice")}),O]})]})]})}function Vi(){const e=p(r=>r.source),t=p(r=>r.currentQuality);return u.useMemo(()=>{var r;return(e==null?void 0:e.type)==="file"&&t?((r=e.qualities[t])==null?void 0:r.url)??null:(e==null?void 0:e.type)==="hls"?e.url:null},[e,t])}function rt(e){return n.jsx(Le,{i18nKey:e.k,components:{bold:n.jsx(E.Highlight,{}),br:n.jsx("br",{}),ios_share:n.jsx(P,{icon:w.IOS_SHARE,className:"inline-block text-xl -mb-1"}),ios_files:n.jsx(P,{icon:w.IOS_FILES,className:"inline-block text-xl -mb-1"})}})}function gm(e){let{id:t}=e;const s=Z(t),{t:r}=R(),i=Vi(),o=`https://hlsdownload.vidbinge.com/?url=${encodeURIComponent(i||"")}`,[,a]=Pr(),l=p(m=>{var b;return(b=m.source)==null?void 0:b.type}),c=p(m=>{var b;return(b=m.caption)==null?void 0:b.selected}),d=u.useCallback(()=>{const m=c?zd(c==null?void 0:c.srtData):null;m&&window.open(m)},[c]);return i?n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>s.navigate("/"),children:r("player.menus.downloads.title")}),n.jsx(E.Section,{children:n.jsx("div",{children:l==="hls"?n.jsxs(n.Fragment,{children:[n.jsx(E.Paragraph,{marginClass:"mb-6",children:n.jsx(rt,{k:"player.menus.downloads.hlsDisclaimer"})}),n.jsx($,{className:"w-full",theme:"purple",href:o,children:r("player.menus.downloads.downloadHlsAsVideo")}),n.jsx($,{className:"w-full mt-2",theme:"secondary",href:i,onClick:m=>{m.preventDefault(),a(i)},children:r("player.menus.downloads.copyHlsPlaylist")})]}):n.jsxs(n.Fragment,{children:[n.jsx(E.ChevronLink,{onClick:()=>s.navigate("/download/pc"),children:r("player.menus.downloads.onPc.title")}),n.jsx(E.ChevronLink,{onClick:()=>s.navigate("/download/ios"),children:r("player.menus.downloads.onIos.title")}),n.jsx(E.ChevronLink,{onClick:()=>s.navigate("/download/android"),children:r("player.menus.downloads.onAndroid.title")}),n.jsx(E.Divider,{}),n.jsx(E.Paragraph,{marginClass:"my-6",children:n.jsx(rt,{k:"player.menus.downloads.disclaimer"})}),n.jsx($,{className:"w-full",href:i,theme:"purple",children:r("player.menus.downloads.downloadVideo")}),n.jsx($,{className:"w-full mt-2",onClick:d,disabled:!c,theme:"secondary",download:"subtitles.srt",children:r("player.menus.downloads.downloadSubtitle")})]})})})]}):null}function xm(e){let{id:t}=e;const s=Z(t),{t:r}=R();return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>s.navigate("/download"),children:r("player.menus.downloads.onAndroid.shortTitle")}),n.jsx(E.Section,{children:n.jsx(E.Paragraph,{children:n.jsx(rt,{k:"player.menus.downloads.onAndroid.1"})})})]})}function pm(e){let{id:t}=e;const s=Z(t),{t:r}=R();return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>s.navigate("/download"),children:r("player.menus.downloads.onPc.shortTitle")}),n.jsx(E.Section,{children:n.jsx(E.Paragraph,{children:n.jsx(rt,{k:"player.menus.downloads.onPc.1"})})})]})}function bm(e){let{id:t}=e;const s=Z(t);return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>s.navigate("/download"),children:n.jsx(rt,{k:"player.menus.downloads.onIos.shortTitle"})}),n.jsx(E.Section,{children:n.jsx(E.Paragraph,{children:n.jsx(rt,{k:"player.menus.downloads.onIos.1"})})})]})}function ym(e){let{id:t}=e;return n.jsxs(n.Fragment,{children:[n.jsx(le,{id:t,path:"/download",width:343,height:490,children:n.jsx(E.CardWithScrollable,{children:n.jsx(gm,{id:t})})}),n.jsx(le,{id:t,path:"/download/ios",width:343,height:440,children:n.jsx(E.CardWithScrollable,{children:n.jsx(bm,{id:t})})}),n.jsx(le,{id:t,path:"/download/android",width:343,height:440,children:n.jsx(E.CardWithScrollable,{children:n.jsx(xm,{id:t})})}),n.jsx(le,{id:t,path:"/download/pc",width:343,height:440,children:n.jsx(E.CardWithScrollable,{children:n.jsx(pm,{id:t})})})]})}function vm(e){return n.jsx(Ke,{selected:e.selected,loading:e.loading,error:e.error,onClick:e.onClick,children:n.jsxs("span",{"data-active-link":e.selected?!0:void 0,className:"flex items-center",children:[n.jsx("span",{"data-code":e.countryCode,className:"mr-3 inline-flex",children:n.jsx(Wn,{langCode:e.countryCode})}),n.jsx("span",{children:e.children})]})})}function jm(e,t){const{t:s}=R(),r=s("player.menus.subtitles.unknownLanguage");return u.useMemo(()=>{const i=e.map(l=>({...l,languageName:nt(l.language)??r})).filter(l=>l.opensubtitles),o=Lr(i.map(l=>l.language));let a=i.sort((l,c)=>o.indexOf(l.language)-o.indexOf(c.language));return t.trim().length>0&&(a=new _r(i,{includeScore:!0,keys:["languageName"]}).search(t).map(c=>c.item)),a},[e,t,r])}function wm(e){let{id:t}=e;const{t:s}=R(),r=Z(t),i=p(x=>{var v;return(v=x.caption.selected)==null?void 0:v.id}),[o,a]=u.useState(null),{selectCaptionById:l}=Tt(),c=p(x=>x.captionList),d=p(x=>{var v;return(v=x.display)==null?void 0:v.getCaptionList}),m=u.useMemo(()=>c.length!==0?c:(d==null?void 0:d())??[],[c,d]),[b,g]=u.useState(""),f=jm(m,b),[h,j]=xe(async x=>(a(x),l(x)),[l,a]),y=f.map(x=>n.jsx(vm,{countryCode:x.language,selected:x.id===i,loading:x.id===o&&h.loading,error:x.id===o&&h.error?h.error.toString():void 0,onClick:()=>j(x.id),children:x.languageName},x.id));return n.jsxs(n.Fragment,{children:[n.jsx("div",{children:n.jsx(E.BackLink,{onClick:()=>r.navigate("/captions"),children:s("player.menus.subtitles.OpenSubtitlesChoice")})}),n.jsx("div",{className:"mt-3",children:n.jsx(Ui,{value:b,onInput:g})}),n.jsx(E.ScrollToActiveSection,{className:"!pt-1 mt-2 pb-3",children:y})]})}const km=function(t){return n.jsx("div",{className:"flex items-center bg-video-context-buttons-list p-1 rounded-lg",children:t.options.map(s=>n.jsxs("button",{type:"button",className:_("w-full px-2 py-1 rounded-md tabbable",t.selected===s?"bg-video-context-buttons-active text-white":null),onClick:()=>t.onClick(s),children:[s,"x"]},s))})},Nm=km;function Sm(e){let{id:t}=e;const{t:s}=R(),r=Z(t),i=p(c=>c.mediaPlaying.playbackRate),o=p(c=>c.display),a=u.useCallback(c=>{o==null||o.setPlaybackRate(c)},[o]),l=[.25,.5,1,1.5,2];return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>r.navigate("/"),children:s("player.menus.playback.title")}),n.jsx(E.Section,{children:n.jsxs("div",{className:"space-y-4 mt-3",children:[n.jsx(E.FieldTitle,{children:s("player.menus.playback.speedLabel")}),n.jsx(Nm,{options:l,selected:i,onClick:a})]})})]})}const Cm={unknown:!1,360:!0,480:!0,720:!0,1080:!0,"4k":!0};function Em(){const e=p(s=>{var r;return(r=s.source)==null?void 0:r.type});return u.useMemo(()=>{const s=document.createElement("video");return!(e!=="hls"||Ce.isSupported()||!zt(s))},[e])}function Im(e){let{id:t}=e;const s=Z(t),r=Em(),i=p(h=>h.qualities),o=p(h=>h.currentQuality),a=p(h=>h.switchQuality),l=p(h=>h.enableAutomaticQuality),c=yt(h=>h.setAutomaticQuality),d=yt(h=>h.setLastChosenQuality),m=yt(h=>h.quality.automaticQuality),b=u.useCallback(h=>{d(h),c(!1),a(h),s.close()},[s,a,d,c]),g=u.useCallback(()=>{const h=!m;c(h),h&&l()},[c,m,l]),f=Rd.filter(h=>!!(Cm[h]||i.includes(h)));return n.jsxs(n.Fragment,{children:[n.jsx(E.BackLink,{onClick:()=>s.navigate("/"),children:Is("player.menus.quality.title")}),n.jsxs(E.Section,{className:"flex flex-col pb-4",children:[f.map(h=>n.jsx(Ke,{selected:h===o,onClick:i.includes(h)?()=>b(h):void 0,disabled:!i.includes(h),children:wi(h)},h)),n.jsx(E.Divider,{}),n.jsx(E.Link,{rightSide:n.jsx(nn,{onClick:g,enabled:m}),children:Is("player.menus.quality.automaticLabel")}),n.jsx(E.SmallText,{children:n.jsx(Le,{i18nKey:r?"player.menus.quality.iosNoQuality":"player.menus.quality.hint",children:n.jsx(E.Anchor,{onClick:()=>s.navigate("/source"),children:"text"})})})]})]})}function Tm(e){let{id:t}=e;const s=Vi(),{t:r}=R(),i=Z(t),o=p(x=>x.currentQuality),a=p(x=>x.currentAudioTrack),l=p(x=>{var v;return(v=x.caption.selected)==null?void 0:v.language}),c=Q(x=>x.enabled),d=p(x=>x.sourceId),m=u.useMemo(()=>{if(!d)return"...";const x=ln().find(v=>v.id===d);return(x==null?void 0:x.name)??"..."},[d]),{toggleLastUsed:b}=Tt(),g=l?nt(l)??r("player.menus.subtitles.unknownLanguage"):void 0,f=a?nt(a.language)??r("player.menus.subtitles.unknownLanguage"):void 0,h=p(x=>x.source),j=(h==null?void 0:h.type)==="file"||(h==null?void 0:h.type)==="hls",y=()=>{if(s){const x=`https://www.watchparty.me/create?video=${encodeURIComponent(s)}`;window.open(x)}};return n.jsxs(E.Card,{children:[n.jsx(E.SectionTitle,{children:r("player.menus.settings.videoSection")}),n.jsxs(E.Section,{children:[n.jsx(E.ChevronLink,{onClick:()=>i.navigate("/quality"),rightText:o?wi(o):"",children:r("player.menus.settings.qualityItem")}),a&&n.jsx(E.ChevronLink,{onClick:()=>i.navigate("/audio"),rightText:f??void 0,children:r("player.menus.settings.audioItem")}),n.jsx(E.ChevronLink,{onClick:()=>i.navigate("/source"),rightText:m,children:r("player.menus.settings.sourceItem")}),n.jsx(E.Link,{clickable:!0,onClick:()=>i.navigate(j?"/download":"/download/unable"),rightSide:n.jsx(P,{className:"text-xl",icon:w.DOWNLOAD}),className:j?"opacity-100":"opacity-50",children:r("player.menus.settings.downloadItem")}),n.jsx(E.Link,{clickable:!0,onClick:y,rightSide:n.jsx(P,{className:"text-xl",icon:w.WATCH_PARTY}),className:j?"opacity-100":"opacity-50",children:r("Watch Party")})]}),n.jsx(E.SectionTitle,{children:r("player.menus.settings.experienceSection")}),n.jsxs(E.Section,{children:[n.jsx(E.Link,{rightSide:n.jsx(nn,{enabled:c,onClick:()=>b().catch(()=>{})}),children:r("player.menus.settings.enableSubtitles")}),n.jsx(E.ChevronLink,{onClick:()=>i.navigate("/captions"),rightText:g??void 0,children:r("player.menus.settings.subtitleItem")}),n.jsx(E.ChevronLink,{onClick:()=>i.navigate("/playback"),children:r("player.menus.settings.playbackItem")})]})]})}function Lm(e){let{id:t}=e;const[s,r]=u.useState(null),i=Z(t);return u.useEffect(()=>{i.isRouterActive||r(null),i.route==="/"&&r(null)},[i.isRouterActive,i.route]),n.jsx(ci,{id:t,children:n.jsxs(Oi,{id:t,children:[n.jsx(le,{id:t,path:"/",width:343,height:460,children:n.jsx(Tm,{id:t})}),n.jsx(le,{id:t,path:"/quality",width:343,height:438,children:n.jsx(E.Card,{children:n.jsx(Im,{id:t})})}),n.jsx(le,{id:t,path:"/audio",width:343,height:431,children:n.jsx(E.Card,{children:n.jsx(rm,{id:t})})}),n.jsx(le,{id:t,path:"/captions",width:343,height:431,children:n.jsx(E.CardWithScrollable,{children:n.jsx(fm,{id:t})})}),n.jsx(le,{id:t,path:"/captions/opensubtitles",width:343,height:431,children:n.jsx(E.Card,{children:n.jsx(wm,{id:t})})}),n.jsx(le,{id:t,path:"/captions/settings",width:343,height:450,children:n.jsx(E.Card,{children:n.jsx(dm,{id:t})})}),n.jsx(le,{id:t,path:"/source",width:343,height:431,children:n.jsx(E.CardWithScrollable,{children:n.jsx(nm,{id:t,onChoose:r})})}),n.jsx(le,{id:t,path:"/source/embeds",width:343,height:431,children:n.jsx(E.CardWithScrollable,{children:n.jsx(tm,{id:t,sourceId:s})})}),n.jsx(le,{id:t,path:"/playback",width:343,height:215,children:n.jsx(E.Card,{children:n.jsx(Sm,{id:t})})}),n.jsx(ym,{id:t})]})})}function Pm(){return n.jsx(Lm,{id:"settings"})}function ir(){const e=Z("settings"),t=p(s=>s.setHasOpenOverlay);return u.useEffect(()=>{t(e.isRouterActive)},[t,e.isRouterActive]),n.jsx(Mi,{id:e.id,children:n.jsx(we,{onClick:()=>e.open(),icon:w.GEAR})})}const Rm=function(t){const s=t.radius??40;return n.jsxs("svg",{className:`${t.className??""} -rotate-90`,viewBox:"0 0 100 100",children:[n.jsx("circle",{className:`fill-transparent stroke-type-text stroke-[15] opacity-25 ${t.backingRingClassname??""}`,r:s,cx:"50",cy:"50"}),n.jsx("circle",{className:"fill-transparent stroke-current stroke-[15] transition-[stroke-dashoffset] duration-150",r:s,cx:"50",cy:"50",style:{strokeDasharray:`${2*Math.PI*s} ${2*Math.PI*s}`,strokeDashoffset:`${2*Math.PI*s-t.percentage/100*(2*Math.PI*s)}`}})]})},Am=Rm;function ms(){const{meta:e,setMeta:t}=Ii(),s=u.useMemo(()=>e?ki(e):null,[e]),r=u.useCallback(o=>{t(o,W.SCRAPING)},[t]),i=u.useCallback((o,a)=>{let l;if(o.meta.type===H.SERIES){const c=o.meta.seasonData.episodes.find(d=>d.id===a);if(!c)return null;l={type:"show",releaseYear:+(o.meta.year??0),title:o.meta.title,poster:o.meta.poster,tmdbId:o.tmdbId??"",imdbId:o.imdbId,episodes:o.meta.seasonData.episodes.map(d=>({number:d.number,title:d.title,tmdbId:d.id})),episode:{number:c.number,title:c.title,tmdbId:c.id},season:{number:o.meta.seasonData.number,title:o.meta.seasonData.title,tmdbId:o.meta.seasonData.id}}}else l={type:"movie",releaseYear:+(o.meta.year??0),title:o.meta.title,poster:o.meta.poster,tmdbId:o.tmdbId??"",imdbId:o.imdbId};return r(l),l},[r]);return{playerMeta:e,setPlayerMeta:i,setDirectMeta:r,scrapeMedia:s}}const $t={};function xt(e){if($t[e])return $t[e];const t=new Date,s=new Date(e);return $t[e]=s<t,$t[e]}function sn(e){return n.jsx("div",{className:"h-full w-full flex justify-center items-center p-8 text-center",children:e.children})}function Fi(e,t){const[s,r]=u.useState(null);return[at(async()=>{const o=await vt(H.SERIES,e,t);return(o==null?void 0:o.meta.type)!==H.SERIES?null:(r(o.meta.seasons),{season:o.meta.seasonData,fullData:o})},[e,t]),s]}function _m(e){let{selectedSeason:t,setSeason:s}=e;const{t:r}=R(),i=p(c=>c.meta),[o,a]=Fi((i==null?void 0:i.tmdbId)??"",t);let l=null;return a?l=n.jsx(E.Section,{className:"pb-6",children:a==null?void 0:a.map(c=>n.jsx(E.ChevronLink,{onClick:()=>s(c.id),children:c.title},c.id))}):o.error?l=n.jsx(sn,{children:r("player.menus.episodes.loadingError")}):o.loading&&(l=n.jsx(sn,{children:r("player.menus.episodes.loadingList")})),n.jsxs(E.CardWithScrollable,{children:[n.jsx(E.Title,{children:(i==null?void 0:i.title)??r("player.menus.episodes.loadingTitle")}),l]})}function Mm(e){var f;let{id:t,selectedSeason:s,goBack:r,onChange:i}=e;const{t:o}=R(),a=Z(t),{setPlayerMeta:l}=ms(),c=p(h=>h.meta),[d]=Fi((c==null?void 0:c.tmdbId)??"",s),m=re(),b=u.useCallback(h=>{if(d.value){const j=l(d.value.fullData,h);j&&(i==null||i(j))}a.close(!0)},[l,d,a,i]);if(!(c!=null&&c.tmdbId))return null;let g=null;if(d.error)g=n.jsx(sn,{children:o("player.menus.episodes.loadingError")});else if(d.loading)g=n.jsx(sn,{children:o("player.menus.episodes.loadingList")});else if(d.value){const h=d.value.season.episodes.some(j=>!xt(j.air_date));g=n.jsxs(E.ScrollToActiveSection,{className:"pb-6",children:[d.value.season.episodes.length===0?n.jsx(E.TextDisplay,{title:"No episodes found",children:o("player.menus.episodes.emptyState")}):null,d.value.season.episodes.map(j=>{var v,I,A,M,O,C;const y=(I=(v=m.items[c==null?void 0:c.tmdbId])==null?void 0:v.episodes)==null?void 0:I[j.id];let x;if(y){const k=y.progress.watched/y.progress.duration*100;x=n.jsx(Am,{className:"h-[18px] w-[18px] text-white",percentage:k>90?100:k})}return n.jsx(E.Link,{onClick:()=>b(j.id),active:j.id===((A=c==null?void 0:c.episode)==null?void 0:A.tmdbId),clickable:xt(j.air_date),rightSide:x,children:n.jsx(E.LinkTitle,{children:n.jsxs("div",{className:_("text-left flex items-center space-x-3 text-video-context-type-main",xt(j.air_date)||j.id===((M=c==null?void 0:c.episode)==null?void 0:M.tmdbId)?"":"text-opacity-25"),children:[n.jsx("span",{className:_("p-0.5 px-2 rounded inline bg-video-context-hoverColor",j.id===((O=c==null?void 0:c.episode)==null?void 0:O.tmdbId)?"text-white bg-opacity-100":"bg-opacity-50",xt(j.air_date)||j.id===((C=c==null?void 0:c.episode)==null?void 0:C.tmdbId)?"":"!bg-opacity-25"),children:o("player.menus.episodes.episodeBadge",{episode:j.number})}),n.jsx("span",{className:"line-clamp-1 break-all",children:j.title})]})})},j.id)}),h?n.jsx("p",{children:o("player.menus.episodes.unairedEpisodes")}):null]})}return n.jsxs(E.CardWithScrollable,{children:[n.jsx(E.BackLink,{onClick:r,rightSide:n.jsx("span",{children:((f=d==null?void 0:d.value)==null?void 0:f.season.title)||o("player.menus.episodes.loadingTitle")}),children:o("player.menus.episodes.seasons")}),g]})}function Om(e){let{id:t,onChange:s}=e;const r=Z(t),i=p(d=>d.meta),[o,a]=u.useState(""),l=u.useRef(!1);u.useEffect(()=>{var d;l.current!==r.isRouterActive&&(l.current=r.isRouterActive,a(((d=i==null?void 0:i.season)==null?void 0:d.tmdbId)??""))},[i,o,a,r.isRouterActive]);const c=u.useCallback(d=>{a(d),r.navigate("/episodes")},[r]);return n.jsx(ci,{id:t,children:n.jsxs(Oi,{id:t,children:[n.jsx(le,{id:t,path:"/",width:343,height:431,children:n.jsx(_m,{setSeason:c,selectedSeason:o})}),n.jsx(le,{id:t,path:"/episodes",width:343,height:431,children:o.length>0?n.jsx(Mm,{selectedSeason:o,id:t,goBack:()=>r.navigate("/"),onChange:s}):null})]})})}function Dm(e){return n.jsx(Om,{onChange:e.onChange,id:"episodes"})}function or(){const{t:e}=R(),t=Z("episodes"),s=p(a=>a.setHasOpenOverlay),r=p(a=>a.meta),i=r==null?void 0:r.type;if(u.useEffect(()=>{s(t.isRouterActive)},[s,t.isRouterActive]),i!=="show")return null;const o=()=>{var d,m;const a=((d=r==null?void 0:r.season)==null?void 0:d.number)===1,l=((m=r==null?void 0:r.season)==null?void 0:m.title)!=="Miniseries",c=a&&l?"/":"/episodes";t.open(c)};return n.jsx(Mi,{id:t.id,children:n.jsx(we,{onClick:o,icon:w.EPISODES,children:e("player.menus.episodes.button")})})}function ar(){const e=p(s=>s.interface.canAirplay),t=p(s=>s.display);return e?n.jsx(we,{onClick:()=>t==null?void 0:t.startAirplay(),icon:w.AIRPLAY}):null}function Bm(){const e=ii(),t=p(s=>s.mediaPlaying.volume);return n.jsx(de,{animation:"slide-down",show:e.showVolume,className:"absolute inset-x-0 top-4 flex justify-center pointer-events-none",children:n.jsxs(ue.Base,{className:"hover:flare-enabled pointer-events-auto bg-video-context-background pl-4 pr-6 py-3 group w-72 h-full rounded-lg transition-colors text-video-context-type-main",children:[n.jsx(ue.Light,{enabled:!0,flareSize:200,cssColorVar:"--colors-video-context-light",backgroundClass:"bg-video-context-background duration-100",className:"rounded-lg"}),n.jsxs(ue.Child,{className:"grid grid-cols-[auto,1fr] gap-3 pointer-events-auto relative transition-transform",children:[n.jsx(P,{className:"text-2xl",icon:t>0?w.VOLUME:w.VOLUME_X}),n.jsx("div",{className:"w-full flex items-center",children:n.jsx("div",{className:"w-full h-1.5 rounded-full bg-video-context-slider bg-opacity-25",children:n.jsx("div",{className:"h-full bg-video-context-sliderFilled rounded-full transition-[width] duration-100",style:{width:`${t*100}%`}})})})]})]})})}const $i=ne(Ee(se(e=>({enableThumbnails:!0,enableAutoplay:!0,sourceOrder:[],setEnableThumbnails(t){e(s=>{s.enableThumbnails=t})},setEnableAutoplay(t){e(s=>{s.enableAutoplay=t})},setSourceOrder(t){e(s=>{s.sourceOrder=t})}})),{name:"__MW::preferences"}));function Um(){return!!(F().ALLOW_AUTOPLAY||be()||J.getState().proxySet)}function Vm(e,t){const s=e/t;return t-e<=30?"always":s>=.9?"hover":"none"}function lr(e){return n.jsx("button",{className:_("font-bold rounded h-10 w-40 scale-95 hover:scale-100 transition-all duration-200",e.className),type:"button",onClick:e.onClick,children:e.children})}function Fm(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return at(async()=>{if(t){if(!e)return null;const r=await vt(H.SERIES,e);return(r==null?void 0:r.meta.type)!==H.SERIES?null:r.meta.seasons}},[e,t])}function $m(e,t){return at(async()=>{var r,i;if(e){if(!t)return null;const o=await vt(H.SERIES,t,e==null?void 0:e.id);if((o==null?void 0:o.meta.type)!==H.SERIES)return null;const a=(i=(r=o==null?void 0:o.meta)==null?void 0:r.seasonData)==null?void 0:i.episodes.filter(l=>xt(l.air_date)).map(l=>({number:l.number,title:l.title,tmdbId:l.id}));if(a.length>0)return a[0]}},[t,e==null?void 0:e.id])}function Hm(e){var k,D,U,V,Y;const{t}=R(),s=p(B=>B.progress.duration),r=p(B=>B.interface.hideNextEpisodeBtn),i=p(B=>B.meta),{setDirectMeta:o}=ms(),a=p(B=>B.hideNextEpisodeButton),l=p(B=>{var q;return(q=B.meta)==null?void 0:q.type}),c=p(B=>B.progress.time),d=Vm(c,s),m=p(B=>B.status),b=p(B=>B.setShouldStartFromBeginning),g=re(B=>B.updateItem),f=$i(B=>B.enableAutoplay),h=!((k=i==null?void 0:i.episode)!=null&&k.number)||!((U=(D=i==null?void 0:i.episodes)==null?void 0:D.at(-1))!=null&&U.number)?!1:i.episode.number===i.episodes.at(-1).number,y=(V=Fm(i==null?void 0:i.tmdbId,h).value)==null?void 0:V.find(B=>{var q;return B.number===(((q=i==null?void 0:i.season)==null?void 0:q.number)??0)+1}),x=$m(y,i==null?void 0:i.tmdbId);let v=!1;const I=u.useRef(!1);(d==="always"||d==="hover"&&e.controlsShowing)&&(v=!0),(r||m!=="playing"||s===0)&&(v=!1);const A=d==="hover"?"slide-up":"fade";let M="bottom-[calc(6rem+env(safe-area-inset-bottom))]";d==="always"&&(M=e.controlsShowing?M:"bottom-[calc(3rem+env(safe-area-inset-bottom))]");const O=h?x.value:(Y=i==null?void 0:i.episodes)==null?void 0:Y.find(B=>{var q;return B.number===(((q=i==null?void 0:i.episode)==null?void 0:q.number)??0)+1}),C=u.useCallback(()=>{var ke;if(!i||!O)return;const B={...i};B.episode=O,B.season=h&&y?{...y,tmdbId:y.id}:B.season,b(!0),o(B),(ke=e.onChange)==null||ke.call(e,B),g({meta:B,progress:{duration:0,watched:0}})},[o,O,i,e,b,g,h,y]);return u.useEffect(()=>{if(!f||l!=="show")return;const B=s/100,q=c>=s-B&&s!==0;s===0&&(I.current=!1),q&&Um()&&!I.current&&(I.current=!0,C())},[s,f,C,l,c]),!(i!=null&&i.episode)||!O||l!=="show"?null:n.jsx(de,{animation:A,show:v,className:"absolute right-[calc(3rem+env(safe-area-inset-right))] bottom-0",children:n.jsxs("div",{className:_(["absolute bottom-0 right-0 transition-[bottom] duration-200 flex items-center space-x-3",M]),children:[n.jsx(lr,{className:"py-px box-content bg-buttons-secondary hover:bg-buttons-secondaryHover bg-opacity-90 text-buttons-secondaryText",onClick:a,children:t("player.nextEpisode.cancel")}),n.jsxs(lr,{onClick:()=>C(),className:"bg-buttons-primary hover:bg-buttons-primaryHover text-buttons-primaryText flex justify-center items-center",children:[n.jsx(P,{className:"text-xl mr-1",icon:w.SKIP_EPISODE}),t(h&&O?"player.nextEpisode.nextSeason":"player.nextEpisode.next")]})]})})}function cr(e){const[t,s]=u.useState(!1),r=p(a=>a.interface.isCasting),i=u.useRef(null),o=u.useCallback(a=>{const l=(a.getAttribute("style")??"").includes("inline");s(!l)},[s]);return u.useEffect(()=>{var c;const a=(c=i.current)==null?void 0:c.querySelector("google-cast-launcher");if(!a)return;const l=new MutationObserver(()=>{o(a)});return l.observe(a,{attributes:!0,attributeFilter:["style"]}),o(a),()=>{l.disconnect()}},[o]),n.jsx(we,{ref:i,className:[e.className??"","google-cast-button",r?"casting":"",t?"hidden":""].join(" "),icon:w.CASTING,onClick:a=>{const l=a.querySelector("google-cast-launcher");l&&l.click()}})}function Wm(){const{t:e}=R(),t=p(i=>i.mediaPlaying.isLoading),s=p(i=>i.display),r=(s==null?void 0:s.getType())==="casting";return t||!r?null:n.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[n.jsx("div",{className:"rounded-full bg-opacity-10 bg-video-buttonBackground p-3 brightness-100 grayscale",children:n.jsx(P,{icon:w.CASTING})}),n.jsx("p",{className:"text-center",children:e("player.casting.enabled")})]})}function Gm(e,t){for(let s=0;s<t.length;s+=1)if(t.start(t.length-1-s)<e)return t.end(t.length-1-s);return 0}const zm={1:{name:"MEDIA_ERR_ABORTED",key:"player.playbackError.errors.errorAborted"},2:{name:"MEDIA_ERR_NETWORK",key:"player.playbackError.errors.errorNetwork"},3:{name:"MEDIA_ERR_DECODE",key:"player.playbackError.errors.errorDecode"},4:{name:"MEDIA_ERR_SRC_NOT_SUPPORTED",key:"player.playbackError.errors.errorNotSupported"}};function Km(e){const t=zm[(e==null?void 0:e.code)??-1];return t||{name:"MEDIA_ERR_GENERIC",key:"player.playbackError.errors.errorGenericMedia"}}function tt(e){const t=new URL(e),s=F().CDN_REPLACEMENTS;for(const[r,i]of s)if(t.hostname.endsWith(r))return t.hostname=i,t.port="",t.protocol="https://",t.toString();return e}function Hi(){const e={};return{on(t,s){var r;e[t]||(e[t]=[]),(r=e[t])==null||r.push(s)},off(t,s){var r;e[t]=((r=e[t])==null?void 0:r.filter(i=>i!==s))??[]},emit(t,s){(e[t]??[]).forEach(r=>r(s))}}}const Wi={360:"360",1080:"1080",720:"720",480:"480",2160:"4k"};function Yt(e){return Wi[(e==null?void 0:e.height)??0]??null}function Ym(e){const t=Object.entries(Wi).find(s=>s[1]===e);return t?+t[0]:null}function qm(e){return e.map(t=>Yt(t)).filter(t=>!!t)}function Gi(){const{emit:e,on:t,off:s}=Hi();let r=null,i=null,o=null,a=null,l=!1,c=!1,d=!1,m=0,b=!1,g=null,f=1;const h=new Map;function j(){if(!i)return;const k=i.levels.map(D=>Yt(D)).filter(D=>!!D);e("qualities",k)}function y(){if(!i)return;const C=lt.getState().language,k=i.audioTracks,D=k.find(V=>V.lang===C);D&&(i.audioTrack=k.indexOf(D));const U=k==null?void 0:k[i.audioTrack??0];U&&(e("changedaudiotrack",{id:U.id.toString(),label:U.name,language:U.lang??"unknown"}),e("audiotracks",i.audioTracks.map(V=>({id:V.id.toString(),label:V.name,language:V.lang??"unknown"}))))}function x(){if(o&&zt(o)||!i)return;if(b)i.currentLevel=-1,i.loadLevel=-1;else{const k=qm(i.levels),D=vi(k,{lastChosenQuality:g,automaticQuality:b});if(D){const U=i.levels.findIndex(V=>V.height===Ym(D));U!==-1&&(i.currentLevel=U,i.loadLevel=U)}}const C=Yt(i.levels[i.currentLevel]);e("changedquality",C)}function v(C,k){if(i=null,k.type==="hls"){if(zt(C)){C.src=tt(k.url),C.currentTime=m;return}if(!Ce.isSupported())throw new Error("HLS not supported");i||(i=new Ce({maxBufferSize:500*1e3*1e3,fragLoadPolicy:{default:{maxLoadTimeMs:30*1e3,maxTimeToFirstByteMs:30*1e3,errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3},timeoutRetry:{maxNumRetry:3,maxRetryDelayMs:0,retryDelayMs:0}}},renderTextTracksNatively:!1}),i.on(Ce.Events.ERROR,(D,U)=>{var V;console.error("HLS error",U),U.fatal&&(k==null?void 0:k.url)===((V=U.frag)==null?void 0:V.baseurl)&&e("error",{message:U.error.message,stackTrace:U.error.stack,errorName:U.error.name,type:"hls"})}),i.on(Ce.Events.MANIFEST_LOADED,()=>{i&&(j(),x(),y(),be()&&(i.on(Ce.Events.LEVEL_LOADED,async(D,U)=>{const V=U.details.fragments.map(B=>new URL(B.url).hostname),Y=[...new Set(V)];await Nn({ruleId:wn.SET_DOMAINS_HLS,targetDomains:Y,requestHeaders:{...k.preferredHeaders,...k.headers}})}),i.on(Ce.Events.AUDIO_TRACK_LOADED,async(D,U)=>{const V=U.details.fragments.map(B=>new URL(B.url).hostname),Y=[...new Set(V)];await Nn({ruleId:wn.SET_DOMAINS_HLS_AUDIO,targetDomains:Y,requestHeaders:{...k.preferredHeaders,...k.headers}})})))}),i.on(Ce.Events.LEVEL_SWITCHED,()=>{if(!i)return;const D=Yt(i.levels[i.currentLevel]);e("changedquality",D)}),i.on(Ce.Events.SUBTITLE_TRACK_LOADED,()=>{for(const[D,U]of h)if(i==null?void 0:i.subtitleTracks.find(Y=>Y.lang===D)){U(),h.delete(D);break}})),i.attachMedia(C),i.loadSource(tt(k.url)),C.currentTime=m;return}C.src=tt(k.url),C.currentTime=m}function I(){!o||!r||(v(o,r),o.addEventListener("play",()=>{e("play",void 0),e("loading",!1)}),o.addEventListener("error",()=>{const C=(o==null?void 0:o.error)??null,k=Km(C);e("error",{errorName:k.name,key:k.key,type:"htmlvideo"})}),o.addEventListener("playing",()=>e("play",void 0)),o.addEventListener("pause",()=>e("pause",void 0)),o.addEventListener("canplay",()=>e("loading",!1)),o.addEventListener("waiting",()=>e("loading",!0)),o.addEventListener("volumechange",()=>e("volumechange",o!=null&&o.muted?0:(o==null?void 0:o.volume)??0)),o.addEventListener("timeupdate",()=>e("time",(o==null?void 0:o.currentTime)??0)),o.addEventListener("loadedmetadata",()=>{(r==null?void 0:r.type)==="hls"&&o&&zt(o)&&(e("qualities",["unknown"]),e("changedquality","unknown")),e("duration",(o==null?void 0:o.duration)??0)}),o.addEventListener("progress",()=>{o&&e("buffered",Gm(o.currentTime,o.buffered))}),o.addEventListener("webkitendfullscreen",()=>{l=!1,e("fullscreen",l),l||e("needstrack",!1)}),o.addEventListener("webkitplaybacktargetavailabilitychanged",C=>{C.availability==="available"&&e("canairplay",!0)}),o.addEventListener("ratechange",()=>{o&&e("playbackrate",o.playbackRate)}),o.addEventListener("durationchange",()=>{e("duration",(o==null?void 0:o.duration)??0)}))}function A(){o&&(o.removeAttribute("src"),o.load()),i&&(i.destroy(),i=null)}function M(){A(),o&&(o=null)}function O(){l=!!document.fullscreenElement||!!document.webkitFullscreenElement,e("fullscreen",l),l||e("needstrack",!1)}return fe.addEventListener("fullscreenchange",O),{on:t,off:s,getType(){return"web"},destroy:()=>{M(),fe.removeEventListener("fullscreenchange",O)},load(C){C.source||A(),b=C.automaticQuality,g=C.preferredQuality,r=C.source,e("loading",!0),m=C.startAt,I()},changeQuality(C,k){(r==null?void 0:r.type)==="hls"&&(b=C,g=k,x())},processVideoElement(C){M(),o=C,I(),this.setVolume(f)},processContainerElement(C){a=C},setMeta(){},setCaption(){},pause(){o==null||o.pause()},play(){o==null||o.play()},setSeeking(C){if(C!==d){if(d=C,!C){c||this.play();return}c=(o==null?void 0:o.paused)??!0,this.pause()}},setTime(C){if(!o)return;let k=Math.min(C,o.duration);k=Math.max(0,k),!Number.isNaN(k)&&(e("time",k),o.currentTime=k)},async setVolume(C){let k=Math.min(C,1);if(k=Math.max(0,k),f=C,!o)return;o.muted=k===0,await tn()?o.volume=k:e("volumechange",k===0?0:1)},toggleFullscreen(){if(l){if(l=!1,e("fullscreen",l),e("needstrack",!1),!fe.fullscreenElement)return;fe.exitFullscreen();return}if(l=!0,e("fullscreen",l),!(!Pi()||fe.fullscreenElement)){if(gn()){a&&fe.requestFullscreen(a);return}Li()&&o&&(e("needstrack",!0),o.webkitEnterFullscreen())}},togglePictureInPicture(){if(o){if(Ai()){const C=o;C.webkitSetPresentationMode(C.webkitPresentationMode==="picture-in-picture"?"inline":"picture-in-picture")}Ri()&&(o!==document.pictureInPictureElement?o.requestPictureInPicture():document.exitPictureInPicture())}},startAirplay(){const C=o;C&&C.webkitShowPlaybackTargetPicker&&C.webkitShowPlaybackTargetPicker()},setPlaybackRate(C){o&&(o.playbackRate=C)},getCaptionList(){return(i==null?void 0:i.subtitleTracks.map(C=>({id:C.id.toString(),language:C.lang??"unknown",url:C.url,needsProxy:!1,hls:!0})))??[]},getSubtitleTracks(){return(i==null?void 0:i.subtitleTracks)??[]},async setSubtitlePreference(C){const k=i==null?void 0:i.subtitleTracks.find(U=>U.lang===C);if((k==null?void 0:k.details)!==void 0)return Promise.resolve();const D=new Promise((U,V)=>{h.set(C,U),setTimeout(()=>{V(),h.delete(C)},5e3)});return i==null||i.setSubtitleOption({lang:C}),D},changeAudioTrack(C){if(!i)return;const k=i==null?void 0:i.audioTracks.find(D=>D.id.toString()===C.id);k&&(i.audioTrack=i.audioTracks.indexOf(k),e("changedaudiotrack",{id:k.id.toString(),label:k.name,language:k.lang??"unknown"}))}}}function Qm(e){const{emit:t,on:s,off:r}=Hi();let i=!1,o=1,a=null,l=null,c=null,d=!1,m=!1,b=!1,g=0,f={title:"",type:H.MOVIE};function h(){var M;const A=async O=>{switch(O.field){case"volumeLevel":await tn()&&t("volumechange",O.value);break;case"currentTime":t("time",O.value);break;case"duration":t("duration",O.value??0);break;case"mediaInfo":O.value&&t("duration",O.value.duration??0);break;case"playerState":t("loading",O.value==="BUFFERING"),O.value==="PLAYING"?t("play",void 0):O.value==="PAUSED"&&t("pause",void 0),i=O.value==="PAUSED";break;case"isMuted":t("volumechange",O.value?1:0);break}};return(M=e.controller)==null||M.addEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,A),()=>{var O;(O=e.controller)==null||O.removeEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,A)}}function j(){var D;if(!a){(D=e.controller)==null||D.stop();return}let A="video/mp4";a.type==="hls"&&(A="application/x-mpegurl");const M=new chrome.cast.media.GenericMediaMetadata;M.title=f.title;const O=new chrome.cast.media.MediaInfo("video",A);O.contentUrl=tt(a.url),O.streamType=chrome.cast.media.StreamType.BUFFERED,O.metadata=M,O.customData={playbackRate:o};const C=new chrome.cast.media.LoadRequest(O);if(C.autoplay=!0,C.currentTime=g,a.type==="hls"){const U=chrome.cast.media,V=C.media;V.hlsSegmentFormat=U.HlsSegmentFormat.FMP4,V.hlsVideoSegmentFormat=U.HlsVideoSegmentFormat.FMP4}const k=e.instance.getCurrentSession();k==null||k.loadMedia(C)}function y(){!l||!a||j()}function x(){l&&(l=null)}function v(){d=!!document.fullscreenElement||!!document.webkitFullscreenElement,t("fullscreen",d),d||t("needstrack",!1)}fe.addEventListener("fullscreenchange",v);const I=h();return{on:s,off:r,getType(){return"casting"},destroy:()=>{I(),x(),fe.removeEventListener("fullscreenchange",v)},load(A){a=A.source,t("loading",!0),g=A.startAt,y()},changeQuality(){},setCaption(A){y()},processVideoElement(A){x(),l=A,y()},processContainerElement(A){c=A},setMeta(A){f=A,y()},pause(){i||(e.controller.playOrPause(),i=!0)},play(){i&&(e.controller.playOrPause(),i=!1)},setSeeking(A){if(A!==b){if(b=A,!A){m||this.play();return}m=i??!0,this.pause()}},setTime(A){if(!l)return;let M=Math.min(A,e.player.duration);M=Math.max(0,M),!Number.isNaN(M)&&(t("time",M),e.player.currentTime=M,e.controller.seek())},async setVolume(A){let M=Math.min(A,1);M=Math.max(0,M),await tn()?(e.player.volumeLevel=M,e.controller.setVolumeLevel(),t("volumechange",M)):t("volumechange",M===0?0:1)},toggleFullscreen(){if(d){if(d=!1,t("fullscreen",d),t("needstrack",!1),!fe.fullscreenElement)return;fe.exitFullscreen();return}d=!0,t("fullscreen",d),!(!Pi()||fe.fullscreenElement)&&gn()&&c&&fe.requestFullscreen(c)},togglePictureInPicture(){},startAirplay(){},setPlaybackRate(A){o=A,y()},getCaptionList(){return[]},getSubtitleTracks(){return[]},async setSubtitlePreference(){return Promise.resolve()},changeAudioTrack(){}}}const Xm="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",zi=[];let Un=null;function Jm(e){Un=e,zi.forEach(t=>t(e))}function Zm(e){if(Un!==null)return e(Un);zi.push(e)}function eh(){if(window.__onGCastApiAvailable=t=>{Jm(t)},!!!document.getElementById("chromecast-script")){const t=document.createElement("script");t.setAttribute("src",Xm),t.setAttribute("id","chromecast-script"),document.body.appendChild(t)}}function th(){const[e,t]=u.useState(null);return u.useEffect(()=>{Zm(s=>t(s))},[]),e}function nh(){const e=p(x=>x.casting.setInstance),t=p(x=>x.casting.setController),s=p(x=>x.casting.setPlayer),r=p(x=>x.casting.setIsCasting),i=p(x=>x.interface.isCasting),o=p(x=>{var v;return(v=x.caption)==null?void 0:v.selected}),a=p(x=>x.setDisplay),l=p(x=>x.redisplaySource),c=th(),d=p(x=>x.display),m=p(x=>x.casting.controller),b=p(x=>x.casting.player),g=p(x=>x.casting.instance),f=p(x=>x.progress.time),h=p(x=>{var v;return(v=x.meta)==null?void 0:v.title}),j=p(x=>{var v;return(v=x.meta)==null?void 0:v.type}),y=u.useRef({controller:m,player:b,instance:g,time:f,metaTitle:h,metaType:j,caption:o});return u.useEffect(()=>{y.current={controller:m,player:b,instance:g,time:f,metaTitle:h,metaType:j,caption:o}},[m,b,g,f,h,j,o]),u.useEffect(()=>{if(i){if(y.current.controller&&y.current.instance&&y.current.player){const x=Qm({controller:y.current.controller,instance:y.current.instance,player:y.current.player});x.setMeta({title:y.current.metaTitle??"",type:Jt(y.current.metaType??"movie")}),x.setCaption(y.current.caption),a(x),l(y.current.time??0)}}else{const x=Gi();a(x),l(y.current.time??0)}},[i,a,l]),u.useEffect(()=>{d==null||d.setMeta({title:y.current.metaTitle??"",type:Jt(y.current.metaType??"movie")})},[h,j,d]),u.useEffect(()=>{if(!c)return;const x=cast.framework.CastContext.getInstance();e(x),x.setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED});const v=new cast.framework.RemotePlayer;s(v);const I=new cast.framework.RemotePlayerController(v);t(I);function A(M){M.field==="isConnected"&&r(M.value)}return I.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,A),()=>{I.removeEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,A)}},[c,s,t,e,r]),null}function sh(){var r,i;const{t:e}=R(),t=p(o=>o.meta);if(!t)return null;if(t.type!=="show")return n.jsx(Te,{children:n.jsx("title",{children:t.title})});const s=e("media.episodeDisplay",{season:(r=t.season)==null?void 0:r.number,episode:(i=t.episode)==null?void 0:i.number});return n.jsx(Te,{children:n.jsxs("title",{children:[t.title," - ",s]})})}function rh(){const e=Z(""),t=p(h=>h.display),s=p(h=>h.progress),{isSeeking:r}=p(h=>h.interface),i=p(h=>h.mediaPlaying),o=p(h=>h.progress.time),{setVolume:a,toggleMute:l}=_i(),{toggleLastUsed:c}=Tt(),d=ii(h=>h.setShowVolume),[m,b]=u.useState(!1),g=u.useRef(),f=u.useRef({setShowVolume:d,setVolume:a,toggleMute:l,setIsRolling:b,toggleLastUsed:c,display:t,mediaPlaying:i,mediaProgress:s,isSeeking:r,isRolling:m,time:o,router:e});return u.useEffect(()=>{f.current={setShowVolume:d,setVolume:a,toggleMute:l,setIsRolling:b,toggleLastUsed:c,display:t,mediaPlaying:i,mediaProgress:s,isSeeking:r,isRolling:m,time:o,router:e}},[d,a,l,b,c,t,i,s,r,m,o,e]),u.useEffect(()=>{const h=j=>{var v,I,A,M,O,C,k,D,U,V,Y,B,q,ke,Ne;if(j.target&&j.target.nodeName==="INPUT")return;const y=j.key,x=j.key.toLowerCase();if(["ArrowUp","ArrowDown","m","M"].includes(y)&&(f.current.setShowVolume(!0),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{f.current.setShowVolume(!1)},3e3)),y==="ArrowUp"&&f.current.setVolume((((v=f.current.mediaPlaying)==null?void 0:v.volume)||0)+.15),y==="ArrowDown"&&f.current.setVolume((((I=f.current.mediaPlaying)==null?void 0:I.volume)||0)-.15),x==="m"&&f.current.toggleMute(),y===">"||y==="<"){const ee=[.25,.5,1,1.5,2];let Ie=ee.indexOf((A=f.current.mediaPlaying)==null?void 0:A.playbackRate);Ie===-1&&(Ie=ee.indexOf(1));const Re=Ie+(y===">"?1:-1),Ae=ee[Re];Ae&&((M=f.current.display)==null||M.setPlaybackRate(Ae))}if(y==="ArrowRight"&&((O=f.current.display)==null||O.setTime(f.current.time+5)),y==="ArrowLeft"&&((C=f.current.display)==null||C.setTime(f.current.time-5)),x==="j"&&((k=f.current.display)==null||k.setTime(f.current.time-10)),x==="l"&&((D=f.current.display)==null||D.setTime(f.current.time+10)),y==="."&&((U=f.current.mediaPlaying)!=null&&U.isPaused)&&((V=f.current.display)==null||V.setTime(f.current.time+1)),y===","&&((Y=f.current.mediaPlaying)!=null&&Y.isPaused)&&((B=f.current.display)==null||B.setTime(f.current.time-1)),x==="f"&&((q=f.current.display)==null||q.toggleFullscreen()),(y===" "||x==="k")&&((ke=f.current.display)==null||ke[f.current.mediaPlaying.isPaused?"play":"pause"]()),y==="Escape"&&f.current.router.close(),x==="c"&&f.current.toggleLastUsed().catch(()=>{}),x==="r"){if(f.current.isRolling||j.ctrlKey||j.metaKey)return;f.current.setIsRolling(!0),(Ne=document.querySelector(".popout-location"))==null||Ne.classList.add("roll"),document.body.setAttribute("data-no-scroll","true"),setTimeout(()=>{var ee;(ee=document.querySelector(".popout-location"))==null||ee.classList.remove("roll"),document.body.removeAttribute("data-no-scroll"),f.current.setIsRolling(!1)},1e3)}};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[]),null}function ih(){var l,c,d,m,b,g,f,h,j,y,x;const{setDirectMeta:e}=ms(),t=p(v=>v.setShouldStartFromBeginning),s=u.useRef(!1),r=u.useRef(0),i=p.getState(),o=u.useCallback(v=>{var M,O;const I=(O=(M=i.meta)==null?void 0:M.episodes)==null?void 0:O.find(C=>{var k,D;return C.number===(((D=(k=i.meta)==null?void 0:k.episode)==null?void 0:D.number)??0)+v});if(!i.meta||!I)return;const A={...i.meta};A.episode=I,t(!0),e(A)},[i.meta,e,t]),a=u.useCallback(v=>{typeof navigator.mediaSession.setPositionState=="function"&&(v>i.progress.buffered&&(s.current=!0),!(v>i.progress.duration)&&(r.current=i.progress.time,navigator.mediaSession.setPositionState({duration:i.progress.duration,playbackRate:i.mediaPlaying.playbackRate,position:v})))},[i.mediaPlaying.playbackRate,i.progress.buffered,i.progress.duration,i.progress.time]);return u.useEffect(()=>{"mediaSession"in navigator&&(i.mediaPlaying.isPaused?navigator.mediaSession.playbackState="paused":navigator.mediaSession.playbackState="playing")},[i.mediaPlaying.isPaused]),u.useEffect(()=>{"mediaSession"in navigator&&a(i.progress.time)},[i.progress.time,i.mediaPlaying.playbackRate,a]),u.useEffect(()=>{"mediaSession"in navigator&&(!s.current&&i.mediaPlaying.isLoading&&(s.current=!0),Math.abs(i.progress.time-r.current)>=5&&!i.mediaPlaying.isLoading&&!s.current&&(s.current=!0),s.current&&!i.mediaPlaying.isLoading&&(s.current=!1,a(i.progress.time)),r.current=i.progress.time)},[a,i.progress.time,i.mediaPlaying.isLoading]),u.useEffect(()=>{var A,M,O,C,k,D,U,V,Y,B,q,ke,Ne,ee,Ie,Re,Ae;if(!("mediaSession"in navigator)||!i.mediaPlaying.isLoading&&i.mediaPlaying.isPlaying&&!i.display)return;let v,I;((A=i.meta)==null?void 0:A.type)==="movie"?v=(M=i.meta)==null?void 0:M.title:((O=i.meta)==null?void 0:O.type)==="show"&&(I=(C=i.meta)==null?void 0:C.title,v=`S${(D=(k=i.meta)==null?void 0:k.season)==null?void 0:D.number} E${(V=(U=i.meta)==null?void 0:U.episode)==null?void 0:V.number}: ${(B=(Y=i.meta)==null?void 0:Y.episode)==null?void 0:B.title}`),navigator.mediaSession.metadata=new MediaMetadata({title:v,artist:I,artwork:[{src:((q=i.meta)==null?void 0:q.poster)??"",sizes:"342x513",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",()=>{var pe;i.mediaPlaying.isLoading||((pe=i.display)==null||pe.play(),a(i.progress.time))}),navigator.mediaSession.setActionHandler("pause",()=>{var pe;i.mediaPlaying.isLoading||((pe=i.display)==null||pe.pause(),a(i.progress.time))}),navigator.mediaSession.setActionHandler("seekto",pe=>{var ut;pe.seekTime&&((ut=i.display)==null||ut.setTime(pe.seekTime),a(pe.seekTime))}),(((Ne=(ke=i.meta)==null?void 0:ke.episode)==null?void 0:Ne.number)??1)!==1?navigator.mediaSession.setActionHandler("previoustrack",()=>{o(-1)}):navigator.mediaSession.setActionHandler("previoustrack",null),((Ie=(ee=i.meta)==null?void 0:ee.episode)==null?void 0:Ie.number)!==((Ae=(Re=i.meta)==null?void 0:Re.episodes)==null?void 0:Ae.length)?navigator.mediaSession.setActionHandler("nexttrack",()=>{o(1)}):navigator.mediaSession.setActionHandler("nexttrack",null)},[o,a,i.mediaPlaying.hasPlayedOnce,i.mediaPlaying.isLoading,i.progress.duration,i.progress.time,(c=(l=i.meta)==null?void 0:l.episode)==null?void 0:c.number,(m=(d=i.meta)==null?void 0:d.episodes)==null?void 0:m.length,i.display,i.mediaPlaying,(g=(b=i.meta)==null?void 0:b.episode)==null?void 0:g.title,(f=i.meta)==null?void 0:f.title,(h=i.meta)==null?void 0:h.type,(j=i.meta)==null?void 0:j.poster,(x=(y=i.meta)==null?void 0:y.season)==null?void 0:x.number]),null}function oh(){const e=p(r=>r.meta),t=p(r=>r.progress),s=p(r=>r.mediaPlaying);return u.useEffect(()=>(window.meta||(window.meta={}),e&&(window.meta.player={meta:{title:e.title,type:e.type,tmdbId:e.tmdbId,year:e.releaseYear,poster:e.poster},controls:{isPlaying:s.isPlaying,isLoading:s.isLoading},season:e.season?{number:e.season.number,tmdbId:e.season.tmdbId,title:e.season.title}:void 0,episode:e.episode?{number:e.episode.number,tmdbId:e.episode.tmdbId,title:e.episode.title}:void 0,progress:{time:t.time,duration:t.duration}}),()=>{window.meta&&delete window.meta.player}),[e,t,s]),null}function ah(){const e=p(l=>l.meta),t=p(l=>l.progress),s=re(l=>l.updateItem),r=p(l=>l.status),i=p(l=>l.mediaPlaying.hasPlayedOnce),o=u.useRef(null),a=u.useRef({updateItem:s,meta:e,progress:t,status:r,hasPlayedOnce:i});return u.useEffect(()=>{a.current.updateItem=s,a.current.meta=e,a.current.progress=t,a.current.status=r,a.current.hasPlayedOnce=i},[s,t,e,r,i]),Gn(()=>{var d,m;const l=a.current;if(!l.progress||!l.meta||!l.updateItem||l.status!==W.PLAYING||!i)return;let c=!1;o.current?(((d=o.current)==null?void 0:d.duration)!==t.duration||((m=o.current)==null?void 0:m.watched)!==t.time)&&(c=!0):c=!0,o.current={duration:t.duration,watched:t.time},c&&l.updateItem({meta:l.meta,progress:o.current})},3e3),null}function lh(e){const t=[0,1];let s=.5,r=0;for(let i=0;i<e;i+=1){const o=1/s-1;for(let a=0;a<o-r;a+=1){const l=a*s*2;t.push(l+s)}r=o,s/=2}return t}class ch{constructor(t){this.videoEl=null,this.canvasEl=null,this.hls=null,this.cb=t.addImage,this.interrupted=!1}start(t){if(Ti)return!1;const s=document.createElement("video");s.setAttribute("muted","true");const r=document.createElement("canvas");if(this.hls=new Ce,t.type==="mp4")s.src=tt(t.url),s.crossOrigin="anonymous";else if(t.type==="hls")this.hls.attachMedia(s),this.hls.loadSource(tt(t.url));else throw new Error("Invalid loadable source type");this.videoEl=s,this.canvasEl=r,this.begin().catch(i=>console.error(i))}destroy(){var t,s;this.interrupted=!0,this.videoEl=null,this.canvasEl=null,(t=this.hls)==null||t.detachMedia(),(s=this.hls)==null||s.destroy(),this.hls=null}async initVideo(){!this.videoEl||!this.canvasEl||(await new Promise((t,s)=>{var r,i;(r=this.videoEl)==null||r.addEventListener("loadedmetadata",t),(i=this.videoEl)==null||i.addEventListener("error",s)}),!(!this.videoEl||!this.canvasEl)&&(this.canvasEl.height=this.videoEl.videoHeight,this.canvasEl.width=this.videoEl.videoWidth))}async takeSnapshot(t){if(!this.videoEl||!this.canvasEl||(this.videoEl.currentTime=t,await new Promise(i=>{var a;const o=()=>{var l;(l=this.videoEl)==null||l.removeEventListener("seeked",o),i(null)};(a=this.videoEl)==null||a.addEventListener("seeked",o)}),!this.videoEl||!this.canvasEl))return;const s=this.canvasEl.getContext("2d");if(!s)return;s.drawImage(this.videoEl,0,0,this.canvasEl.width,this.canvasEl.height);const r=this.canvasEl.toDataURL();this.interrupted||r==="data:,"||!r||this.cb({at:t,data:r})}async begin(){const t=this.videoEl;if(!t)return;await this.initVideo();const s=lh(6);for(let r=0;r<s.length;r+=1){if(this.interrupted)return;await this.takeSnapshot(t.duration*s[r])}}}function dh(){var b,g;const e=p(f=>f.thumbnails.addImage),t=p(f=>f.status),s=p(f=>f.thumbnails.resetImages),r=p(f=>f.meta),i=p(f=>f.source),o=$i(f=>f.enableThumbnails),a=u.useRef(null),l=JSON.stringify(i),c=u.useCallback(()=>{let f=null;if(i&&(f=Rn(i,{automaticQuality:!1,lastChosenQuality:"360"})),a.current||t!==W.PLAYING||!f)return;s();const h=new ch({addImage:e});a.current=h,h.start(f.stream)},[i,e,s,t]),d=u.useRef(c);u.useEffect(()=>{d.current=c},[c,t]),u.useEffect(()=>{o&&d.current()},[l,o]),u.useEffect(()=>()=>{a.current&&(a.current.destroy(),a.current=null)},[]);const m=JSON.stringify({id:r==null?void 0:r.tmdbId,ep:(b=r==null?void 0:r.episode)==null?void 0:b.tmdbId,se:(g=r==null?void 0:r.season)==null?void 0:g.tmdbId});return u.useEffect(()=>{a.current&&(a.current.destroy(),a.current=null),o&&d.current()},[m,l,t,o]),null}function uh(){const e=p(r=>r.display),t=p(r=>r.setDisplay),s=u.useRef(e);u.useEffect(()=>{s.current=e},[e]),u.useEffect(()=>{if(!s.current){const r=Gi();s.current=r,t(r)}return()=>{s.current&&(s.current=null,t(null))}},[t])}function Ki(){return p(t=>t.status)===W.PLAYING}function mh(e,t){const s=u.useRef(null),r=u.useMemo(()=>{s.current&&URL.revokeObjectURL(s.current);const i=e();return s.current=i,i},t);return u.useEffect(()=>()=>{s.current&&URL.revokeObjectURL(s.current)},[]),r}const hh=function(){const t=u.useRef(null),s=u.useRef(null),r=p(d=>d.display),i=p(d=>{var m;return(m=d.caption.selected)==null?void 0:m.srtData}),o=p(d=>{var m;return(m=d.caption.selected)==null?void 0:m.language}),a=p(d=>d.interface.isCasting),l=mh(()=>i?Kd(i):null,[i]);u.useEffect(()=>{r&&t.current&&r.processVideoElement(t.current)},[r,t]),u.useEffect(()=>{s.current&&(s.current.track.mode="showing")},[s]);let c=null;return a&&l&&o&&(c=n.jsx("track",{label:"movie-web",kind:"subtitles",srcLang:o,src:l,default:!0})),n.jsx("video",{id:"video-element",className:"absolute inset-0 w-full h-screen bg-black",autoPlay:!0,playsInline:!0,ref:t,children:c})},fh=hh;function gh(){const e=Ki();return uh(),Jd(),e?n.jsx(fh,{}):null}function xh(e){const t=Ki(),s=p(b=>b.display),r=p(b=>b.mediaPlaying.isPaused),i=p(b=>b.updateInterfaceHovering),o=p(b=>b.interface.hovering),[a,l,c]=Ba(()=>{i(ve.NOT_HOVERING)},3e3);Rr(()=>{l()});const d=u.useCallback(()=>{s==null||s.toggleFullscreen()},[s]),m=u.useCallback(b=>{if(b.pointerType==="mouse"){if(b.button!==0)return;r?s==null||s.play():s==null||s.pause();return}o!==ve.MOBILE_TAPPED?(i(ve.MOBILE_TAPPED),c()):(i(ve.NOT_HOVERING),l())},[s,r,o,i,c,l]);return t?n.jsx("div",{className:_("absolute inset-0",{"absolute inset-0":!0,"cursor-none":!e.showingControls}),onDoubleClick:d,onPointerUp:m}):null}function ph(e){const t=u.useRef(null),s=p(i=>i.updateInterfaceHovering),r=p(i=>i.interface.hovering);u.useEffect(()=>{if(!e.current)return;const i=e.current;function o(l){l.pointerType==="mouse"&&(s(ve.MOUSE_HOVER),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{s(ve.NOT_HOVERING),t.current=null},3e3))}function a(l){l.pointerType==="mouse"&&(s(ve.NOT_HOVERING),t.current&&clearTimeout(t.current))}return i.addEventListener("pointermove",o),i.addEventListener("pointerleave",a),()=>{i.removeEventListener("pointermove",o),i.removeEventListener("pointerleave",a)}},[e,r,s])}function bh(e){const t=u.useRef(null),s=p(r=>r.display);return ph(t),u.useEffect(()=>{s&&t.current&&s.processContainerElement(t.current)},[s,t]),n.jsx("div",{ref:t,children:n.jsx(Xc,{children:n.jsx("div",{className:"h-screen select-none",children:e.children})})})}function yh(e){const t=u.useRef(e.onLoad);return u.useEffect(()=>{var s;(s=t.current)==null||s.call(t)},[]),n.jsx("div",{className:"relative",children:n.jsxs(bh,{children:[n.jsx(oh,{}),n.jsx(dh,{}),n.jsx(nh,{}),n.jsx(gh,{}),n.jsx(ah,{}),n.jsx(rh,{}),n.jsx(ih,{}),n.jsxs("div",{className:"relative h-screen overflow-hidden",children:[n.jsx(xh,{showingControls:e.showingControls}),n.jsx(sh,{}),e.children]})]})})}const vh=function(t){const[s]=hd(t.id),r=ye(a=>a.hideBanner),i={error:"bg-[#C93957] text-white"},o={error:w.CIRCLE_EXCLAMATION};return n.jsx("div",{ref:s,children:n.jsxs("div",{className:[i[t.type],"flex items-center justify-center p-1"].join(" "),children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(P,{icon:o[t.type]}),n.jsx("div",{children:t.children})]}),n.jsx("span",{className:"absolute right-4 hover:cursor-pointer",onClick:()=>r(t.id,!0),children:n.jsx(P,{icon:w.X})})]})})},jh=vh;function Yi(e){const{t}=R(),s=ye(l=>l.isOnline),r=ye(l=>l.setLocation),i=ye(l=>l.ignoredBannerIds),o=ye(l=>l.location),a=e.location??null;return u.useEffect(()=>{if(a)return r(a),()=>{r(null)}},[r,a]),o!==a?null:n.jsx("div",{children:!s&&!i.includes("offline")?n.jsx(jh,{id:"offline",type:"error",children:t("navigation.banner.offline")}):null})}function wh(e){const t=hn("player"),s=p(r=>r.setHoveringAnyControls);return u.useEffect(()=>()=>{s(!1)},[s]),n.jsxs("div",{className:"w-full text-white",children:[n.jsx(de,{animation:"fade",show:e.show,style:{top:`${t}px`},className:"pointer-events-none flex justify-end pb-32 bg-gradient-to-b from-black to-transparent [margin-bottom:env(safe-area-inset-bottom)] transition-opacity duration-200 absolute top-0 w-full"}),n.jsx("div",{className:"relative z-10",children:n.jsx(Yi,{location:"player"})}),n.jsx("div",{onMouseOver:()=>s(!0),onMouseOut:()=>s(!1),className:"pointer-events-auto pl-[calc(2rem+env(safe-area-inset-left))] pr-[calc(2rem+env(safe-area-inset-right))] pt-6 absolute top-0 w-full",style:{top:`${t}px`},children:n.jsx(de,{animation:"slide-down",show:e.show,className:"top-content text-white",children:e.children})})]})}function dr(e){return n.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none [&>*]:pointer-events-auto",children:e.children})}function kh(e){const t=p(s=>s.setHoveringAnyControls);return u.useEffect(()=>()=>{t(!1)},[t]),n.jsxs("div",{className:"w-full text-white",children:[n.jsx(de,{animation:"fade",show:e.show,className:"pointer-events-none flex justify-end pt-32 bg-gradient-to-t from-black to-transparent transition-opacity duration-200 absolute bottom-0 w-full"}),n.jsx("div",{onMouseOver:()=>t(!0),onMouseOut:()=>t(!1),className:"pointer-events-auto z-10 pl-[calc(2rem+env(safe-area-inset-left))] pr-[calc(2rem+env(safe-area-inset-right))] pb-3 mb-[env(safe-area-inset-bottom)] absolute bottom-0 w-full",children:n.jsx(de,{animation:"slide-up",show:e.show,children:e.children})})]})}function Nh(e){return n.jsx(de,{animation:"fade",show:e.show,className:"absolute inset-0 w-full h-full bg-black bg-opacity-20 pointer-events-none"})}function Sh(e){const{t}=R();return n.jsx("div",{className:"flex items-center",children:n.jsxs(Nt,{to:e.url,className:"py-1 -my-1 px-2 -mx-2 tabbable rounded-lg flex items-center cursor-pointer text-type-secondary hover:text-white transition-colors duration-200 font-medium",children:[n.jsx(P,{className:"mr-2",icon:w.ARROW_LEFT}),n.jsx("span",{className:"md:hidden",children:t("player.back.short")}),n.jsx("span",{className:"hidden md:block",children:t("player.back.default")})]})})}function Ch(e){const t=p(r=>r.setHoveringLeftControls),s=u.useCallback(()=>{t(!1)},[t]);return u.useEffect(()=>()=>{t(!1)},[t]),n.jsx("div",{className:_(["flex space-x-3 items-center",e.className]),onMouseLeave:s,children:e.children})}function Eh(e){return n.jsx(de,{animation:"fade",show:e.show,className:"pointer-events-none",children:n.jsx("div",{className:_(["absolute inset-0 flex space-x-6 items-center justify-center pointer-events-none [&>*]:pointer-events-auto",e.className]),children:e.children})})}const Ih={i:"I"};function Th(e){let{text:t,styling:s,overrideCasing:r}=e;const i=u.useMemo(()=>{let o=t;r&&t&&(o=t.slice(0,1)+t.slice(1).toLowerCase());const a=(o||"").split(" ").map(c=>Ih[c]??c).join(" ").replaceAll(/ i'/g," I'").replaceAll(/\r?\n/g,"<br />");return Vd(a,{ALLOWED_TAGS:["c","b","i","u","span","ruby","rt","br"],ADD_TAGS:["v","lang"],ALLOWED_ATTR:["title","lang"]})},[t,r]);return n.jsx("p",{className:"pointer-events-none mb-1 select-none rounded px-4 py-1 text-center leading-normal [text-shadow:0_2px_4px_rgba(0,0,0,0.5)]",style:{color:s.color,fontSize:`${(1.5*s.size).toFixed(2)}em`,backgroundColor:`rgba(0,0,0,${s.backgroundOpacity.toFixed(2)})`,backdropFilter:s.backgroundBlur!==0?`blur(${Math.floor(s.backgroundBlur*64)}px)`:"none",fontWeight:s.bold?"bold":"normal"},children:n.jsx("span",{dangerouslySetInnerHTML:{__html:i},dir:"ltr"})})}function Lh(){const e=p(c=>c.progress.time),t=p(c=>{var d;return(d=c.caption.selected)==null?void 0:d.srtData}),s=p(c=>{var d;return(d=c.caption.selected)==null?void 0:d.language}),r=Q(c=>c.styling),i=Q(c=>c.overrideCasing),o=Q(c=>c.delay),a=u.useMemo(()=>t?Wd(t):[],[t,s]),l=u.useMemo(()=>a.filter(c=>{let{start:d,end:m}=c;return Fd(d,m,o,e)}),[a,e,o]);return n.jsx("div",{children:l.map((c,d)=>{let{start:m,end:b,content:g}=c;return n.jsx(Th,{text:g,styling:r,overrideCasing:i},$d(d,m,b))})})}function Ph(e){const t=p(o=>o.caption.selected),s=p(o=>o.caption.asTrack),r=p(o=>o.display),i=(r==null?void 0:r.getType())==="casting";return s||!t||i?null:n.jsx(de,{className:"absolute inset-0 pointer-events-none",animation:"slide-up",show:!0,children:n.jsx("div",{className:_(["text-white absolute flex w-full flex-col items-center transition-[bottom]",e.controlsShown?"bottom-24":"bottom-12"]),children:n.jsx(Lh,{})})})}function Rh(){const e=te(a=>a.addBookmark),t=te(a=>a.removeBookmark),s=te(a=>a.bookmarks),r=p(a=>a.meta),i=!!s[(r==null?void 0:r.tmdbId)??""],o=u.useCallback(()=>{r&&(i?t(r.tmdbId):e(r))},[i,r,e,t]);return n.jsx(we,{onClick:()=>o(),icon:i?w.BOOKMARK:w.BOOKMARK_OUTLINE,iconSizeClass:"text-base",className:"p-3"})}function ur(){const[e,t]=u.useState(!1);return n.jsx(we,{icon:e?w.SHRINK:w.STRETCH,className:"text-white",onClick:()=>{const s=document.getElementById("video-element");s&&(s.classList.toggle("object-cover"),t(!e))}})}function Ah(){const e=p(m=>m.interface.hovering),t=p(m=>m.interface.lastHoveringState),s=p(m=>m.mediaPlaying.isPaused),r=p(m=>m.interface.hasOpenOverlay),i=p(m=>m.interface.isHoveringControls),o=t===ve.MOBILE_TAPPED,l=e!==ve.NOT_HOVERING||i&&!o||r,d=o?l:l||s;return{showTouchTargets:o&&d,showTargets:d}}function _h(e){const[t,s]=u.useState(!1),{showTargets:r,showTouchTargets:i}=Ah(),o=p(b=>b.status),{isMobile:a}=Lt(),l=p(b=>b.mediaPlaying.isLoading);u.useEffect(()=>{s(window.parent!==window)},[]);const c=/iPad|iPhone|iPod/i.test(navigator.userAgent)&&window.matchMedia("(display-mode: standalone)").matches,[d,m]=u.useState(!1);return document.addEventListener("keydown",b=>{b.key==="Shift"&&m(!0)}),document.addEventListener("keyup",b=>{b.key==="Shift"&&m(!1)}),n.jsxs(yh,{onLoad:e.onLoad,showingControls:r,children:[e.children,n.jsx(Nh,{show:r&&o===W.PLAYING}),n.jsx(Dm,{onChange:e.onMetaChange}),n.jsx(Pm,{}),n.jsx(Ph,{controlsShown:r}),o===W.PLAYING?n.jsxs(n.Fragment,{children:[n.jsxs(dr,{children:[n.jsx(du,{}),n.jsx(uu,{})]}),n.jsx(dr,{children:n.jsx(Wm,{})})]}):null,n.jsxs(Eh,{className:"text-white",show:i&&o===W.PLAYING,children:[n.jsx(nr,{iconSizeClass:"text-3xl"}),n.jsx(Xs,{iconSizeClass:"text-5xl",className:l?"opacity-0":"opacity-100"}),n.jsx(tr,{iconSizeClass:"text-3xl"})]}),n.jsx(wh,{show:r,children:n.jsxs("div",{className:"grid grid-cols-[1fr,auto] xl:grid-cols-3 items-center",children:[n.jsxs("div",{className:"flex space-x-3 items-center",children:[!t&&n.jsx(Sh,{url:e.backUrl}),n.jsx("span",{className:"text mx-3 text-type-secondary",children:"/"}),n.jsx(fu,{}),n.jsx(Rh,{})]}),n.jsx("div",{className:"text-center hidden xl:flex justify-center items-center",children:n.jsx(gu,{})}),n.jsx("div",{className:"hidden sm:flex items-center justify-end",children:n.jsx(Ge,{})}),n.jsx("div",{className:"flex sm:hidden items-center justify-end",children:o===W.PLAYING?n.jsxs(n.Fragment,{children:[n.jsx(ar,{}),n.jsx(cr,{})]}):null})]})}),n.jsxs(kh,{show:r,children:[n.jsx("div",{className:"flex items-center space-x-3",children:o===W.PLAYING?n.jsxs(n.Fragment,{children:[a?n.jsx(sr,{short:!0}):null,n.jsx(cu,{})]}):null}),n.jsxs("div",{className:"hidden lg:flex justify-between",dir:"ltr",children:[n.jsx(Ch,{children:o===W.PLAYING?n.jsxs(n.Fragment,{children:[n.jsx(Xs,{}),n.jsx(nr,{}),n.jsx(tr,{}),n.jsx(hu,{}),n.jsx(sr,{})]}):null}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(or,{}),o===W.PLAYING?n.jsxs(n.Fragment,{children:[n.jsx(Zs,{}),n.jsx(ar,{}),n.jsx(cr,{})]}):null,o===W.PLAYBACK_ERROR||o===W.PLAYING?n.jsx(ir,{}):null,!d&&n.jsx(Js,{}),d&&n.jsx("div",{children:n.jsx(ur,{})})]})]}),n.jsxs("div",{className:"grid grid-cols-[2.5rem,1fr,2.5rem] gap-3 lg:hidden",children:[n.jsx("div",{}),n.jsxs("div",{className:"flex justify-center space-x-3",children:[!c&&(o===W.PLAYING?n.jsx(Zs,{}):null),n.jsx(or,{}),o===W.PLAYING?n.jsx(ir,{}):null,c&&o===W.PLAYING&&n.jsx(ur,{})]}),n.jsxs("div",{children:[!c&&n.jsx("div",{children:n.jsx(Js,{})}),c&&n.jsx("div",{children:n.jsx(nu,{})})]})]})]}),n.jsx(Bm,{}),n.jsx(Hm,{controlsShowing:r,onChange:e.onMetaChange})]})}const Mh={releaseYear:2010,title:"Sintel",tmdbId:"",type:"movie"},mr={hls:"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",mp4:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"},hr={hls:"HLS",mp4:"MP4"};function Oh(){const{status:e,playMedia:t,setMeta:s}=Ii(),[r,i]=u.useState("mp4"),[o,a]=u.useState(""),l=u.useCallback((c,d)=>{let m;if(d==="hls")m={type:"hls",url:c};else if(d==="mp4")m={type:"file",qualities:{unknown:{type:"mp4",url:c}}};else throw new Error("Invalid type");s(Mh),t(m,[],null)},[t,s]);return n.jsxs(_h,{backUrl:"/",children:[e===W.IDLE?n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsx("div",{className:"w-full max-w-4xl rounded-xl bg-video-scraping-card p-10 m-4",children:n.jsxs("div",{className:"flex gap-16 flex-col lg:flex-row",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx(jt,{children:"Custom stream"}),n.jsxs("div",{className:"grid grid-cols-[1fr,auto] gap-2 items-center",children:[n.jsx(ls,{className:"bg-video-context-flagBg rounded-md p-2 text-white w-full",value:o,onChange:a,placeholder:"https://..."}),n.jsx(Td,{options:Object.entries(hr).map(c=>({id:c[0],name:c[1]})),selectedItem:{id:r,name:hr[r]},setSelectedItem:c=>i(c.id)})]}),n.jsx($,{onClick:()=>l(o,r),children:"Start stream"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx(jt,{children:"Preset tests"}),n.jsxs("div",{className:"grid grid-cols-[1fr,1fr] gap-2",children:[n.jsx($,{onClick:()=>l(mr.hls,"hls"),children:"HLS test"}),n.jsx($,{onClick:()=>l(mr.mp4,"mp4"),children:"MP4 test"})]})]})]})})}):null,e===W.PLAYBACK_ERROR?n.jsx(tu,{}):null]})}const Ht=[{name:"Now Playing",endpoint:"/movie/now_playing?language=en-US"},{name:"Top Rated",endpoint:"/movie/top_rated?language=en-US"},{name:"Most Popular",endpoint:"/movie/popular?language=en-US"}],Wt=[{name:"Top Rated",endpoint:"/tv/top_rated?language=en-US"},{name:"Most Popular",endpoint:"/tv/popular?language=en-US"}],Dh=function(){const[t,s]=u.useState(!1),r=()=>{const o=window.scrollY>300;s(o)};u.useEffect(()=>{const o=()=>{const a=setTimeout(r,100);return()=>clearTimeout(a)};return window.addEventListener("scroll",o),()=>{window.removeEventListener("scroll",o)}},[]);const i=()=>{window.scrollTo({top:0,behavior:"smooth"})};return n.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50",children:[n.jsx("div",{className:`absolute inset-0 mx-auto h-[50px] w-[200px] rounded-full blur-[50px] opacity-50 pointer-events-none z-0 ${t?"opacity-100 visible":"opacity-0 invisible"}`,style:{backgroundImage:"linear-gradient(to right, rgba(var(--colors-buttons-purpleHover)), rgba(var(--colors-progress-filled)))",transition:"opacity 0.4s ease-in-out, transform 0.4s ease-in-out"}}),n.jsxs("button",{type:"button",onClick:i,className:`relative flex items-center justify-center space-x-2 rounded-full px-4 py-3 text-lg font-semibold text-white bg-pill-background bg-opacity-80 hover:bg-pill-backgroundHover transition-opacity hover:scale-105 transition-transform duration-500 ease-in-out ${t?"opacity-100 visible":"opacity-0 invisible"}`,style:{transition:"opacity 0.4s ease-in-out, transform 0.4s ease-in-out"},children:[n.jsx(P,{icon:w.CHEVRON_UP,className:"text-2xl z-10"}),n.jsx("span",{className:"z-10",children:"Back to top"})]})]})},Bh=Dh;function Uh(){const[e,t]=u.useState([]),[s,r]=u.useState(null),[i,o]=u.useState({}),[a,l]=u.useState({}),[c,d]=u.useState({name:"",id:""}),[m,b]=u.useState({}),[g,f]=u.useState({name:"",id:""}),h=[{name:"Netflix",id:"8"},{name:"Apple TV+",id:"2"},{name:"Amazon Prime Video",id:"10"},{name:"Hulu",id:"15"},{name:"Max",id:"1899"},{name:"Paramount Plus",id:"531"},{name:"Disney Plus",id:"337"},{name:"Shudder",id:"99"}],j=[{name:"Netflix",id:"8"},{name:"Apple TV+",id:"350"},{name:"Paramount Plus",id:"531"},{name:"Hulu",id:"15"},{name:"Max",id:"1899"},{name:"Disney Plus",id:"337"},{name:"fubuTV",id:"257"}],[y,x]=u.useState(null),v=oe(),[I,A]=u.useState({}),[M,O]=u.useState({}),[C,k]=u.useState([]),[D,U]=u.useState({}),V=u.useRef(null),Y=u.useRef({}),B=u.useRef(null),[q,ke]=u.useState(null),{isMobile:Ne}=Lt(),[ee,Ie]=u.useState("movies"),[Re,Ae]=u.useState(!1),pe=N=>{Ie(typeof N=="string"?N:N.target.value),Ae(!1)};u.useEffect(()=>{const N=async T=>{try{const S=await he(T.endpoint,{api_key:F().TMDB_READ_API_KEY,language:"en-US"});for(let L=S.results.length-1;L>0;L-=1){const z=Math.floor(Math.random()*(L+1));[S.results[L],S.results[z]]=[S.results[z],S.results[L]]}O(L=>({...L,[T.name]:S.results}))}catch(S){console.error(`Error fetching movies for category ${T.name}:`,S)}};Ht.forEach(N)},[]),u.useEffect(()=>{const N=async T=>{try{const S=await he(T.endpoint,{api_key:F().TMDB_READ_API_KEY,language:"en-US"});for(let L=S.results.length-1;L>0;L-=1){const z=Math.floor(Math.random()*(L+1));[S.results[L],S.results[z]]=[S.results[z],S.results[L]]}A(L=>({...L,[T.name]:S.results}))}catch(S){console.error(`Error fetching movies for category ${T.name}:`,S)}};Wt.forEach(N)},[]),u.useEffect(()=>{(async()=>{try{const T=await he("/genre/tv/list",{api_key:F().TMDB_READ_API_KEY,language:"en-US"});k(T.genres.slice(0,10))}catch(T){console.error("Error fetching TV show genres:",T)}})()},[]),u.useEffect(()=>{const N=async T=>{try{const S=await he("/discover/tv",{api_key:F().TMDB_READ_API_KEY,with_genres:T.toString(),language:"en-US"});for(let L=S.results.length-1;L>0;L-=1){const z=Math.floor(Math.random()*(L+1));[S.results[L],S.results[z]]=[S.results[z],S.results[L]]}U(L=>({...L,[T]:S.results}))}catch(S){console.error(`Error fetching TV shows for genre ${T}:`,S)}};C.forEach(T=>N(T.id))},[C]),u.useEffect(()=>{(async()=>{try{const T=await he("/genre/movie/list",{api_key:F().TMDB_READ_API_KEY,language:"en-US"});t(T.genres.slice(0,12))}catch(T){console.error("Error fetching genres:",T)}})()},[]),u.useEffect(()=>{const N=async T=>{try{const S=[];for(let L=1;L<=6;L+=1){const z=await he("/discover/movie",{api_key:F().TMDB_READ_API_KEY,with_genres:T.toString(),language:"en-US",page:L.toString()});S.push(...z.results)}for(let L=S.length-1;L>0;L-=1){const z=Math.floor(Math.random()*(L+1));[S[L],S[z]]=[S[z],S[L]]}o(L=>({...L,[T]:S}))}catch(S){console.error(`Error fetching movies for genre ${T}:`,S)}};e.forEach(T=>N(T.id))},[e]);const ut=async N=>{try{const T=[];for(let S=1;S<=3;S++){const L=await he("/discover/movie",{api_key:F().TMDB_READ_API_KEY,language:"en-US",page:S.toString(),with_watch_providers:N,watch_region:"US"});T.push(...L.results)}l(S=>({...S,[N]:T}))}catch(T){console.error(`Error fetching movies for provider ${N}:`,T)}};u.useEffect(()=>{const N=h[Math.floor(Math.random()*h.length)];d(N),ut(N.id)},[]);const Ns=async N=>{try{const T=[];for(let S=1;S<=3;S++){const L=await he("/discover/tv",{api_key:F().TMDB_READ_API_KEY,language:"en-US",page:S.toString(),with_watch_providers:N,watch_region:"US"});T.push(...L.results)}b(S=>({...S,[N]:T}))}catch(T){console.error(`Error fetching tv shows for provider ${N}:`,T)}};u.useEffect(()=>{const N=j[Math.floor(Math.random()*j.length)];f(N),Ns(N.id)},[]);function Ss(N,T){const S=Y.current[N];if(S){const L=S.getElementsByTagName("a");if(L.length>0){const z=L[0].offsetWidth,G=Math.floor(S.offsetWidth/z);let Me=z*2;G>5&&(Me=z*4),T==="left"?S.scrollBy({left:-Me,behavior:"smooth"}):S.scrollBy({left:Me,behavior:"smooth"})}}}const[Cs,oo]=u.useState(window.innerWidth<600?"150px":"200px");u.useEffect(()=>{const N=()=>{oo(window.innerWidth<600?"150px":"200px")};return window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N)}},[]);const ao=!!window.chrome;let At=!1;function lo(N,T){At||(At=!0,Math.abs(N.deltaX)>Math.abs(N.deltaY)&&(N.stopPropagation(),N.preventDefault()),ao?setTimeout(()=>{At=!1},345):At=!1)}u.useEffect(()=>{if(V.current&&B.current){const N=V.current.getBoundingClientRect().height;B.current.style.top=`${N}px`,B.current.style.bottom=`${N}px`}},[Cs]);function Ye(N,T){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const L=`${T.toLowerCase().replace(/ /g,"-")}${Math.random()}`,z=T==="Now Playing"?"In Cinemas":T===`Popular Movies on ${c.name}`?`Popular Movies on ${c.name}`:T===`Popular Shows on ${g.name}`?`Popular Shows on ${g.name}`:T.includes("Movie")?`${T}s`:S?`${T} Shows`:`${T} Movies`;return n.jsxs("div",{className:"relative overflow-hidden",children:[n.jsx("h2",{className:"mt-2 text-2xl cursor-default font-bold text-white sm:text-3xl md:text-2xl mx-auto pl-5",children:z}),n.jsx("div",{id:`carousel-${L}`,className:"flex whitespace-nowrap pt-0 pb-4 overflow-auto scrollbar rounded-xl overflow-y-hidden",style:{scrollbarWidth:"thin",scrollbarColor:"transparent transparent"},ref:G=>{Y.current[L]=G},onWheel:G=>lo(G),children:N.filter((G,Me,_t)=>Me===_t.findIndex(mt=>mt.id===G.id&&mt.title===G.title)).slice(0,20).map(G=>{var Me,_t,mt,Es;return n.jsx("a",{onClick:()=>v(`/media/tmdb-${S?"tv":"movie"}-${G.id}-${S?G.name:G.title}`),className:"discover-card max-h-200 text-center relative mt-3 mx-[0.285em] transition-transform duration-[0.45s] hover:scale-105",style:{flex:`0 0 ${Cs}`},children:n.jsxs(ue.Base,{className:"group cursor-pointer rounded-xl relative p-[0.65em] bg-background-main transition-colors duration-300 bg-transparent",children:[n.jsx(ue.Light,{flareSize:300,cssColorVar:"--colors-mediaCard-hoverAccent",backgroundClass:"bg-mediaCard-hoverBackground duration-200",className:"rounded-xl bg-background-main group-hover:opacity-100"}),n.jsx("img",{src:G.poster_path?`https://image.tmdb.org/t/p/w500${G.poster_path}`:"/placeholder.png",alt:G.poster_path?"":"failed to fetch :(",className:"rounded-xl relative"}),n.jsx("h1",{className:"group relative pt-2 pr-1 text-[13.5px] whitespace-normal duration-[0.35s] font-semibold text-white opacity-0 group-hover:opacity-100 flex items-center",children:n.jsx("span",{className:"flex-1 text-center",children:S?(((Me=G.name)==null?void 0:Me.length)??0)>32?`${(_t=G.name)==null?void 0:_t.slice(0,32)}...`:G.name:(((mt=G.title)==null?void 0:mt.length)??0)>32?`${(Es=G.title)==null?void 0:Es.slice(0,32)}...`:G.title})})]})},G.id)})}),!Ne&&n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx("button",{type:"button",title:"Back",className:"absolute left-5 top-1/2 transform -translate-y-3/4 z-10",onClick:()=>Ss(L,"left"),children:n.jsx("div",{className:"cursor-pointer text-white flex justify-center items-center h-10 w-10 rounded-full bg-search-hoverBackground active:scale-110 transition-[transform,background-color] duration-200",children:n.jsx(P,{icon:w.ARROW_LEFT})})}),n.jsx("button",{type:"button",title:"Next",className:"absolute right-5 top-1/2 transform -translate-y-3/4 z-10",onClick:()=>Ss(L,"right"),children:n.jsx("div",{className:"cursor-pointer text-white flex justify-center items-center h-10 w-10 rounded-full bg-search-hoverBackground active:scale-110 transition-[transform,background-color] duration-200",children:n.jsx(P,{icon:w.ARROW_RIGHT})})})]})]})}const co=()=>{const N=Object.values(i).flat(),T=new Set;N.forEach(G=>T.add(G.title));const S=Array.from(T),L=Math.floor(Math.random()*S.length),z=N.find(G=>G.title===S[L]);if(z)if(r(z),y!==null&&y>0)x(null),q&&(clearTimeout(q),ke(null),r(null));else{x(5);const G=setTimeout(()=>{v(`/media/tmdb-movie-${z.id}-${z.title}`)},5e3);ke(G)}};u.useEffect(()=>{let N;return y!==null&&y>0&&(N=setInterval(()=>{x(T=>T!==null?T-1:T)},1e3)),()=>{clearInterval(N)}},[y]);const uo=()=>{const N=[];for(const[T,S]of Ht.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{const L=document.getElementById(`carousel-${S.name.toLowerCase().replace(/ /g,"-")}`);L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},children:S.name},T));return N},mo=()=>{const N=[];for(const[T,S]of e.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{const L=document.getElementById(`carousel-${S.name.toLowerCase().replace(/ /g,"-")}`);L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},children:S.name},T+Ht.length));return N},ho=()=>{const N=[];for(const[T,S]of h.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{d({name:S.name,id:S.id}),ut(S.id),setTimeout(()=>{const L=document.getElementById("carousel-providers");L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},300)},children:S.name},S.id));return N},fo=()=>{const N=[];for(const[T,S]of Wt.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{const L=document.getElementById(`tv-carousel-${S.name.toLowerCase().replace(/ /g,"-")}`);L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},children:S.name},T));return N},go=()=>{const N=[];for(const[T,S]of C.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{const L=document.getElementById(`tv-carousel-${S.name.toLowerCase().replace(/ /g,"-")}`);L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},children:S.name},T+Wt.length));return N},xo=()=>{const N=[];for(const[T,S]of j.entries())N.push(n.jsx("button",{type:"button",className:"whitespace-nowrap flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:()=>{f({name:S.name,id:S.id}),Ns(S.id),setTimeout(()=>{const L=document.getElementById("carousel-tv-providers");L&&L.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},300)},children:S.name},S.id));return N},_e=(N,T)=>n.jsx("button",{type:"button",className:"flex items-center rounded-full px-4 text-white py-3",onClick:()=>{const S=document.getElementById(`button-carousel-${N}`),L=200;S&&(T==="left"?S.scrollBy({left:-L,behavior:"smooth"}):S.scrollBy({left:L,behavior:"smooth"}))},children:T==="left"?n.jsx(P,{icon:w.CHEVRON_LEFT,className:"text-2xl"}):n.jsx(P,{icon:w.CHEVRON_RIGHT,className:"text-2xl"})},`${N}-${T}`);return n.jsxs("div",{children:[n.jsx("div",{className:"w-full max-w-screen-xl mx-auto px-4",children:n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("button",{type:"button",className:"flex items-center space-x-2 rounded-full px-4 text-white py-2 bg-pill-background bg-opacity-50 hover:bg-pill-backgroundHover transition-[background,transform] duration-100 hover:scale-105",onClick:co,children:n.jsx("span",{className:"flex items-center",children:y!==null&&y>0?n.jsxs("div",{className:"flex items-center inline-block",children:[n.jsx("span",{children:"Cancel Countdown"}),n.jsx(P,{icon:w.X,className:"text-2xl ml-[4.5px] mb-[-0.7px]"})]}):n.jsxs("div",{className:"flex items-center inline-block",children:[n.jsx("span",{children:"Watch Something New"}),n.jsx("img",{src:"/lightbar-images/dice.svg",alt:"Small Image",style:{marginLeft:"8px"}})]})})})})}),s&&n.jsx("div",{className:"mt-4 mb-4 text-center",children:n.jsxs("p",{children:["Now Playing ",n.jsx("span",{className:"font-bold",children:s.title})," ","in ",y]})}),n.jsxs("div",{className:"mt-8 p-4 w-full max-w-screen-xl mx-auto",children:[n.jsxs("div",{className:"relative flex justify-center mb-4",children:[n.jsxs("button",{type:"button",className:"text-2xl font-bold p-2 bg-transparent text-center rounded-full cursor-pointer flex items-center",onClick:()=>Ae(!Re),children:[ee==="movies"?"Movies":"TV Shows",n.jsx(P,{icon:Re?w.CHEVRON_UP:w.CHEVRON_DOWN,className:"ml-2 text-2xl pt-1"})]}),Re&&n.jsxs("ul",{className:"absolute top-full z-50 mb-1 rounded-lg bg-dropdown-background py-3 px-5 text-left text-white shadow-md border-2 border-gray-800 focus:outline-none tabbable cursor-pointer",children:[n.jsx("li",{className:`cursor-pointer p-2 hover:text-gray-300 ${ee==="movies"?"font-bold":""}`,onClick:()=>pe("movies"),children:"Movies"}),n.jsx("li",{className:`cursor-pointer p-2 hover:text-gray-300 ${ee==="tvshows"?"font-bold":""}`,onClick:()=>pe("tvshows"),children:"TV Shows"})]})]}),ee==="movies"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex justify-center overflow-x-auto -mx-6",children:[Ne&&n.jsx("div",{className:"",children:_e("providers","left")}),n.jsx("div",{id:"button-carousel-providers",className:"flex mb-4 overflow-x-auto scroll-smooth",style:{scrollbarWidth:"thin",scrollbarColor:"transparent transparent"},children:n.jsx("div",{className:"flex space-x-2 py-1",children:ho()})}),Ne&&n.jsx("div",{className:"",children:_e("providers","right")})]}),n.jsxs("div",{className:"flex mb-4 overflow-x-auto -mx-6",children:[n.jsx("div",{className:"",children:_e("movies","left")}),n.jsx("div",{id:"button-carousel-movies",className:"flex mb-4 overflow-x-auto scroll-smooth",style:{scrollbarWidth:"thin",scrollbarColor:"transparent transparent"},children:n.jsxs("div",{className:"flex space-x-2 py-1",children:[uo(),mo()]})}),n.jsx("div",{className:"",children:_e("movies","right")})]})]}),ee==="tvshows"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex justify-center overflow-x-auto -mx-6",children:[Ne&&n.jsx("div",{className:"",children:_e("tv-providers","left")}),n.jsx("div",{id:"button-carousel-tv-providers",className:"flex mb-4 overflow-x-auto scroll-smooth",style:{scrollbarWidth:"thin",scrollbarColor:"transparent transparent"},children:n.jsx("div",{className:"flex space-x-2 py-1",children:xo()})}),Ne&&n.jsx("div",{className:"",children:_e("tv-providers","right")})]}),n.jsxs("div",{className:"flex mb-4 overflow-x-auto -mx-6",children:[n.jsx("div",{className:"",children:_e("tvshows","left")}),n.jsx("div",{id:"button-carousel-tvshows",className:"flex mb-4 overflow-x-auto scroll-smooth",style:{scrollbarWidth:"thin",scrollbarColor:"transparent transparent"},children:n.jsxs("div",{className:"flex space-x-2 py-1",children:[fo(),go()]})}),n.jsx("div",{className:"",children:_e("tvshows","right")})]})]})]}),n.jsxs("div",{className:"",children:[ee==="movies"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center mt-5 mb-4",children:[n.jsx(De,{marginClass:"mr-5"}),n.jsx("h1",{className:"text-4xl font-bold text-white mx-auto",children:"Movies"}),n.jsx(De,{marginClass:"ml-5"})]}),n.jsx("div",{id:"carousel-providers",children:c.id?a[c.id]&&a[c.id].length>0?Ye(a[c.id],`Popular Movies on ${c.name}`):n.jsxs("p",{className:"text-center text-gray-600",children:["No movies available for ",c.name,"."]}):n.jsx("p",{className:"text-center text-gray-600",children:"Please select a provider to view movies."})},`carousel-providers-${c.id}`),n.jsxs("div",{className:"grid grid-cols-1 gap-0 mt-4",children:[" ",Ht.map(N=>n.jsx("div",{id:`carousel-${N.name.toLowerCase().replace(/ /g,"-")}`,className:"",children:Ye(M[N.name]||[],N.name)},N.name)),e.map(N=>n.jsx("div",{id:`carousel-${N.name.toLowerCase().replace(/ /g,"-")}`,className:"",children:Ye(i[N.id]||[],N.name)},`${N.id}|${N.name}`))]})]}),ee==="tvshows"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center mt-10 mb-4",children:[n.jsx(De,{marginClass:"mr-5"}),n.jsx("h1",{className:"text-4xl font-bold text-white mx-auto",children:"Shows"}),n.jsx(De,{marginClass:"ml-5"})]}),n.jsx("div",{id:"carousel-tv-providers",children:g.id?m[g.id]&&m[g.id].length>0?Ye(m[g.id],`Popular Shows on ${g.name}`):n.jsxs("p",{className:"text-center text-gray-600",children:["No shows available for ",g.name,"."]}):n.jsx("p",{className:"text-center text-gray-600",children:"Please select a provider to view shows."})},`carousel-tv-providers-${c.id}`),n.jsxs("div",{className:"grid grid-cols-1 gap-0 mt-4",children:[" ",Wt.map(N=>n.jsx("div",{id:`tv-carousel-${N.name.toLowerCase().replace(/ /g,"-")}`,className:"",children:Ye(I[N.name]||[],N.name,!0)},N.name)),C.map(N=>n.jsx("div",{id:`tv-carousel-${N.name.toLowerCase().replace(/ /g,"-")}`,className:"",children:Ye(D[N.id]||[],N.name,!0)},`${N.id}|${N.name}`))]})]})]}),n.jsx(Bh,{})]})}function Vh(){const{t:e}=R(),[t,s]=u.useState(!0);return u.useEffect(()=>{(async()=>{await new Promise(i=>{setTimeout(i,2e3)}),s(!1)})()},[]),n.jsxs(ze,{children:[n.jsx(Te,{children:n.jsx("style",{type:"text/css",children:`
            html, body {
              scrollbar-width: none;
              -ms-overflow-style: none;
            }
          `})}),n.jsx(Pe,{subpage:!0,k:"global.pages.discover"}),n.jsxs("div",{className:"relative w-full max-w-screen-xl mx-auto px-4 text-center mt-12 mb-12",children:[n.jsx("div",{className:"absolute inset-0 mx-auto h-[400px] max-w-[800px] rounded-full blur-[100px] opacity-20 transform -translate-y-[100px] pointer-events-none",style:{backgroundImage:"linear-gradient(to right, rgba(var(--colors-global-accentA)), rgba(var(--colors-buttons-toggle)))"}}),n.jsxs("h1",{className:"relative text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text z-10",style:{backgroundImage:"linear-gradient(to right, rgba(var(--colors-global-accentA)), rgba(var(--colors-buttons-toggle)))"},children:[e("global.pages.discover")," Movies & TV"]}),n.jsx("p",{className:"relative text-lg mt-4 text-gray-400 z-10",children:"Explore the latest hits and timeless classics."})]}),t?n.jsxs("div",{className:"flex flex-col justify-center items-center h-64 space-y-4",children:[n.jsx(We,{}),n.jsx("p",{className:"text-lg font-medium text-gray-400 animate-pulse mt-4",children:"Fetching the latest movies & TV shows..."}),n.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we load the best recommendations for you."})]}):n.jsx(Uh,{})]})}function Fh(){const{t:e}=R();return n.jsxs("div",{className:"relative flex flex-1 flex-col",children:[n.jsx(Te,{children:n.jsx("title",{children:e("notFound.badge")})}),n.jsx(os,{}),n.jsx("div",{className:"flex h-full flex-1 flex-col items-center justify-center p-5 text-center",children:n.jsx(ss,{children:n.jsxs(ns,{children:[n.jsx(ts,{icon:w.EYE_SLASH,children:e("notFound.badge")}),n.jsx(jt,{children:e("notFound.title")}),n.jsx(ie,{children:e("notFound.message")}),n.jsx($,{href:"/",theme:"purple",padding:"md:px-12 p-2.5",className:"mt-6",children:e("notFound.goHome")})]})})})]})}function $h(){return n.jsx(Fh,{})}function Hh(e,t){const[s,r]=u.useState(e);return u.useEffect(()=>{const i=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(i)}},[e,t]),s}function fr(e){return e?decodeURIComponent(e):""}function qi(){const e=oe(),t=Fn(),[s,r]=u.useState(fr(t.query));u.useEffect(()=>{r(fr(t.query))},[t.query]);const i=function(a){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r(a),!!l){if(a.length===0){e("/",{replace:!0});return}e(Oo("/browse/:query",{query:a}),{replace:!0})}};return[s,i,a=>{i(a??s,!0)}]}function Wh(e){return n.jsxs(fi,{children:[n.jsx(os,{bg:e.showBg}),e.children]})}function Qi(e){const{t}=R(),[s]=$n(),r=u.useCallback(()=>{var i;(i=e.onEdit)==null||i.call(e,!e.editing)},[e]);return n.jsx("button",{type:"button",onClick:r,className:"flex h-12 items-center overflow-hidden rounded-full bg-background-secondary px-4 py-2 text-white transition-[background-color,transform] hover:bg-background-secondaryHover active:scale-105",children:n.jsx("span",{ref:s,children:e.editing?n.jsx("span",{className:"mx-4 whitespace-nowrap",children:t("home.mediaList.stopEditing")}):n.jsx(P,{icon:w.EDIT})})})}function hs(e){return n.jsx("div",{className:e.className,children:n.jsxs("div",{className:"mb-5 flex items-center",children:[n.jsxs("p",{className:"flex flex-1 items-center font-bold uppercase text-type-text",children:[e.icon?n.jsx("span",{className:"mr-2 text-xl",children:n.jsx(P,{icon:e.icon})}):null,e.title]}),e.children]})})}const fs=u.forwardRef((e,t)=>n.jsx("div",{className:"grid grid-cols-2 gap-6 sm:grid-cols-3 md:grid-cols-4",ref:t,children:e.children})),gr={duration:0,watched:0};function Gh(e,t){return e-t<60*2}function Xi(e,t){return t<20}function zh(e,t){return!(Xi(e,t)||Gh(e,t))}function Kh(e,t){const s=t.seasonId;return e.seasons[s].number===1&&t.number===1}function Ji(e){var r,i;if(e.type!=="show")return{show:zh(((r=e.progress)==null?void 0:r.duration)??0,((i=e.progress)==null?void 0:i.watched)??0),progress:e.progress??gr};const t=Object.values(e.episodes).sort((o,a)=>a.updatedAt-o.updatedAt).filter(o=>!Xi(o.progress.duration,o.progress.watched)||!Kh(e,o))[0],s=e.seasons[t==null?void 0:t.seasonId];return!t||!s?{show:!1,progress:gr}:{season:s,episode:t,show:!0,progress:t.progress}}function Yh(e){return n.jsx("p",{className:`font-semibold text-type-secondary ${e.className||""}`,children:e.content.map((t,s)=>n.jsxs("span",{children:[s!==0?n.jsx("span",{className:"mx-[0.6em] text-[1em]",children:"●"}):null,t]},t))})}const qh=function(t){const s=t.clickable?"cursor-pointer hover:scale-110 hover:bg-pill-backgroundHover hover:text-white active:scale-125":"",r=t.transparent?"bg-opacity-0 hover:bg-opacity-50":"",i=t.active?"bg-pill-backgroundHover text-white":"",o=t.downsized?"h-10 w-10":"h-12 w-12";return n.jsx("div",{className:t.className||void 0,onClick:t.onClick,children:n.jsx("div",{className:`flex items-center justify-center rounded-full border-2 border-transparent bg-pill-background bg-opacity-100 transition-[background-color,color,transform,border-color] duration-75 ${r} ${s} ${i} ${o}`,children:n.jsx(P,{icon:t.icon})})})},gs=qh;function Qh(e){let{media:t}=e;const s=te(d=>d.addBookmark),r=te(d=>d.removeBookmark),i=te(d=>d.bookmarks),o=u.useMemo(()=>t.year!==void 0?{type:t.type,title:t.title,tmdbId:t.id,releaseYear:t.year,poster:t.poster}:void 0,[t]),a=!!i[(o==null?void 0:o.tmdbId)??""],l=u.useCallback(()=>{o&&(a?r(o.tmdbId):s(o))},[a,o,s,r]),c=t.year===void 0?"hover:opacity-100":"hover:opacity-95";return n.jsx(gs,{onClick:l,icon:a?w.BOOKMARK:w.BOOKMARK_OUTLINE,className:`${c} p-2 opacity-75 transition-opacity transition-transform duration-300 hover:scale-110 hover:cursor-pointer`})}function Zi(e){const t=!!(e.year&&e.year<=new Date().getFullYear()),s=!!(e.release_date&&e.release_date<=new Date);return e.release_date?s:t}function Xh(e){let{media:t,linkable:s,series:r,percentage:i,closable:o,onClose:a}=e;const{t:l}=R(),c=`${Math.round(i??0).toFixed(0)}%`,d=u.useCallback(()=>Zi(t),[t]),m=s&&!o&&d(),b=[l(`media.types.${t.type}`)],[g]=qi();return t.year&&b.push(t.year.toFixed()),d()||b.push(l("media.unreleased")),n.jsxs(ue.Base,{className:`group -m-[0.705em] rounded-xl bg-background-main transition-colors duration-300 focus:relative focus:z-10 ${m?"hover:bg-mediaCard-hoverBackground tabbable":""}`,tabIndex:m?0:-1,onKeyUp:f=>f.key==="Enter"&&f.currentTarget.click(),children:[n.jsx(ue.Light,{flareSize:300,cssColorVar:"--colors-mediaCard-hoverAccent",backgroundClass:"bg-mediaCard-hoverBackground duration-100",className:_({"rounded-xl bg-background-main group-hover:opacity-100":m})}),n.jsxs(ue.Child,{className:`pointer-events-auto relative mb-2 p-[0.4em] transition-transform duration-300 ${m?"group-hover:scale-95":"opacity-60"}`,children:[n.jsxs("div",{className:_("relative mb-4 pb-[150%] w-full overflow-hidden rounded-xl bg-mediaCard-hoverBackground bg-cover bg-center transition-[border-radius] duration-300",{"group-hover:rounded-lg":m}),style:{backgroundImage:t.poster?`url(${t.poster})`:void 0},children:[r?n.jsx("div",{className:["absolute right-2 top-2 rounded-md bg-mediaCard-badge px-2 py-1 transition-colors"].join(" "),children:n.jsx("p",{className:["text-center text-xs font-bold text-mediaCard-badgeText transition-colors",o?"":"group-hover:text-white"].join(" "),children:l("media.episodeDisplay",{season:r.season||1,episode:r.episode})})}):null,i!==void 0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:`absolute inset-x-0 -bottom-px pb-1 h-12 bg-gradient-to-t from-mediaCard-shadow to-transparent transition-colors ${m?"group-hover:from-mediaCard-hoverShadow":""}`}),n.jsx("div",{className:`absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-mediaCard-shadow to-transparent transition-colors ${m?"group-hover:from-mediaCard-hoverShadow":""}`}),n.jsx("div",{className:"absolute inset-x-0 bottom-0 p-3",children:n.jsx("div",{className:"relative h-1 overflow-hidden rounded-full bg-mediaCard-barColor",children:n.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-mediaCard-barFillColor",style:{width:c}})})})]}):null,g.length>0?n.jsx("div",{className:"absolute",onClick:f=>f.preventDefault(),children:n.jsx(Qh,{media:t})}):null,n.jsx("div",{className:`absolute inset-0 flex items-center justify-center bg-mediaCard-badge bg-opacity-80 transition-opacity duration-500 ${o?"opacity-100":"pointer-events-none opacity-0"}`,children:n.jsx(gs,{clickable:!0,className:"text-2xl text-mediaCard-badgeText transition-transform hover:scale-110 duration-500",onClick:()=>o&&(a==null?void 0:a()),icon:w.X})})]}),n.jsx("h1",{className:"mb-1 line-clamp-3 max-h-[4.5rem] text-ellipsis break-words font-bold text-white",children:n.jsx("span",{children:t.title})}),n.jsx(Yh,{className:"text-xs",content:b})]})]})}function Jh(e){const t=n.jsx(Xh,{...e}),s=u.useCallback(()=>Zi(e.media),[e.media]),r=e.linkable&&!e.closable&&s();let i=r?`/media/${encodeURIComponent(Al(e.media))}`:"#";return r&&e.series&&(e.series.season===0&&!e.series.episodeId?i+=`/${encodeURIComponent(e.series.seasonId)}`:i+=`/${encodeURIComponent(e.series.seasonId)}/${encodeURIComponent(e.series.episodeId)}`),r?n.jsx(Nt,{to:i,tabIndex:-1,className:_("tabbable",e.closable?"hover:cursor-default":""),children:t}):n.jsx("span",{children:t})}function Zh(e){var t,s,r,i;if(!(!e||!e.episode||!e.season))return{episode:(t=e.episode)==null?void 0:t.number,season:(s=e.season)==null?void 0:s.number,episodeId:(r=e.episode)==null?void 0:r.id,seasonId:(i=e.season)==null?void 0:i.id}}function xs(e){const t=re(o=>o.items),s=u.useMemo(()=>t[e.media.id],[t,e.media]),r=u.useMemo(()=>s?Ji(s):null,[s]),i=r!=null&&r.show?r.progress.watched/r.progress.duration*100:void 0;return n.jsx(Jh,{media:e.media,series:Zh(r),linkable:!0,percentage:i,onClose:e.onClose,closable:e.closable})}function ef(){const{t:e}=R(),t=re(c=>c.items),s=te(c=>c.bookmarks),r=te(c=>c.removeBookmark),[i,o]=u.useState(!1),[a]=$n(),l=u.useMemo(()=>{let c=[];return Object.entries(s).forEach(d=>{c.push({id:d[0],...d[1]})}),c=c.sort((d,m)=>{const b=s[d.id],g=s[m.id],f=t[d.id],h=t[m.id],j=Math.max(b.updatedAt,(f==null?void 0:f.updatedAt)??0);return Math.max(g.updatedAt,(h==null?void 0:h.updatedAt)??0)-j}),c},[s,t]);return l.length===0?null:n.jsxs("div",{children:[n.jsx(hs,{title:e("home.bookmarks.sectionTitle")||"Bookmarks",icon:w.BOOKMARK,children:n.jsx(Qi,{editing:i,onEdit:o})}),n.jsx(fs,{ref:a,children:l.map(c=>n.jsx(xs,{media:c,closable:i,onClose:()=>r(c.id)},c.id))})]})}const tf=u.forwardRef((e,t)=>{const[s,r]=u.useState(!1);function i(o){e.onChange(o,!1)}return n.jsxs(ue.Base,{className:_({"hover:flare-enabled group flex flex-col rounded-[28px] transition-colors sm:flex-row sm:items-center relative":!0,"bg-search-background":!s,"bg-search-focused":s}),children:[n.jsx(ue.Light,{flareSize:400,enabled:s,className:"rounded-[28px]",backgroundClass:_({"transition-colors":!0,"bg-search-background":!s,"bg-search-focused":s})}),n.jsxs(ue.Child,{className:"flex flex-1 flex-col",children:[n.jsx("div",{className:"pointer-events-none absolute bottom-0 left-5 top-0 flex max-h-14 items-center text-search-icon",children:n.jsx(P,{icon:w.SEARCH})}),n.jsx(ls,{ref:t,onUnFocus:()=>{r(!1),e.onUnFocus()},onFocus:()=>r(!0),onChange:o=>i(o),value:e.value,className:"w-full flex-1 bg-transparent px-4 py-4 pl-12 text-search-text placeholder-search-placeholder focus:outline-none sm:py-4 sm:pr-2",placeholder:e.placeholder}),e.value.length>0&&n.jsx("div",{onClick:()=>{var o;e.onUnFocus(""),t&&typeof t!="function"&&((o=t.current)==null||o.focus())},className:"cursor-pointer hover:text-white  absolute bottom-0 right-2 top-0 flex justify-center my-auto h-10 w-10 items-center hover:bg-search-hoverBackground active:scale-110 text-search-icon rounded-full transition-[transform,background-color] duration-200",children:n.jsx(P,{icon:w.X,className:"transition-colors duration-200"})})]})]})});function nf(e){u.useEffect(()=>{const t=s=>{var r;if(s.key==="/"){if(document.activeElement&&document.activeElement.tagName.toLowerCase()==="input")return;s.preventDefault(),(r=e.current)==null||r.focus()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e])}function sf(e){return n.jsx("h1",{className:`text-2xl font-bold text-white sm:text-3xl md:text-4xl ${e.className??""}`,children:e.children})}const rf=()=>Math.random()<.35;function of(){const{t:e}=R(),t=u.useMemo(()=>rf(),[]),s=u.useMemo(()=>Math.random(),[]);return{t:u.useCallback(i=>{const o=e(`${i}.default`)??"";if(!t)return o;const a=e(`${i}.extra`,{returnObjects:!0,defaultValue:o});return Array.isArray(a)?a.length===0?o:a[Math.floor(s*a.length)]:typeof a=="string"?a:o},[e,s,t])}}function af(e){const t=e.getMonth()+1,s=e.getDate();if(t===4&&s===20)return"420";if(t===10&&s===31)return"halloween";const r=e.getHours();return r<5?"night":r<12?"morning":r<19?"day":"night"}function lf(e){let{setIsSticky:t,searchParams:s}=e;const{t:r}=of(),[i,o,a]=s,[,l]=u.useState(!1),c=hn(),d=u.useCallback(O=>{l(O),t(O)},[l,t]),{width:m,height:b}=Ua(),g=/iPad|iPhone|iPod/i.test(navigator.userAgent)&&window.matchMedia("(display-mode: standalone)").matches,f=g?60:16,[h,j]=u.useState(f),x=b<m&&g?-40:0;u.useEffect(()=>{m>1280?j(f):j(f+60+x)},[x,f,m]);const v=af(new Date),I=r(`home.titles.${v}`),A=r("home.search.placeholder"),M=u.useRef(null);return nf(M),n.jsx(Et,{children:n.jsxs("div",{className:"mt-44 space-y-16 text-center",children:[n.jsx("div",{className:"relative z-10 mb-16",children:n.jsx(sf,{className:"mx-auto max-w-md",children:I})}),n.jsx("div",{className:"relative h-20 z-30",children:n.jsx(Do,{topOffset:h*-1+c,stickyStyle:{paddingTop:`${h+c}px`},onFixedToggle:d,children:n.jsx(tf,{ref:M,onChange:o,value:i,onUnFocus:a,placeholder:A??""})})})]})})}function cf(){const{t:e}=R(),t=te(c=>c.bookmarks),s=re(c=>c.items),r=re(c=>c.removeItem),[i,o]=u.useState(!1),[a]=$n(),l=u.useMemo(()=>{let c=[];return Object.entries(s).filter(d=>Ji(d[1]).show).sort((d,m)=>m[1].updatedAt-d[1].updatedAt).forEach(d=>{c.push({id:d[0],...d[1]})}),c=c.filter(d=>!!!t[d.id]),c},[s,t]);return l.length===0?null:n.jsxs("div",{children:[n.jsx(hs,{title:e("home.continueWatching.sectionTitle"),icon:w.CLOCK,children:n.jsx(Qi,{editing:i,onEdit:o})}),n.jsx(fs,{ref:a,children:l.map(c=>n.jsx(xs,{media:c,closable:i,onClose:()=>r(c.id)},c.id))})]})}function eo(){const{t:e}=R();return n.jsx(We,{className:"mb-24 mt-40",text:e("home.search.loading")??void 0})}function xr(e){const{t}=R(),s=e.failed?w.WARNING:w.EYE_SLASH;return n.jsxs("div",{className:"mb-24 mt-40  flex flex-col items-center justify-center space-y-3 text-center",children:[n.jsx(gs,{icon:s,className:`text-xl ${e.failed?"text-red-400":"text-type-logo"}`}),e.failed?null:n.jsx("div",{children:(e.results??0)>0?n.jsx("p",{children:t("home.search.allResults")}):n.jsx("p",{children:t("home.search.noResults")})}),e.failed?n.jsx("div",{children:n.jsx("p",{children:t("home.search.failed")})}):null]})}function df(e){let{searchQuery:t}=e;const{t:s}=R(),[r,i]=u.useState([]),[o,a]=xe(l=>ei(l));return u.useEffect(()=>{async function l(c){const d=await a(c);d&&i(d)}t!==""&&l({searchQuery:t})},[t,a]),o.loading?n.jsx(eo,{}):o.error?n.jsx(xr,{failed:!0}):r?n.jsxs("div",{children:[r.length>0?n.jsxs("div",{children:[n.jsx(hs,{title:s("home.search.sectionTitle"),icon:w.SEARCH}),n.jsx(fs,{children:r.map(l=>n.jsx(xs,{media:l},l.id.toString()))})]}):null,n.jsx(xr,{results:r.length})]}):null}function uf(e){const[t,s]=u.useState(!1),[r,i]=u.useState(!1),o=Hh(e,500);return u.useEffect(()=>{s(e!==""),i(e!=="")},[e]),u.useEffect(()=>{i(!1)},[o]),{loading:r,searching:t}}function mf(e){return n.jsx("button",{className:_("font-bold rounded h-10 w-40 scale-90 hover:scale-95 transition-all duration-200",e.className),type:"button",onClick:e.onClick,disabled:e.disabled,children:e.children})}function pr(){const{t:e}=R(),[t,s]=u.useState(!1),r=qi(),[i]=r,o=uf(i),a=oe();return n.jsxs(Wh,{showBg:t,children:[n.jsxs("div",{children:[n.jsx(Te,{children:n.jsxs("title",{children:[" ",e("global.name")," | Stream Your Favorite Movies & TV Shows"," "]})}),n.jsx(lf,{searchParams:r,setIsSticky:s})]}),n.jsx(mi,{children:o.loading?n.jsx(eo,{}):o.searching?n.jsx(df,{searchQuery:i}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex justify-center mt-8 mb-16 sm:mb-24",children:n.jsx(mf,{className:"font-bold h-10 w-40 scale-90 hover:scale-95 transition-all duration-200 px-py p-[0.35em] mt-3 rounded-lg text-type-dimmed box-content text-[18px] bg-largeCard-background text-buttons-secondaryText justify-center items-center",onClick:()=>a("/discover"),children:"Browse"})}),n.jsx(ef,{}),n.jsx(cf,{})]})})]})}function Pt(e){return n.jsxs("div",{className:"flex flex-col items-center",children:[e.top?n.jsx("div",{className:"inline-block transform translate-y-1/2",children:e.top}):null,n.jsx("div",{className:"w-full rounded-xl bg-largeCard-background bg-opacity-50 max-w-[600px] mx-auto p-[3rem]",children:e.children})]})}function Rt(e){return n.jsx("div",{className:"flex flex-col items-center text-center mb-8",children:n.jsxs("div",{className:"flex flex-col items-center text-center max-w-[318px]",children:[e.icon?n.jsx("div",{className:"text-2xl mb-4 text-largeCard-icon",children:e.icon}):null,n.jsx("h2",{className:"text-xl text-white font-bold",children:e.title}),e.children?n.jsx("div",{className:"text-type-text mt-4",children:e.children}):null]})})}function it(e){return n.jsx("div",{className:"mt-12",children:n.jsx("div",{className:_("mx-auto",{"flex flex-row-reverse justify-between items-center":e.splitAlign,"flex max-w-xs flex-col-reverse gap-3":!e.splitAlign}),children:e.children})})}function to(e){const t=!!e.url,s=!!e.to,r=n.jsx("span",{className:"group mt-1 cursor-pointer font-bold text-type-link hover:text-type-linkHover active:scale-95",children:e.children});return t?n.jsx("a",{href:e.url,children:r}):s?n.jsx(Nt,{to:e.to??"",children:r}):n.jsx("span",{onClick:()=>e.onClick&&e.onClick(),children:r})}function wt(e){return n.jsxs("div",{className:_("space-y-3",e.className),children:[e.label?n.jsx("p",{className:"font-bold text-white",children:e.label}):null,n.jsx(ls,{name:e.name,value:e.value,autoComplete:e.autoComplete,onChange:e.onChange,placeholder:e.placeholder,passwordToggleable:e.passwordToggleable,className:"w-full flex-1 bg-authentication-inputBg px-4 py-3 text-search-text focus:outline-none rounded-lg placeholder:text-gray-700"})]})}function hf(e){const[t,s]=u.useState(""),[r,i]=u.useState(""),{login:o,restore:a,importData:l}=ct(),c=re(f=>f.items),d=te(f=>f.bookmarks),{t:m}=R(),[b,g]=xe(async(f,h)=>{var x;if(!jc(f))throw new Error(m("auth.login.validationError")??void 0);const j=h.trim();if(j.length===0)throw new Error(m("auth.login.deviceLengthError")??void 0);let y;try{y=await o({mnemonic:f,userData:{device:j}})}catch(v){throw v.status===401?new Error(m("auth.login.validationError")??void 0):v}if(!y)throw new Error(m("auth.login.validationError")??void 0);await l(y,c,d),await a(y),(x=e.onLogin)==null||x.call(e)},[e,o,a,m]);return n.jsxs(Pt,{top:n.jsx(Ge,{backgroundClass:"bg-[#161527]"}),children:[n.jsx(Rt,{title:m("auth.login.title"),children:m("auth.login.description")}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(wt,{label:m("auth.login.passphraseLabel")??void 0,value:t,autoComplete:"username",name:"username",onChange:s,placeholder:m("auth.login.passphrasePlaceholder")??void 0,passwordToggleable:!0}),n.jsx(wt,{label:m("auth.deviceNameLabel")??void 0,value:r,onChange:i,placeholder:m("auth.deviceNamePlaceholder")??void 0}),b.error&&!b.loading?n.jsx("p",{className:"text-authentication-errorText",children:b.error.message}):null]}),n.jsx(it,{children:n.jsx($,{theme:"purple",loading:b.loading,onClick:()=>g(t,r),children:m("auth.login.submit")})}),n.jsx("p",{className:"text-center mt-6",children:n.jsx(Le,{i18nKey:"auth.createAccount",children:n.jsx(to,{to:"/register",children:"."})})})]})}function ff(){const e=oe();return n.jsxs(ze,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.login"}),n.jsx(hf,{onLogin:()=>{e("/")}})]})}const gf=function(t){const s=t.current/t.steps*100;return n.jsxs("div",{className:t.className,children:[n.jsxs("p",{className:"mb-2",children:[t.current,"/",t.steps]}),n.jsx("div",{className:"max-w-full h-1 w-32 bg-onboarding-bar rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-onboarding-barFilled transition-[width] rounded-full",style:{width:`${s.toFixed(0)}%`}})})]})},ps=gf;function bs(e){return n.jsxs("div",{className:"bg-background-main min-h-screen",style:{backgroundImage:"linear-gradient(to bottom, var(--tw-gradient-from), var(--tw-gradient-to) 800px)"},children:[n.jsx(It,{}),n.jsx("div",{className:"fixed px-7 py-5 left-0 top-0",children:n.jsx(Nt,{className:"block tabbable rounded-full text-xs ssm:text-base",to:"/",children:n.jsx(Ge,{clickable:!0})})}),n.jsx("div",{className:"min-h-screen",children:e.children})]})}const xf=ne(Ee(se(e=>({completed:!1,setCompleted(t){e(s=>{s.completed=t})}})),{name:"__MW::onboarding"}));function ys(){const[e]=mn("redirect"),t=oe(),s=xf(o=>o.setCompleted),r=u.useCallback(()=>{t(e??"/")},[t,e]);return{completeAndRedirect:u.useCallback(()=>{s(!0),r()},[r,s])}}function vs(){const e=oe(),t=ot();return u.useCallback(r=>{e({pathname:r,search:t.search})},[e,t])}function kt(e){return n.jsx("div",{className:_({"bg-onboarding-card duration-300 border border-onboarding-border rounded-lg p-7":!0,"hover:bg-onboarding-cardHover transition-colors cursor-pointer":!!e.onClick},e.className),onClick:e.onClick,children:e.children})}function br(e){return n.jsxs("div",{className:"grid grid-rows-[1fr,auto] h-full",children:[n.jsxs("div",{children:[n.jsx(P,{icon:w.RISING_STAR,className:_("text-4xl mb-8 block",e.colorClass)}),n.jsx(ai,{className:_("!mt-0 !mb-0 !text-xs uppercase",e.colorClass),children:e.subtitle}),n.jsx(je,{className:"!mb-0 !mt-1 !text-base",children:e.title}),n.jsx(ie,{className:"max-w-[320px] !my-4",children:e.description})]}),n.jsx("div",{children:e.children})]})}function $e(e){const t=oe();return n.jsxs("a",{onClick:()=>{e.to&&t(e.to)},href:e.href,target:e.target,className:_("text-onboarding-link cursor-pointer inline-flex gap-2 items-center group hover:opacity-75 transition-opacity",e.className),rel:"noreferrer",children:[e.children,n.jsx(P,{icon:w.ARROW_RIGHT,className:"group-hover:translate-x-0.5 transition-transform text-xl group-active:translate-x-0"})]})}function yr(e){return n.jsx("div",{className:_("w-full grid justify-center",e.className),children:n.jsx("div",{className:"w-px h-10 bg-onboarding-divider"})})}function pf(){const e=vs(),t=rs("skip"),{completeAndRedirect:s}=ys(),{t:r}=R(),i=qn().length===0;return n.jsxs(bs,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.onboarding"}),n.jsx(di,{id:t.id,children:n.jsxs(Jc,{children:[n.jsx(Ct,{className:"!mt-0 !mb-4 !text-2xl",children:r("onboarding.defaultConfirm.title")}),n.jsx(ie,{className:"!mt-1 !mb-12",children:r("onboarding.defaultConfirm.description")}),n.jsxs("div",{className:"flex flex-col-reverse gap-3 md:flex-row md:justify-between",children:[n.jsx($,{theme:"secondary",onClick:t.hide,children:r("onboarding.defaultConfirm.cancel")}),n.jsx($,{theme:"purple",onClick:()=>s(),children:r("onboarding.defaultConfirm.confirm")})]})]})}),n.jsxs(is,{children:[n.jsx(ps,{steps:2,current:1,className:"mb-12"}),n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:r("onboarding.start.title")}),n.jsx(ie,{className:"max-w-[320px]",children:r("onboarding.start.explainer")}),n.jsxs("div",{className:"w-full flex flex-col md:flex-row gap-3",children:[n.jsx(kt,{onClick:()=>e("/onboarding/extension"),children:n.jsx(br,{colorClass:"!text-onboarding-best",title:r("onboarding.start.options.extension.title"),subtitle:r("onboarding.start.options.extension.quality"),description:r("onboarding.start.options.extension.description"),children:n.jsx($e,{children:r("onboarding.start.options.extension.action")})})}),n.jsxs("div",{className:"hidden md:grid grid-rows-[1fr,auto,1fr] justify-center gap-4",children:[n.jsx(yr,{className:"items-end"}),n.jsx("span",{className:"text-xs uppercase font-bold",children:"or"}),n.jsx(yr,{})]}),n.jsx(kt,{onClick:()=>e("/onboarding/proxy"),children:n.jsx(br,{colorClass:"!text-onboarding-good",title:r("onboarding.start.options.proxy.title"),subtitle:r("onboarding.start.options.proxy.quality"),description:r("onboarding.start.options.proxy.description"),children:n.jsx($e,{children:r("onboarding.start.options.proxy.action")})})})]}),i?null:n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-center hidden md:block mt-12",children:n.jsxs(Le,{i18nKey:"onboarding.start.options.default.text",children:[n.jsx("br",{}),n.jsx("a",{onClick:t.show,type:"button",className:"text-onboarding-link hover:opacity-75 cursor-pointer"})]})}),n.jsx("div",{className:" max-w-[300px] mx-auto md:hidden mt-12 ",children:n.jsx($,{className:"!text-type-text !bg-opacity-50",theme:"secondary",onClick:t.show,children:n.jsx("span",{children:n.jsxs(Le,{i18nKey:"onboarding.start.options.default.text",children:[n.jsx("span",{}),n.jsx("span",{})]})})})})]})]})]})}async function bf(){const e=await zn();return e?e.success?e.allowed?e.hasPermission?Dr(e.version)?"success":"outdated":"noperms":"disallowed":"failed":"unknown"}function yf(){const{t:e}=R(),t=u.useCallback(()=>{window.location.reload()},[]);return n.jsx(kt,{className:"mt-4",children:n.jsxs("div",{className:"flex items-center space-x-7",children:[n.jsx("p",{className:"flex-1",children:e("onboarding.extension.notDetecting")}),n.jsx($,{theme:"secondary",onClick:t,children:e("onboarding.extension.notDetectingAction")})]})})}function js(e){const{t}=R(),[s,r]=u.useState(e.status);u.useEffect(()=>{e.loading||r(e.status)},[e.status,e.loading]);let i=null;return(e.loading||e.status==="unknown")&&(i=n.jsxs(n.Fragment,{children:[n.jsx(We,{}),n.jsx("p",{children:t("onboarding.extension.status.loading")})]})),e.status==="disallowed"||e.status==="noperms"?i=n.jsxs(n.Fragment,{children:[n.jsx("p",{children:t("onboarding.extension.status.disallowed")}),n.jsx($,{onClick:()=>{cl({page:"PermissionGrant",redirectUrl:window.location.href})},theme:"purple",padding:"md:px-12 p-2.5",className:"mt-6",children:t("onboarding.extension.status.disallowedAction")})]}):e.status==="failed"?i=n.jsx("p",{children:t("onboarding.extension.status.failed")}):e.status==="outdated"?i=n.jsx("p",{children:t("onboarding.extension.status.outdated")}):e.status==="success"&&(i=n.jsxs("p",{className:"flex items-center",children:[n.jsx(P,{icon:w.CHECKMARK,className:"text-type-success mr-4"}),t("onboarding.extension.status.success")]})),n.jsxs(n.Fragment,{children:[n.jsx(kt,{children:n.jsx("div",{className:"flex py-6 flex-col space-y-2 items-center justify-center",children:i})}),s==="unknown"?n.jsx(yf,{}):null,e.showHelp&&e.status!=="success"?n.jsx(kt,{className:"mt-4",children:n.jsxs("div",{className:"flex items-center space-x-7",children:[n.jsx(P,{icon:w.WARNING,className:"text-type-danger text-2xl"}),n.jsx("p",{className:"flex-1",children:n.jsx(Le,{i18nKey:"onboarding.extension.extensionHelp",components:{bold:n.jsx("span",{className:"text-white"})}})})]})}):null]})}function vf(e){const{t}=R(),s=F().ONBOARDING_CHROME_EXTENSION_INSTALL_LINK;return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:t("onboarding.extension.title")}),n.jsx(ie,{className:"max-w-[320px] mb-4",children:t("onboarding.extension.explainer")}),s?n.jsx($e,{href:s,target:"_blank",className:"mb-12",children:t("onboarding.extension.linkChrome")}):null,n.jsx(js,{status:e.status,loading:e.loading})]})}function jf(e){const{t}=R(),s=F().ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK;return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:t("onboarding.extension.title")}),n.jsx(ie,{className:"max-w-[320px] mb-4",children:t("onboarding.extension.explainer")}),s?n.jsx($e,{href:s,target:"_blank",className:"mb-12",children:t("onboarding.extension.linkFirefox")}):null,n.jsx(js,{status:e.status,loading:e.loading,showHelp:!0})]})}function wf(e){const{t}=R();return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:t("onboarding.extension.title")}),n.jsx(ie,{className:"max-w-[320px] mb-4",children:n.jsx(Le,{i18nKey:"onboarding.extension.explainerIos",components:{bold:n.jsx("span",{className:"text-white font-bold"})}})})]})}function kf(e){const{t}=R(),s=F().ONBOARDING_CHROME_EXTENSION_INSTALL_LINK,r=F().ONBOARDING_FIREFOX_EXTENSION_INSTALL_LINK;return n.jsxs(n.Fragment,{children:[n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:t("onboarding.extension.title")}),n.jsx(ie,{className:"max-w-[320px] mb-4",children:t("onboarding.extension.explainer")}),n.jsx("div",{className:"mb-4",children:s?n.jsx($e,{href:s,target:"_blank",children:t("onboarding.extension.linkChrome")}):null}),n.jsx("div",{className:"mb-12",children:r?n.jsx($e,{href:r,target:"_blank",children:t("onboarding.extension.linkFirefox")}):null}),n.jsx(js,{status:e.status,loading:e.loading,showHelp:!0})]})}function Nf(){const{t:e}=R(),t=vs(),{completeAndRedirect:s}=ys(),r=u.useMemo(()=>su(),[]),[{loading:i,value:o},a]=xe(async function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=await bf();return m==="success"&&d&&s(),m},[s]);Gn(a,1e3);const c={chrome:vf,firefox:jf,ios:wf,unknown:kf}[r];return n.jsxs(bs,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.onboarding"}),n.jsxs(is,{children:[n.jsx(ps,{steps:2,current:2,className:"mb-12"}),n.jsx(c,{loading:i,status:o??"unknown"}),n.jsxs("div",{className:"flex justify-between items-center mt-8",children:[n.jsx($,{onClick:()=>t("/onboarding"),theme:"secondary",children:e("onboarding.extension.back")}),o==="success"?n.jsx($,{onClick:()=>a(!0),theme:"purple",children:e("onboarding.extension.submit")}):null]})]})]})}function Sf(e){return n.jsxs("p",{className:_("inline-flex items-center text-type-danger",e.className),children:[n.jsx(P,{icon:w.WARNING,className:"text-xl mr-4"}),e.children]})}const vr="https://postman-echo.com/get";function Cf(){const{t:e}=R(),t=vs(),{completeAndRedirect:s}=ys(),[r,i]=u.useState(""),o=J(g=>g.setProxySet),a=F().ONBOARDING_PROXY_INSTALL_LINK,l=Be(),c=J(g=>g.account),[{loading:d,error:m},b]=xe(async()=>{if(!r.startsWith("http"))throw new Error("onboarding.proxy.input.errorInvalidUrl");try{if((await Qn(r,vr,{})).url!==vr)throw new Error("onboarding.proxy.input.errorNotProxy");o([r]),c&&l&&await Zn(l,c,{proxyUrls:[r]}),s()}catch{throw new Error("onboarding.proxy.input.errorConnection")}},[r,s,o]);return n.jsxs(bs,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.onboarding"}),n.jsxs(is,{children:[n.jsx(ps,{steps:2,current:2,className:"mb-12"}),n.jsx(je,{className:"!mt-0 !text-3xl max-w-[435px]",children:e("onboarding.proxy.title")}),n.jsx(ie,{className:"max-w-[320px] !mb-5",children:e("onboarding.proxy.explainer")}),a?n.jsx($e,{href:a,target:"_blank",className:"mb-12",children:e("onboarding.proxy.link")}):null,n.jsxs("div",{className:"w-[400px] max-w-full  mt-14 mb-28",children:[n.jsx(wt,{label:e("onboarding.proxy.input.label"),value:r,onChange:i,placeholder:e("onboarding.proxy.input.placeholder"),className:"mb-4"}),m?n.jsx(Sf,{children:e(m.message)}):null]}),n.jsx(De,{}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx($,{theme:"secondary",onClick:()=>t("/onboarding"),children:e("onboarding.proxy.back")}),n.jsx($,{theme:"purple",loading:d,onClick:b,children:e("onboarding.proxy.submit")})]})]})]})}function Xe(e){return n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-white mb-2 font-medium",children:e.title}),n.jsx("div",{className:"text-type-text mb-8",children:e.children})]})}function Ef(){const{t:e}=R();return n.jsxs(ze,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.privacy"}),n.jsxs(Et,{children:[n.jsx(Ct,{children:e("privacy.title")}),n.jsx(ai,{children:e("privacy.lastUpdated")}),n.jsx(ie,{children:e("privacy.description")}),n.jsx(Xe,{title:e("privacy.p1.title"),children:e("privacy.p1.body")}),n.jsx(Xe,{title:e("privacy.p2.title"),children:e("privacy.p2.body")}),n.jsx(Xe,{title:e("privacy.p3.title"),children:e("privacy.p3.body")}),n.jsx(Xe,{title:e("privacy.p4.title"),children:e("privacy.p4.body")}),n.jsx(Xe,{title:e("privacy.p5.title"),children:e("privacy.p5.body")}),n.jsx(Xe,{title:e("privacy.p6.title"),children:e("privacy.p6.body")})]})]})}const no=["#0A54FF","#CF2E68","#F9DD7F","#7652DD","#2ECFA8"],jr=no[0],If=function(t){return n.jsxs("div",{className:"space-y-3",children:[t.label?n.jsx("p",{className:"font-bold text-white",children:t.label}):null,n.jsx("div",{className:"flex gap-3",children:no.map(s=>n.jsx("button",{type:"button",tabIndex:0,className:_("w-full h-10 rounded flex justify-center items-center text-white pointer border-2 border-opacity-10 cursor-pointer",t.value===s?"border-white":"border-transparent"),onClick:()=>t.onInput(s),style:{backgroundColor:s},children:t.value===s?n.jsx(P,{icon:w.CHECKMARK}):null},s))})]})},wr=If,so=[ht.USER_GROUP,ht.COUCH,ht.MOBILE,ht.TICKET,ht.FILM],Tf=so[0],Lf=function(t){return n.jsxs("div",{className:"space-y-3",children:[t.label?n.jsx("p",{className:"font-bold text-white",children:t.label}):null,n.jsx("div",{className:"flex gap-3",children:so.map(s=>n.jsx("button",{type:"button",tabIndex:0,className:_("w-full h-10 rounded flex justify-center items-center text-white pointer border-2 border-opacity-10 cursor-pointer",t.value===s?"bg-buttons-purple border-white":"bg-authentication-inputBg border-transparent"),onClick:()=>t.onInput(s),children:n.jsx(Tr,{className:"text-xl",icon:s})},s))})]})},Pf=Lf;function Rf(e){const[t,s]=u.useState(""),[r,i]=u.useState(jr),[o,a]=u.useState(jr),[l,c]=u.useState(Tf),{t:d}=R(),[m,b]=u.useState(!1),g=u.useCallback(()=>{var h;b(!1);const f=t.trim();if(f.length===0){b(!0);return}(h=e.onNext)==null||h.call(e,{device:f,profile:{colorA:r,colorB:o,icon:l}})},[t,e,r,o,l]);return n.jsxs(Pt,{children:[n.jsx(Rt,{icon:n.jsx(gi,{profile:{colorA:r,colorB:o,icon:l},iconClass:"text-3xl",sizeClass:"w-16 h-16"}),title:d("auth.register.information.title")??void 0,children:d("auth.register.information.header")}),n.jsxs("div",{className:"space-y-6",children:[n.jsx(wt,{label:d("auth.deviceNameLabel")??void 0,value:t,onChange:s,placeholder:d("auth.deviceNamePlaceholder")??void 0}),n.jsx(wr,{label:d("auth.register.information.color1"),value:r,onInput:i}),n.jsx(wr,{label:d("auth.register.information.color2"),value:o,onInput:a}),n.jsx(Pf,{label:d("auth.register.information.icon"),value:l,onInput:c}),m?n.jsx("p",{className:"text-authentication-errorText",children:d("auth.login.deviceLengthError")}):null]}),n.jsx(it,{children:n.jsx($,{theme:"purple",onClick:()=>g(),children:d("auth.register.information.next")})})]})}const Af=function(t){const{t:s}=R(),r=t.mnemonic.split(" "),[,i]=Pr(),[o,a]=u.useState(!1),l=Va(),c=u.useRef();function d(){i(t.mnemonic),a(!0),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>l()&&a(!1),500)}return n.jsxs("div",{className:"rounded-lg border border-authentication-border/50 ",children:[n.jsxs("div",{className:"px-4 py-2 flex justify-between border-b border-authentication-border/50",children:[n.jsx("p",{className:"font-bold text-sm text-white",children:s("auth.generate.passphraseFrameLabel")}),n.jsxs("button",{type:"button",className:"text-authentication-copyText hover:text-authentication-copyTextHover transition-colors flex gap-2 items-center cursor-pointer",onClick:()=>d(),children:[n.jsx(P,{icon:o?w.CHECKMARK:w.COPY,className:o?"text-xs":""}),n.jsx("span",{className:"text-sm",children:s("actions.copy")})]})]}),n.jsx("div",{className:"px-4 py-4 grid grid-cols-3 text-sm sm:text-base sm:grid-cols-4 gap-2",children:r.map((m,b)=>n.jsx("div",{className:"rounded-md py-2 bg-authentication-wordBackground text-white font-medium text-center",children:m},b))})]})},_f=Af;function Mf(e){const t=u.useMemo(()=>wc(),[]),{t:s}=R();return n.jsxs(Pt,{children:[n.jsx(Rt,{title:s("auth.generate.title"),icon:n.jsx(P,{icon:w.USER}),children:s("auth.generate.description")}),n.jsx(_f,{mnemonic:t}),n.jsx(it,{children:n.jsx($,{theme:"purple",onClick:()=>{var r;return(r=e.onNext)==null?void 0:r.call(e,t)},children:s("auth.generate.next")})})]})}function Of(e){const t=oe(),s=Be(),r=u.useMemo(()=>s?new URL(s).hostname:void 0,[s]),i=at(()=>s?yi(s):Promise.resolve(null),[s]),{t:o}=R();let a=n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-white font-bold text-lg",children:o("auth.trust.failed.title")}),n.jsx("p",{children:o("auth.trust.failed.text")})]});return i.loading&&(a=n.jsx(We,{})),i.value&&(a=n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-white font-bold text-lg",children:i.value.name}),i.value.description?n.jsx("p",{className:"text-center",children:i.value.description}):null]})),n.jsxs(Pt,{children:[n.jsx(Rt,{title:o(r?"auth.trust.title":"auth.trust.noHostTitle"),icon:n.jsx(P,{icon:w.CIRCLE_EXCLAMATION}),children:r?n.jsx(Le,{i18nKey:"auth.trust.host",values:{hostname:r},children:n.jsx("span",{className:"text-white"})}):n.jsx("p",{children:o("auth.trust.noHost")})}),r?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"border border-authentication-border rounded-xl px-4 py-8 flex flex-col items-center space-y-2 my-8",children:a}),n.jsxs(it,{children:[n.jsx($,{theme:"secondary",onClick:()=>t("/"),children:o("auth.trust.no")}),n.jsx($,{theme:"purple",onClick:()=>{var l;return i.value&&((l=e.onNext)==null?void 0:l.call(e,i.value))},children:o("auth.trust.yes")})]}),n.jsx("p",{className:"text-center mt-6",children:n.jsx(Le,{i18nKey:"auth.hasAccount",children:n.jsx(to,{to:"/login",children:"."})})})]}):n.jsx(it,{children:n.jsx($,{theme:"purple",onClick:()=>t("/"),children:o("auth.trust.no")})})]})}function Df(e){const[t,s]=u.useState(""),{register:r,restore:i,importData:o}=ct(),a=re(y=>y.items),l=te(y=>y.bookmarks),c=lt(y=>y.language),d=Q(y=>y.lastSelectedLanguage),m=es(y=>y.theme),b=Be(),{t:g}=R(),{executeRecaptcha:f}=Bo(),[h,j]=xe(async y=>{var I;if(!b)throw new Error(g("auth.verify.noBackendUrl")??void 0);if(!e.mnemonic||!e.userData)throw new Error(g("auth.verify.invalidData")??void 0);let x;if(e.hasCaptcha&&(x=f?await f():void 0,!x))throw new Error(g("auth.verify.recaptchaFailed")??void 0);if(y!==e.mnemonic)throw new Error(g("auth.verify.noMatch")??void 0);const v=await r({mnemonic:y,userData:e.userData,recaptchaToken:x});if(!v)throw new Error(g("auth.verify.registrationFailed")??void 0);await o(v,a,l),await Zn(b,v,{applicationLanguage:c,defaultSubtitleLanguage:d??void 0,applicationTheme:m??void 0,proxyUrls:void 0}),await i(v),(I=e.onNext)==null||I.call(e)},[e,r,i]);return n.jsx(Pt,{children:n.jsxs("form",{children:[n.jsx(Rt,{icon:n.jsx(P,{icon:w.CIRCLE_CHECK}),title:g("auth.verify.title"),children:g("auth.verify.description")}),n.jsx(wt,{label:g("auth.verify.passphraseLabel")??void 0,autoComplete:"username",name:"username",value:t,onChange:s,passwordToggleable:!0}),h.error?n.jsx("p",{className:"mt-3 text-authentication-errorText",children:h.error.message}):null,n.jsx(it,{children:n.jsx($,{theme:"purple",loading:h.loading,onClick:()=>j(t),children:g("auth.verify.register")})})]})})}function Bf(e){return e.siteKey?n.jsx(Uo,{reCaptchaKey:e.siteKey,children:e.children}):e.children}function Uf(){const e=oe(),[t,s]=u.useState(0),[r,i]=u.useState(null),[o,a]=u.useState(null),[l,c]=u.useState(null);return n.jsx(Bf,{siteKey:l,children:n.jsxs(ze,{children:[n.jsx(Pe,{subpage:!0,k:"global.pages.register"}),t===0?n.jsx(Of,{onNext:d=>{c(d.hasCaptcha&&d.captchaClientKey?d.captchaClientKey:null),s(1)}}):null,t===1?n.jsx(Mf,{onNext:d=>{i(d),s(2)}}):null,t===2?n.jsx(Rf,{onNext:d=>{a(d),s(3)}}):null,t===3?n.jsx(Df,{hasCaptcha:!!l,mnemonic:r,userData:o,onNext:()=>{e("/")}}):null]})})}function Vf(e){const t=hn(),s=ye(r=>r.location);return n.jsxs("div",{children:[n.jsx("div",{className:"fixed inset-x-0 z-[1000]",children:n.jsx(Yi,{})}),n.jsx("div",{style:{paddingTop:s===null?`${t}px`:"0px"},className:"flex min-h-screen flex-col",children:e.children})]})}const ro=ne(se(e=>({routes:[],registerRoute(t){e(s=>{s.routes.push(t)})}})));function Ff(){const e=ot(),t=ro(s=>s.registerRoute);u.useEffect(()=>{t({path:e.pathname})},[e.pathname,t]),Rr(()=>{t({path:e.pathname})})}function Eg(){const e=ro(r=>r.routes),t=ot();return u.useMemo(()=>{const r=[...e];r.reverse();const i=r.find(o=>!o.path.startsWith("/media")&&t.pathname!==o.path&&!o.path.startsWith("/s/")&&!o.path.startsWith("/onboarding"));return(i==null?void 0:i.path)??"/"},[e,t])}const $f=u.lazy(()=>fn(()=>import("./DeveloperPage-Dm1t5Jd8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])));u.lazy(()=>fn(()=>import("./TestView-D3hTcdsZ.js"),__vite__mapDeps([10,1,2,3,4,8,5,6,7,9])));const Vn=Ir(()=>fn(()=>import("./PlayerView-CQGW5b8f.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9]))),io=Ir(()=>fn(()=>import("./Settings-k8Dx4MJq.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,9,8])));Vn.preload();io.preload();function kr(e){let{children:t}=e;const s=ot(),r=oe();return u.useEffect(()=>{const i=s.pathname;Tn(i)&&Vl(s.pathname).then(o=>{r(o??"/",{replace:!0})})},[s.pathname,r]),Tn(s.pathname)?null:t}function Hf(){const{query:e}=Fn(),t=oe();return u.useEffect(()=>{e?Ol(e).then(s=>{t(s??"/",{replace:!0})}):t("/",{replace:!0})},[e,t]),null}function Wf(){const{query:e}=Fn(),t=oe();return u.useEffect(()=>{e?t(`/browse/${e}`,{replace:!0}):t("/",{replace:!0})},[e,t]),null}function Gf(){return Ff(),bd(),n.jsxs(Vf,{children:[n.jsx(fc,{}),n.jsxs(Vo,{children:[n.jsx(X,{path:"/s/:query",element:n.jsx(Hf,{})}),n.jsx(X,{path:"/search/:type",element:n.jsx(Fo,{to:"/browse"})}),n.jsx(X,{path:"/search/:type/:query?",element:n.jsx(Wf,{})}),n.jsx(X,{path:"/media/:media",element:n.jsx(kr,{children:n.jsx(u.Suspense,{fallback:null,children:n.jsx(Vn,{})})})}),n.jsx(X,{path:"/media/:media/:season/:episode",element:n.jsx(kr,{children:n.jsx(u.Suspense,{fallback:null,children:n.jsx(Vn,{})})})}),n.jsx(X,{path:"/browse/:query?",element:n.jsx(pr,{})}),n.jsx(X,{path:"/",element:n.jsx(pr,{})}),n.jsx(X,{path:"/register",element:n.jsx(Uf,{})}),n.jsx(X,{path:"/login",element:n.jsx(ff,{})}),n.jsx(X,{path:"/about",element:n.jsx(jd,{})}),n.jsx(X,{path:"/privacy",element:n.jsx(Ef,{})}),n.jsx(X,{path:"/onboarding",element:n.jsx(pf,{})}),n.jsx(X,{path:"/discover",element:n.jsx(Vh,{})}),n.jsx(X,{path:"/onboarding/extension",element:n.jsx(Nf,{})}),n.jsx(X,{path:"/onboarding/proxy",element:n.jsx(Cf,{})}),hi()?n.jsx(X,{path:"/dmca",element:n.jsx(rd,{})}):null,n.jsx(X,{path:"/settings",element:n.jsx(u.Suspense,{fallback:null,children:n.jsx(io,{})})}),n.jsx(X,{path:"/admininfo",element:n.jsx(Id,{})}),n.jsx(X,{path:"/dev",element:n.jsx($f,{})}),n.jsx(X,{path:"/dev/video",element:n.jsx(Oh,{})}),null,n.jsx(X,{path:"*",element:n.jsx($h,{})})]})]})}const zf=5*1e3;async function Kf(e,t,s,r){for(const i of e)if(t(i.id),!!r)try{if(i.action==="delete"){await yc(s,r,i.tmdbId);continue}if(i.action==="add"){await bc(s,r,{meta:{poster:i.poster,title:i.title??"",type:i.type??"",year:i.year??NaN},tmdbId:i.tmdbId});continue}}catch(o){console.error(`Failed to sync bookmark: ${i.tmdbId} - ${i.action}`,o)}}function Yf(){const e=te(r=>r.clearUpdateQueue),t=te(r=>r.removeUpdateItem),s=Be();return u.useEffect(()=>{e()},[e]),u.useEffect(()=>{const r=setInterval(()=>{(async()=>{if(!s)return;const i=te.getState(),o=J.getState();await Kf(i.updateQueue,t,s,o.account)})()},zf);return()=>{clearInterval(r)}},[t,s]),null}const qf=5*1e3;async function Qf(e,t,s,r){for(const i of e)if(t(i.id),!!r)try{if(i.action==="delete"){await Pc(s,r,i.tmdbId,i.seasonId,i.episodeId);continue}if(i.action==="upsert"){await Lc(s,r,Ic(i));continue}}catch(o){console.error(`Failed to sync progress: ${i.tmdbId} - ${i.action}`,o)}}function Xf(){const e=re(r=>r.clearUpdateQueue),t=re(r=>r.removeUpdateItem),s=Be();return u.useEffect(()=>{e()},[e]),u.useEffect(()=>{const r=setInterval(()=>{(async()=>{if(!s)return;const i=re.getState(),o=J.getState();await Qf(i.updateQueue,t,s,o.account)})()},qf);return()=>{clearInterval(r)}},[t,s]),null}const Jf=5*1e3;function Zf(){const e=Q(s=>s.importSubtitleLanguage),t=Be();return u.useEffect(()=>{const s=setInterval(()=>{(async()=>{if(!t)return;const r=Q.getState(),i=J.getState();r.lastSync.lastSelectedLanguage!==r.lastSelectedLanguage&&i.account&&r.lastSelectedLanguage&&(await Zn(t,i.account,{defaultSubtitleLanguage:r.lastSelectedLanguage}),e(r.lastSelectedLanguage))})()},Jf);return()=>{clearInterval(s)}},[e,t]),null}const eg=function(){const[t,s]=u.useState(!1);return u.useEffect(()=>{if(window.top!==window.self){s(!0);const r=setTimeout(()=>{s(!1)},2500);return()=>clearTimeout(r)}},[]),t?n.jsxs("div",{id:"iframe-message",className:"fixed inset-0 flex flex-col items-center justify-center bg-black text-white text-center space-y-6 p-4 z-10",children:[n.jsx("a",{className:"block tabbable rounded-full text-2xl mb-6",href:"https://www.vidbinge.com/",target:"_blank",rel:"noopener noreferrer",children:n.jsxs("div",{className:"flex items-center space-x-2 rounded-full px-4 py-2 text-type-logo bg-pill-background bg-opacity-50 transition-[transform,background-color] hover:scale-105 hover:bg-pill-backgroundHover backdrop-blur-lg hover:text-type-logo active:scale-95",children:[n.jsx("span",{className:"text-xl",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20.927 20.927",children:n.jsx("path",{d:"M18.186,4.5V6.241H16.445V4.5H9.482V6.241H7.741V4.5H6V20.168H7.741V18.427H9.482v1.741h6.964V18.427h1.741v1.741h1.741V4.5Zm-8.7,12.186H7.741V14.945H9.482Zm0-3.482H7.741V11.464H9.482Zm0-3.482H7.741V7.982H9.482Zm8.7,6.964H16.445V14.945h1.741Zm0-3.482H16.445V11.464h1.741Zm0-3.482H16.445V7.982h1.741Z",transform:"translate(10.018 -7.425) rotate(45)",fill:"currentColor"})})}),n.jsx("span",{className:"font-semibold text-white",children:"Vid Binge"})]})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-2xl sm:text-4xl font-bold",children:"Watch More Movies & TV Shows in up to 4K"}),n.jsx("a",{id:"iframe-link",href:"https://www.vidbinge.com/",target:"_blank",rel:"noopener noreferrer",className:"text-2xl sm:text-4xl font-bold underline mt-2 block",children:"Visit VidBinge.com"}),n.jsx("p",{className:"text-xl sm:text-3xl font-bold mt-6",children:"This Stream Will Start Shortly..."})]}),n.jsx("p",{className:"absolute bottom-4 text-md sm:text-lg font-bold mt-6",children:"This Stream is Provided By Vid Binge"})]}):null},tg=eg;eh();function ws(e){const t={user:"screens.loadingUser",lazy:"screens.loadingApp"},{t:s}=R();return n.jsx(bi,{iconSlot:n.jsx(We,{}),children:s(t[e.type]??"unknown.translation")})}function ks(e){const{t}=R(),{logout:s}=ct(),r=J(a=>a.setBackendUrl),i=u.useCallback(()=>{r(null),location.reload()},[r]),o=u.useCallback(()=>{s().then(()=>{location.reload()})},[s]);return n.jsxs(bi,{iconSlot:n.jsx(P,{className:"text-type-danger text-2xl",icon:w.WARNING}),children:[e.children,e.showResetButton?n.jsx("div",{className:"mt-6",children:n.jsx($,{theme:"secondary",onClick:i,children:t("screens.loadingUserError.reset")})}):null,e.showLogoutButton?n.jsx("div",{className:"mt-6",children:n.jsx($,{theme:"secondary",onClick:o,children:t("screens.loadingUserError.logout")})}):null,e.showReloadButton?n.jsx("div",{className:"mt-6",children:n.jsx($,{theme:"secondary",onClick:()=>window.location.reload(),children:t("screens.loadingUserError.reload")})}):null]})}function ng(){const e=Gc(),t=F().BACKEND_URL,s=Be(),{t:r}=R(),i=t!==s;return e.loading?n.jsx(ws,{type:"user"}):e.error?n.jsx(ks,{showResetButton:i,showLogoutButton:!i,showReloadButton:!i,children:r(i?"screens.loadingUserError.textWithReset":"screens.loadingUserError.text")}):n.jsx(Gf,{})}function sg(){const e=at(async()=>{ri(lt.getState().language),await za()},[]),{t}=R();return e.loading?n.jsx(gd,{}):e.error?n.jsx(ks,{children:t("screens.migration.failed")}):n.jsx(ng,{})}function rg(e){return F().NORMAL_ROUTER?n.jsx(Ho,{children:e.children}):n.jsx(Wo,{children:e.children})}function ig(){const{t:e}=R(),[t]=xe(async()=>{if(!be)return zn()});return t.loading?n.jsx(ws,{type:"lazy"}):t.error?n.jsx(ks,{children:e("screens.loadingUserError.reload")}):null}const og=document.getElementById("root"),ag=Fa(og);ag.render(n.jsx(u.StrictMode,{children:n.jsxs(sd,{children:[n.jsx($r,{}),n.jsx($o,{children:n.jsxs(u.Suspense,{fallback:n.jsx(ws,{type:"lazy"}),children:[n.jsx(ig,{}),n.jsxs($c,{applyGlobal:!0,children:[n.jsx(Xf,{}),n.jsx(Yf,{}),n.jsx(Zf,{}),n.jsx(rg,{children:n.jsx(sg,{})}),n.jsx(tg,{})]})]})})]})}));export{Jc as $,xg as A,$ as B,J as C,xf as D,ss as E,mn as F,Ii as G,ms as H,ts as I,Eg as J,Dn as K,We as L,H as M,os as N,An as O,eu as P,_h as Q,W as R,tu as S,Et as T,Fc as U,Be as V,Hc as W,Sg as X,je as Y,ai as Z,di as _,jt as a,ie as a0,gi as a1,wr as a2,Pf as a3,ct as a4,wt as a5,Ct as a6,Ft as a7,E as a8,nn as a9,cm as aa,am as ab,Th as ac,to as ad,De as ae,oi as af,Jn as ag,_c as ah,Lt as ai,yi as aj,jg as ak,Um as al,Cg as am,Td as an,wg as ao,es as ap,lt as aq,Q as ar,Zn as as,Gs as at,kg as au,Ng as av,ze as aw,Pe as ax,mi as ay,On as b,vt as c,vg as d,zn as e,yg as f,zr as g,ns as h,Dr as i,cl as j,F as k,kl as l,bf as m,td as n,de as o,$i as p,be as q,Cn as r,bg as s,Mn as t,rs as u,ln as v,Sn as w,It as x,Vr as y,pg as z};
//# sourceMappingURL=index-DIVXyTVb.js.map
